From nobody at sheep.berlios.de  Fri Jul 30 00:02:46 2004
From: nobody at sheep.berlios.de (swiergot)
Date: Fri, 30 Jul 2004 00:02:46 +0200
Subject: [Packware-cvs] pwbuilder/src - New directory
Message-ID: <200407292202.i6TM2k621512@bat.berlios.de>

Update of /cvsroot/packware/pwbuilder/src
In directory sheep:/tmp/cvs-serv12561/src

Log Message:
Directory /cvsroot/packware/pwbuilder/src added to the repository




From nobody at sheep.berlios.de  Fri Jul 30 00:02:46 2004
From: nobody at sheep.berlios.de (swiergot)
Date: Fri, 30 Jul 2004 00:02:46 +0200
Subject: [Packware-cvs] pwbuilder/doc - New directory
Message-ID: <200407292202.i6TM2k621504@bat.berlios.de>

Update of /cvsroot/packware/pwbuilder/doc
In directory sheep:/tmp/cvs-serv12561/doc

Log Message:
Directory /cvsroot/packware/pwbuilder/doc added to the repository




From nobody at sheep.berlios.de  Fri Jul 30 00:02:46 2004
From: nobody at sheep.berlios.de (swiergot)
Date: Fri, 30 Jul 2004 00:02:46 +0200
Subject: [Packware-cvs] pwbuilder/po - New directory
Message-ID: <200407292202.i6TM2k621508@bat.berlios.de>

Update of /cvsroot/packware/pwbuilder/po
In directory sheep:/tmp/cvs-serv12561/po

Log Message:
Directory /cvsroot/packware/pwbuilder/po added to the repository




From nobody at sheep.berlios.de  Fri Jul 30 00:03:01 2004
From: nobody at sheep.berlios.de (swiergot)
Date: Fri, 30 Jul 2004 00:03:01 +0200
Subject: [Packware-cvs] pwbuilder/doc/guide - New directory
Message-ID: <200407292203.i6TM31621532@bat.berlios.de>

Update of /cvsroot/packware/pwbuilder/doc/guide
In directory sheep:/tmp/cvs-serv12609/guide

Log Message:
Directory /cvsroot/packware/pwbuilder/doc/guide added to the repository




From nobody at sheep.berlios.de  Fri Jul 30 00:03:42 2004
From: nobody at sheep.berlios.de (swiergot)
Date: Fri, 30 Jul 2004 00:03:42 +0200
Subject: [Packware-cvs] pwbuilder/src/etc - New directory
Message-ID: <200407292203.i6TM3g621546@bat.berlios.de>

Update of /cvsroot/packware/pwbuilder/src/etc
In directory sheep:/tmp/cvs-serv12700/etc

Log Message:
Directory /cvsroot/packware/pwbuilder/src/etc added to the repository




From nobody at sheep.berlios.de  Fri Jul 30 00:03:43 2004
From: nobody at sheep.berlios.de (swiergot)
Date: Fri, 30 Jul 2004 00:03:43 +0200
Subject: [Packware-cvs] pwbuilder/src/usr - New directory
Message-ID: <200407292203.i6TM3h621550@bat.berlios.de>

Update of /cvsroot/packware/pwbuilder/src/usr
In directory sheep:/tmp/cvs-serv12700/usr

Log Message:
Directory /cvsroot/packware/pwbuilder/src/usr added to the repository




From nobody at sheep.berlios.de  Fri Jul 30 00:04:09 2004
From: nobody at sheep.berlios.de (swiergot)
Date: Fri, 30 Jul 2004 00:04:09 +0200
Subject: [Packware-cvs] pwbuilder/src/usr/bin - New directory
Message-ID: <200407292204.i6TM49621589@bat.berlios.de>

Update of /cvsroot/packware/pwbuilder/src/usr/bin
In directory sheep:/tmp/cvs-serv12767/bin

Log Message:
Directory /cvsroot/packware/pwbuilder/src/usr/bin added to the repository




From nobody at sheep.berlios.de  Fri Jul 30 00:04:09 2004
From: nobody at sheep.berlios.de (swiergot)
Date: Fri, 30 Jul 2004 00:04:09 +0200
Subject: [Packware-cvs] pwbuilder/src/usr/lib - New directory
Message-ID: <200407292204.i6TM49621593@bat.berlios.de>

Update of /cvsroot/packware/pwbuilder/src/usr/lib
In directory sheep:/tmp/cvs-serv12767/lib

Log Message:
Directory /cvsroot/packware/pwbuilder/src/usr/lib added to the repository




From nobody at sheep.berlios.de  Fri Jul 30 00:04:48 2004
From: nobody at sheep.berlios.de (swiergot)
Date: Fri, 30 Jul 2004 00:04:48 +0200
Subject: [Packware-cvs] pwbuilder/src/usr/lib/pwbuilder/include - New directory
Message-ID: <200407292204.i6TM4m621611@bat.berlios.de>

Update of /cvsroot/packware/pwbuilder/src/usr/lib/pwbuilder/include
In directory sheep:/tmp/cvs-serv12838/include

Log Message:
Directory /cvsroot/packware/pwbuilder/src/usr/lib/pwbuilder/include added to the repository




From nobody at sheep.berlios.de  Fri Jul 30 00:04:31 2004
From: nobody at sheep.berlios.de (swiergot)
Date: Fri, 30 Jul 2004 00:04:31 +0200
Subject: [Packware-cvs] pwbuilder/src/usr/lib/pwbuilder - New directory
Message-ID: <200407292204.i6TM4V621597@bat.berlios.de>

Update of /cvsroot/packware/pwbuilder/src/usr/lib/pwbuilder
In directory sheep:/tmp/cvs-serv12815/pwbuilder

Log Message:
Directory /cvsroot/packware/pwbuilder/src/usr/lib/pwbuilder added to the repository




From nobody at sheep.berlios.de  Fri Jul 30 00:04:47 2004
From: nobody at sheep.berlios.de (swiergot)
Date: Fri, 30 Jul 2004 00:04:47 +0200
Subject: [Packware-cvs] pwbuilder/src/usr/lib/pwbuilder/bin - New directory
Message-ID: <200407292204.i6TM4l621607@bat.berlios.de>

Update of /cvsroot/packware/pwbuilder/src/usr/lib/pwbuilder/bin
In directory sheep:/tmp/cvs-serv12838/bin

Log Message:
Directory /cvsroot/packware/pwbuilder/src/usr/lib/pwbuilder/bin added to the repository




From nobody at sheep.berlios.de  Fri Jul 30 00:05:19 2004
From: nobody at sheep.berlios.de (swiergot)
Date: Fri, 30 Jul 2004 00:05:19 +0200
Subject: [Packware-cvs] pwbuilder/src/usr/lib/pwbuilder/include/have - New directory
Message-ID: <200407292205.i6TM5J621683@bat.berlios.de>

Update of /cvsroot/packware/pwbuilder/src/usr/lib/pwbuilder/include/have
In directory sheep:/tmp/cvs-serv13622/have

Log Message:
Directory /cvsroot/packware/pwbuilder/src/usr/lib/pwbuilder/include/have added to the repository




From nobody at sheep.berlios.de  Fri Jul 30 00:05:19 2004
From: nobody at sheep.berlios.de (swiergot)
Date: Fri, 30 Jul 2004 00:05:19 +0200
Subject: [Packware-cvs] pwbuilder/src/usr/lib/pwbuilder/include/internal - New directory
Message-ID: <200407292205.i6TM5J621687@bat.berlios.de>

Update of /cvsroot/packware/pwbuilder/src/usr/lib/pwbuilder/include/internal
In directory sheep:/tmp/cvs-serv13622/internal

Log Message:
Directory /cvsroot/packware/pwbuilder/src/usr/lib/pwbuilder/include/internal added to the repository




From nobody at sheep.berlios.de  Fri Jul 30 00:05:18 2004
From: nobody at sheep.berlios.de (swiergot)
Date: Fri, 30 Jul 2004 00:05:18 +0200
Subject: [Packware-cvs] pwbuilder/src/usr/lib/pwbuilder/include/funcs - New directory
Message-ID: <200407292205.i6TM5I621679@bat.berlios.de>

Update of /cvsroot/packware/pwbuilder/src/usr/lib/pwbuilder/include/funcs
In directory sheep:/tmp/cvs-serv13622/funcs

Log Message:
Directory /cvsroot/packware/pwbuilder/src/usr/lib/pwbuilder/include/funcs added to the repository




From nobody at sheep.berlios.de  Fri Jul 30 00:06:50 2004
From: nobody at sheep.berlios.de (swiergot)
Date: Fri, 30 Jul 2004 00:06:50 +0200
Subject: [Packware-cvs] pwbuilder fakeroot-libdir.pw.patch,NONE,1.1 pwbuilder.pw-postinst,NONE,1.1 pwbuilder.pwbuild,NONE,1.1 pwbuilder.pwinfo,NONE,1.1
Message-ID: <200407292206.i6TM6o621765@bat.berlios.de>

Update of /cvsroot/packware/pwbuilder
In directory sheep:/tmp/cvs-serv15405

Added Files:
	fakeroot-libdir.pw.patch pwbuilder.pw-postinst 
	pwbuilder.pwbuild pwbuilder.pwinfo 
Log Message:
- Initial commit.


--- NEW FILE: fakeroot-libdir.pw.patch ---
diff -ruN fakeroot-0.7.3.orig/scripts/fakeroot fakeroot-0.7.3/scripts/fakeroot
--- fakeroot-0.7.3.orig/scripts/fakeroot	2003-05-10 02:04:30.000000000 +0200
+++ fakeroot-0.7.3/scripts/fakeroot	2003-07-07 14:42:53.000000000 +0200
@@ -16,7 +16,7 @@
 PREFIX=`dirname ${BINDIR}`
     
 LIB=libfakeroot.so.0
-PATHS=${PREFIX}/lib/libfakeroot:${PREFIX}/lib64/libfakeroot
+PATHS=${PREFIX}/lib:${PREFIX}/lib/libfakeroot:${PREFIX}/lib64/libfakeroot
 FAKED=${BINDIR}/faked
 
 FAKED_MODE="unknown-is-root"

--- NEW FILE: pwbuilder.pw-postinst ---
function config() {
    if [ ! -f "$1" ]; then
	mv -f $1.new $1
    fi
}

config etc/pwbuilder.conf

--- NEW FILE: pwbuilder.pwbuild ---
#!/bin/sh

name="pwbuilder"
version="0.6.4-pre3"
build="1"

fakeroot="0.7.8"
pwutils="0.6"

_pwbuilder 0.6.3

_doc -d -r fakeroot-${fakeroot} README.fake

_source -t fakeroot-${fakeroot} -m d9612083d722f49091f54217ce90f9a5 -s 678306 http://packware.intersec.pl/source/fakeroot_${fakeroot}.tar.gz
_source -n pwutils -v ${pwutils} -m 48d32d94b45774967357c94b7fbb2cb3 -s 3440 http://packware.intersec.pl/

_patch fakeroot-libdir

_c_opt --prefix=/usr

_i_opt DESTDIR=${pkg}

_cmi

_make -s 2

cp -R ${src}/src/* ${pkg}

for i in desc getsfmirror sltd sltm; do
    cp ${src2}/${i} ${pkg}/usr/lib/pwbuilder/bin
done

echo ${version} > ${doc}/VERSION
cp -R ${src}/doc/* ${doc}

find ${pkg} -type d -name CVS | xargs rm -r

for i in pl; do
    mkdir ${pkg}/usr/share/locale/${i}/LC_MESSAGES
    msgfmt ${src}/po/${i}.po -o ${pkg}/usr/share/locale/${i}/LC_MESSAGES/${name}.mo
done

--- NEW FILE: pwbuilder.pwinfo ---
info="A tool for building Slackware packages."
desc="pwbuilder is a powerful tool for creating software packages for Slackware Linux.

pwbuilder aims to be the easiest tool in its category. However, pwbuilder provides an advanced API that allows you to make packages exactly in the way you want.

Look at /usr/doc/${name}-${version}/ for more information."



From nobody at sheep.berlios.de  Fri Jul 30 00:06:54 2004
From: nobody at sheep.berlios.de (swiergot)
Date: Fri, 30 Jul 2004 00:06:54 +0200
Subject: [Packware-cvs] pwbuilder/src/usr/bin pwbuilder,NONE,1.1 pwtext,NONE,1.1
Message-ID: <200407292206.i6TM6s621785@bat.berlios.de>

Update of /cvsroot/packware/pwbuilder/src/usr/bin
In directory sheep:/tmp/cvs-serv15405/src/usr/bin

Added Files:
	pwbuilder pwtext 
Log Message:
- Initial commit.


--- NEW FILE: pwbuilder ---
#!/bin/sh

source /usr/lib/pwbuilder/include/version

pwtext "pwbuilder %s - Slackware packages building system" ${pwbuilder_version}
echo "Copyright (c) 2002-2003 The Packware Project"
echo

if [ ! -x /usr/lib/libfakeroot.so.0.0.1 -o ! -x /usr/bin/fakeroot -o ! -x /usr/bin/faked ]; then

	pwtext "fakeroot not found."
	exit 1

fi

for conf in /etc/pwbuilder.conf ~/.pwbuilderrc; do

	if [ -r ${conf} ]; then

		source ${conf}

	fi

done

source /usr/lib/pwbuilder/include/mainfunc

while [ $# -gt 0 ]; do

	case "$1" in

		--debug|-d) debug=yes ;;
		--no-strip|-s) nostrip=yes ;;
		--target|-t) shift; target="$1" ;;
		--help|-h) usage ; exit 0 ;;
		--allow-root|-r) allowroot=yes ;;
		*) argument="$1" ;;

	esac

	shift

done

source /usr/lib/pwbuilder/include/slackver

source /usr/lib/pwbuilder/default.conf

if [ ! "${allowroot}" = "yes" -a `id -u` = 0 ]; then

	pwtext "Refusing to run as root."
	exit 1

fi

if [ -f "${argument}" ]; then

	if echo "${argument}" | grep '[.]pwbuild$' > /dev/null 2>&1; then

		buildscript="${argument}"

	else

		buildscript="`findscript \"${argument}\"`"

	fi

else

	buildscript="`findscript \"${argument}\"`"

fi

if [ "${buildscript}" = "" ]; then

	pwtext "Nothing to build."
	exit 1

fi

pwtext "Executing %s..." "${buildscript}"

source /usr/lib/pwbuilder/include/createenv

PATH="/usr/lib/pwbuilder/bin:${PATH}" \
sh /usr/lib/pwbuilder/include/runbuild "${buildscript}"

if [ $? = 0 ]; then

	pwtext "Creating packages..."
	source /usr/lib/pwbuilder/include/createpkg

fi

if [ ! "${pw_debug}" = "yes" ]; then

	pwtext "Cleaning up..."
	rm -rf ${tmp}

fi

--- NEW FILE: pwtext ---
#!/bin/sh

if [ "$1" = "-n" ]; then
	newline=no
	shift
fi

message="$1"
shift

translated="`gettext -d pwbuilder -e \"${message}\"`"

printf "${translated}" "$@"

if [ ! "${newline}" = "no" ]; then
	echo
fi



From nobody at sheep.berlios.de  Fri Jul 30 00:06:53 2004
From: nobody at sheep.berlios.de (swiergot)
Date: Fri, 30 Jul 2004 00:06:53 +0200
Subject: [Packware-cvs] pwbuilder/src/etc pwbuilder.conf.new,NONE,1.1
Message-ID: <200407292206.i6TM6r621781@bat.berlios.de>

Update of /cvsroot/packware/pwbuilder/src/etc
In directory sheep:/tmp/cvs-serv15405/src/etc

Added Files:
	pwbuilder.conf.new 
Log Message:
- Initial commit.


--- NEW FILE: pwbuilder.conf.new ---
# Uncomment this if you want to see a full output of configure, make and make
# install, and to keep temporary directory.

# debug=yes

# Default target architecture is i386 on Slackware 8 and earlier, and i486
# on Slackware 9 and later. You can change default architecture here.

# target=athlon-xp

# If you want to supply extra parameters to compiler, put them below.

# cflags=

# If you have ccache installed and you want to use it to speed build process
# up, uncomment this option.

# use_ccache=yes

# If you have distcc installed and you want to use it to speed build process
# up, uncomment this option.

# use_distcc=yes

# If you don't want pwbuilder to strip binaries, uncomment the following 
# variable.

# nostrip=yes

# A directory where built packages are saved. Valid values: SRC (the same
# directory where .pwbuild script exists, the default),
# TGZ (~/tgz/packages/${target}/ - pwbuilder 0.5 behaviour), CUSTOM
# (a directory defined in custompkgdir variable).

# pkgdir="SRC"

# custompkgdir="~/packages"

# If you want pwbuilder to look for sources in other directory than this where
# .pwbuild exists, set the following variable.

# srcspool="~/sources"

# If you want pwbuilder to create temporary directory under location other
# than /tmp, use this option to change that.

# usertmp="~/tmp"

# You can choose here a SourceForge mirror to use. By default the best mirror
# will be detected automatically. If it fails, choose the mirror yourself out
# of the following: aleron, belnet, cesnet, easynews, flow, heanet, keihanna,
# twtelecom, umn, unc.

# sfmirror="unc"

# By default, pwbuilder refuses to run as root. If for some reason you need to
# do that, uncomment the option below. Note that running pwbuilder with root
# privileges is dangerous, broken or not well tested pwbuilds may modify or
# even damage your system.

# allowroot="yes"

# If your Internet connection requires the passive FTP retrieval scheme, in
# which the client initiates the data transfer, use the following option. This
# is sometimes required for FTP to work behind firewalls.

# passiveftp="yes"



From nobody at sheep.berlios.de  Fri Jul 30 00:06:52 2004
From: nobody at sheep.berlios.de (swiergot)
Date: Fri, 30 Jul 2004 00:06:52 +0200
Subject: [Packware-cvs] pwbuilder/doc COPYING,NONE,1.1 ChangeLog,NONE,1.1 README,NONE,1.1 REPO,NONE,1.1 TODO,NONE,1.1 WARNING,NONE,1.1
Message-ID: <200407292206.i6TM6q621769@bat.berlios.de>

Update of /cvsroot/packware/pwbuilder/doc
In directory sheep:/tmp/cvs-serv15405/doc

Added Files:
	COPYING ChangeLog README REPO TODO WARNING 
Log Message:
- Initial commit.


--- NEW FILE: COPYING ---
		    GNU GENERAL PUBLIC LICENSE
		       Version 2, June 1991

 Copyright (C) 1989, 1991 Free Software Foundation, Inc.
     59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
 Everyone is permitted to copy and distribute verbatim copies
 of this license document, but changing it is not allowed.

			    Preamble

  The licenses for most software are designed to take away your
freedom to share and change it.  By contrast, the GNU General Public
License is intended to guarantee your freedom to share and change free
software--to make sure the software is free for all its users.  This
General Public License applies to most of the Free Software
Foundation's software and to any other program whose authors commit to
using it.  (Some other Free Software Foundation software is covered by
the GNU Library General Public License instead.)  You can apply it to
your programs, too.

  When we speak of free software, we are referring to freedom, not
price.  Our General Public Licenses are designed to make sure that you
have the freedom to distribute copies of free software (and charge for
this service if you wish), that you receive source code or can get it
if you want it, that you can change the software or use pieces of it
in new free programs; and that you know you can do these things.

  To protect your rights, we need to make restrictions that forbid
anyone to deny you these rights or to ask you to surrender the rights.
These restrictions translate to certain responsibilities for you if you
distribute copies of the software, or if you modify it.

  For example, if you distribute copies of such a program, whether
gratis or for a fee, you must give the recipients all the rights that
you have.  You must make sure that they, too, receive or can get the
source code.  And you must show them these terms so they know their
rights.

  We protect your rights with two steps: (1) copyright the software, and
(2) offer you this license which gives you legal permission to copy,
distribute and/or modify the software.

  Also, for each author's protection and ours, we want to make certain
that everyone understands that there is no warranty for this free
software.  If the software is modified by someone else and passed on, we
want its recipients to know that what they have is not the original, so
that any problems introduced by others will not reflect on the original
authors' reputations.

  Finally, any free program is threatened constantly by software
patents.  We wish to avoid the danger that redistributors of a free
program will individually obtain patent licenses, in effect making the
program proprietary.  To prevent this, we have made it clear that any
patent must be licensed for everyone's free use or not licensed at all.

  The precise terms and conditions for copying, distribution and
modification follow.

		    GNU GENERAL PUBLIC LICENSE
   TERMS AND CONDITIONS FOR COPYING, DISTRIBUTION AND MODIFICATION

  0. This License applies to any program or other work which contains
a notice placed by the copyright holder saying it may be distributed
under the terms of this General Public License.  The "Program", below,
refers to any such program or work, and a "work based on the Program"
means either the Program or any derivative work under copyright law:
that is to say, a work containing the Program or a portion of it,
either verbatim or with modifications and/or translated into another
language.  (Hereinafter, translation is included without limitation in
the term "modification".)  Each licensee is addressed as "you".

Activities other than copying, distribution and modification are not
covered by this License; they are outside its scope.  The act of
running the Program is not restricted, and the output from the Program
is covered only if its contents constitute a work based on the
Program (independent of having been made by running the Program).
Whether that is true depends on what the Program does.

  1. You may copy and distribute verbatim copies of the Program's
source code as you receive it, in any medium, provided that you
conspicuously and appropriately publish on each copy an appropriate
copyright notice and disclaimer of warranty; keep intact all the
notices that refer to this License and to the absence of any warranty;
and give any other recipients of the Program a copy of this License
along with the Program.

You may charge a fee for the physical act of transferring a copy, and
you may at your option offer warranty protection in exchange for a fee.

  2. You may modify your copy or copies of the Program or any portion
of it, thus forming a work based on the Program, and copy and
distribute such modifications or work under the terms of Section 1
above, provided that you also meet all of these conditions:

    a) You must cause the modified files to carry prominent notices
    stating that you changed the files and the date of any change.

    b) You must cause any work that you distribute or publish, that in
    whole or in part contains or is derived from the Program or any
    part thereof, to be licensed as a whole at no charge to all third
    parties under the terms of this License.

    c) If the modified program normally reads commands interactively
    when run, you must cause it, when started running for such
    interactive use in the most ordinary way, to print or display an
    announcement including an appropriate copyright notice and a
    notice that there is no warranty (or else, saying that you provide
    a warranty) and that users may redistribute the program under
    these conditions, and telling the user how to view a copy of this
    License.  (Exception: if the Program itself is interactive but
    does not normally print such an announcement, your work based on
    the Program is not required to print an announcement.)

These requirements apply to the modified work as a whole.  If
identifiable sections of that work are not derived from the Program,
and can be reasonably considered independent and separate works in
themselves, then this License, and its terms, do not apply to those
sections when you distribute them as separate works.  But when you
distribute the same sections as part of a whole which is a work based
on the Program, the distribution of the whole must be on the terms of
this License, whose permissions for other licensees extend to the
entire whole, and thus to each and every part regardless of who wrote it.

Thus, it is not the intent of this section to claim rights or contest
your rights to work written entirely by you; rather, the intent is to
exercise the right to control the distribution of derivative or
collective works based on the Program.

In addition, mere aggregation of another work not based on the Program
with the Program (or with a work based on the Program) on a volume of
a storage or distribution medium does not bring the other work under
the scope of this License.

  3. You may copy and distribute the Program (or a work based on it,
under Section 2) in object code or executable form under the terms of
Sections 1 and 2 above provided that you also do one of the following:

    a) Accompany it with the complete corresponding machine-readable
    source code, which must be distributed under the terms of Sections
    1 and 2 above on a medium customarily used for software interchange; or,

    b) Accompany it with a written offer, valid for at least three
    years, to give any third party, for a charge no more than your
    cost of physically performing source distribution, a complete
    machine-readable copy of the corresponding source code, to be
    distributed under the terms of Sections 1 and 2 above on a medium
    customarily used for software interchange; or,

    c) Accompany it with the information you received as to the offer
    to distribute corresponding source code.  (This alternative is
    allowed only for noncommercial distribution and only if you
    received the program in object code or executable form with such
    an offer, in accord with Subsection b above.)

The source code for a work means the preferred form of the work for
making modifications to it.  For an executable work, complete source
code means all the source code for all modules it contains, plus any
associated interface definition files, plus the scripts used to
control compilation and installation of the executable.  However, as a
special exception, the source code distributed need not include
anything that is normally distributed (in either source or binary
form) with the major components (compiler, kernel, and so on) of the
operating system on which the executable runs, unless that component
itself accompanies the executable.

If distribution of executable or object code is made by offering
access to copy from a designated place, then offering equivalent
access to copy the source code from the same place counts as
distribution of the source code, even though third parties are not
compelled to copy the source along with the object code.

  4. You may not copy, modify, sublicense, or distribute the Program
except as expressly provided under this License.  Any attempt
otherwise to copy, modify, sublicense or distribute the Program is
void, and will automatically terminate your rights under this License.
However, parties who have received copies, or rights, from you under
this License will not have their licenses terminated so long as such
parties remain in full compliance.

  5. You are not required to accept this License, since you have not
signed it.  However, nothing else grants you permission to modify or
distribute the Program or its derivative works.  These actions are
prohibited by law if you do not accept this License.  Therefore, by
modifying or distributing the Program (or any work based on the
Program), you indicate your acceptance of this License to do so, and
all its terms and conditions for copying, distributing or modifying
the Program or works based on it.

  6. Each time you redistribute the Program (or any work based on the
Program), the recipient automatically receives a license from the
original licensor to copy, distribute or modify the Program subject to
these terms and conditions.  You may not impose any further
restrictions on the recipients' exercise of the rights granted herein.
You are not responsible for enforcing compliance by third parties to
this License.

  7. If, as a consequence of a court judgment or allegation of patent
infringement or for any other reason (not limited to patent issues),
conditions are imposed on you (whether by court order, agreement or
otherwise) that contradict the conditions of this License, they do not
excuse you from the conditions of this License.  If you cannot
distribute so as to satisfy simultaneously your obligations under this
License and any other pertinent obligations, then as a consequence you
may not distribute the Program at all.  For example, if a patent
license would not permit royalty-free redistribution of the Program by
all those who receive copies directly or indirectly through you, then
the only way you could satisfy both it and this License would be to
refrain entirely from distribution of the Program.

If any portion of this section is held invalid or unenforceable under
any particular circumstance, the balance of the section is intended to
apply and the section as a whole is intended to apply in other
circumstances.

It is not the purpose of this section to induce you to infringe any
patents or other property right claims or to contest validity of any
such claims; this section has the sole purpose of protecting the
integrity of the free software distribution system, which is
implemented by public license practices.  Many people have made
generous contributions to the wide range of software distributed
through that system in reliance on consistent application of that
system; it is up to the author/donor to decide if he or she is willing
to distribute software through any other system and a licensee cannot
impose that choice.

This section is intended to make thoroughly clear what is believed to
be a consequence of the rest of this License.

  8. If the distribution and/or use of the Program is restricted in
certain countries either by patents or by copyrighted interfaces, the
original copyright holder who places the Program under this License
may add an explicit geographical distribution limitation excluding
those countries, so that distribution is permitted only in or among
countries not thus excluded.  In such case, this License incorporates
the limitation as if written in the body of this License.

  9. The Free Software Foundation may publish revised and/or new versions
of the General Public License from time to time.  Such new versions will
be similar in spirit to the present version, but may differ in detail to
address new problems or concerns.

Each version is given a distinguishing version number.  If the Program
specifies a version number of this License which applies to it and "any
later version", you have the option of following the terms and conditions
either of that version or of any later version published by the Free
Software Foundation.  If the Program does not specify a version number of
this License, you may choose any version ever published by the Free Software
Foundation.

  10. If you wish to incorporate parts of the Program into other free
programs whose distribution conditions are different, write to the author
to ask for permission.  For software which is copyrighted by the Free
Software Foundation, write to the Free Software Foundation; we sometimes
make exceptions for this.  Our decision will be guided by the two goals
of preserving the free status of all derivatives of our free software and
of promoting the sharing and reuse of software generally.

			    NO WARRANTY

  11. BECAUSE THE PROGRAM IS LICENSED FREE OF CHARGE, THERE IS NO WARRANTY
FOR THE PROGRAM, TO THE EXTENT PERMITTED BY APPLICABLE LAW.  EXCEPT WHEN
OTHERWISE STATED IN WRITING THE COPYRIGHT HOLDERS AND/OR OTHER PARTIES
PROVIDE THE PROGRAM "AS IS" WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED
OR IMPLIED, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF
MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  THE ENTIRE RISK AS
TO THE QUALITY AND PERFORMANCE OF THE PROGRAM IS WITH YOU.  SHOULD THE
PROGRAM PROVE DEFECTIVE, YOU ASSUME THE COST OF ALL NECESSARY SERVICING,
REPAIR OR CORRECTION.

  12. IN NO EVENT UNLESS REQUIRED BY APPLICABLE LAW OR AGREED TO IN WRITING
WILL ANY COPYRIGHT HOLDER, OR ANY OTHER PARTY WHO MAY MODIFY AND/OR
REDISTRIBUTE THE PROGRAM AS PERMITTED ABOVE, BE LIABLE TO YOU FOR DAMAGES,
INCLUDING ANY GENERAL, SPECIAL, INCIDENTAL OR CONSEQUENTIAL DAMAGES ARISING
OUT OF THE USE OR INABILITY TO USE THE PROGRAM (INCLUDING BUT NOT LIMITED
TO LOSS OF DATA OR DATA BEING RENDERED INACCURATE OR LOSSES SUSTAINED BY
YOU OR THIRD PARTIES OR A FAILURE OF THE PROGRAM TO OPERATE WITH ANY OTHER
PROGRAMS), EVEN IF SUCH HOLDER OR OTHER PARTY HAS BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.

		     END OF TERMS AND CONDITIONS

	    How to Apply These Terms to Your New Programs

  If you develop a new program, and you want it to be of the greatest
possible use to the public, the best way to achieve this is to make it
free software which everyone can redistribute and change under these terms.

  To do so, attach the following notices to the program.  It is safest
to attach them to the start of each source file to most effectively
convey the exclusion of warranty; and each file should have at least
the "copyright" line and a pointer to where the full notice is found.

    <one line to give the program's name and a brief idea of what it does.>
    Copyright (C) <year>  <name of author>

    This program is free software; you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation; either version 2 of the License, or
    (at your option) any later version.

    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with this program; if not, write to the Free Software
    Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA


Also add information on how to contact you by electronic and paper mail.

If the program is interactive, make it output a short notice like this
when it starts in an interactive mode:

    Gnomovision version 69, Copyright (C) year  name of author
    Gnomovision comes with ABSOLUTELY NO WARRANTY; for details type `show w'.
    This is free software, and you are welcome to redistribute it
    under certain conditions; type `show c' for details.

The hypothetical commands `show w' and `show c' should show the appropriate
parts of the General Public License.  Of course, the commands you use may
be called something other than `show w' and `show c'; they could even be
mouse-clicks or menu items--whatever suits your program.

You should also get your employer (if you work as a programmer) or your
school, if any, to sign a "copyright disclaimer" for the program, if
necessary.  Here is a sample; alter the names:

  Yoyodyne, Inc., hereby disclaims all copyright interest in the program
  `Gnomovision' (which makes passes at compilers) written by James Hacker.

  <signature of Ty Coon>, 1 April 1989
  Ty Coon, President of Vice

This General Public License does not permit incorporating your program into
proprietary programs.  If your program is a subroutine library, you may
consider it more useful to permit linking proprietary applications with the
library.  If this is what you want to do, use the GNU Library General
Public License instead of this License.

--- NEW FILE: ChangeLog ---
pwbuilder 0.6.4 - 
-----------------------------

- If info from .pwinfo file is empty, do not include brackets after ${name}
  in slack-desc file.
- Reimplemented _execindir function. execindir script is no longer available.
- _execindir changes _configure, _make, _install, _cmi, _py_build and
  _py_install working directories.
- Added _setexecdir and _unsetexecdir to set and unset directory for
  _execindir function.
- Added _qconf_fix that fixes a problem with Makefiles generated by qconf with
  ../ bug.

pwbuilder 0.6.3 - 30-Dec-2003
-----------------------------

- Allow give _chmod and _chown paths starting with ${pkg}.
- Added execindir script to be used in pwbuild files.
- Added _execindir function that invokes execindir script.
- Added _next_configure, _next_make and _next_install functions.
- NLS (idea and Polish translation by Szymon Owczarek).
- Implemented sfmirror autodetection.
- When debug mode is on, print a command to be executed (suggested by
  Mamading Ceesay).
- Added _require function.

pwbuilder 0.6.2 - 09-Oct-2003
-----------------------------

- Rewritten _pwbuilder function to handle unknown versions.
- Added _have_recode function.
- Added -c option to _source function.
- Added _have_alsa function.
- Prevented expanding wildcards in pwbuild files.
- Added passiveftp option to enable passive FTP downloads.
- Set srcx variable to point to most recently defined source.
- Stop building if patching failed unless -i option was used.
- When source was not found but -i option was used, don't stop building.
- Partial code rewrite and cleanup.
- Sybolic links are now handled by external program (sltd from pwutils);
  increased compatibility, stablity and reliability.
- Manual page files defined symbolic links are now handled by external program
  (sltm from pwutils); increased compatibility, stability and reliability.
- ln used in .pwbuild files is always ln -f now.
- Improved, fixed and speeded up architecture dependance detection
  (most of #5).
- Made -b in _doc affect -x option.
- Fixed _doc -x.
- Added _have_libmng function.
- Added _have_ldap function.

pwbuilder 0.6.1 - 04-Sep-2003
-----------------------------

- Added sfmirror config file option to specify SourceForge mirror to use.
- Added usertmp config file option to use temporary directory other that /tmp
  (Marcin Gil).
- Ignore error messages when removing unneeded empty directories.
- Added _have_apache1 and _have_apache2 functions.
- _py_install executes setup.py with --root=${pkg} by default.
- _py_install invoked with -u doesn't pass --root=${pkg}.
- Fixed _py_build and _py_install - pass all options after anything else.
- Make -b in _doc affect also explicit docs (closes #10).
- Upgraded to fakeroot 0.7.5.
- Added -b option to _sub command to allow to define build number (closes #9).
- Added -b option to _configure, _make, _install, _py_build and _py_install to
  allow to run these in a subdirectory of souce tree (closes #4).
- Added -b option to _cmi so it passes this option to invoked commands.
- Added -u option to _cmi so it passes this option to _install (closes #16).
- Fixed documentation.
- Made _pwbuilder more verbose.
- Export SED=/usr/bin/sed to fix some programs.
- chown /bin, /sbin, /usr/bin and /usr/sbin to root.bin in packages
  (closes #19).
- Added _have_c_client and _have_cyrus functions.
- Added --allow-root switch to pwbuilder and allowroot config option.
- Added _set function (supported variables: ${package}-postinst,
  ${package-pwinfo}.
- Added _have_mm function.
- Added -s option to _source so size of source can be given and displayed
  when building (suggested by Sydney Green 22).

pwbuilder 0.6.0 - 02-Aug-2003
-----------------------------

--- NEW FILE: README ---
===============================================================================
pwbuilder 0.6 - Slackware packages building system
Copyright (c) 2002-2003 The Packware Project
===============================================================================

This program is free software; you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation; either version 2 of the License, or
(at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program; if not, write to the Free Software
Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA

You should find the copy of GNU General Public License in file COPYING
in the directory where you are.

===============================================================================

See doc subdirectory for details on using pwbuilder.

Look at http://cvs.intersec.pl/ for .pwbuild examples.

Visit our website at http://packware.intersec.pl/ and
http://freshmeat.net/projects/pwbuilder/.

-- 
Jaroslaw Swierczynski <swiergot at intersec.pl>

--- NEW FILE: REPO ---
pwbuilder has been developed in The Packware Project CVS repository. You can
access the repository anonymously:

cvs -d:pserver:anonymous at cvs.intersec.pl:/cvs login
Logging in to :pserver:anonymous at cvs.intersec.pl:2401/cvs
CVS password: [just press Enter]
cvs -z3 co pwbuilder

Alternatively, you can use a web interface at http://cvs.intersec.pl/.

--- NEW FILE: TODO ---
For a list of things to do please visit our Bug Tracking System at
http://packware.intersec.pl/bts/.

--- NEW FILE: WARNING ---
WARNING! pwbuilder 0.6 is completely incompatible with pwbuilder 0.5. There is
no buildpkg, there is pwbuilder command instead. We don't use .pwbuilder files
any more, new format is .pwbuild. It's got completely different syntax. In
other words, everything has changed!



From nobody at sheep.berlios.de  Fri Jul 30 00:06:55 2004
From: nobody at sheep.berlios.de (swiergot)
Date: Fri, 30 Jul 2004 00:06:55 +0200
Subject: [Packware-cvs] pwbuilder/src/usr/lib/pwbuilder/include createenv,NONE,1.1 createpkg,NONE,1.1 finishpkg,NONE,1.1 functions,NONE,1.1 mainfunc,NONE,1.1 runbuild,NONE,1.1 slackver,NONE,1.1 version,NONE,1.1
Message-ID: <200407292206.i6TM6t621799@bat.berlios.de>

Update of /cvsroot/packware/pwbuilder/src/usr/lib/pwbuilder/include
In directory sheep:/tmp/cvs-serv15405/src/usr/lib/pwbuilder/include

Added Files:
	createenv createpkg finishpkg functions mainfunc runbuild 
	slackver version 
Log Message:
- Initial commit.


--- NEW FILE: createenv ---
#!/bin/sh

buid="${RANDOM}${RANDOM}${RANDOM}" ; export buid

if [ "${usertmp}" = "" ]; then

	tmp="/tmp/pwbuilder-${buid}"

else

	eval "tmp=${usertmp}/pwbuilder-${buid}"

fi

mkdir -p ${tmp} ; chmod 700 ${tmp} ; export tmp

pkg="${tmp}/installroot" ; mkdir -p ${pkg}     ; export pkg
xsrcdir="${tmp}/sources" ; mkdir -p ${xsrcdir} ; export xsrcdir
scripts="${tmp}/scripts" ; mkdir -p ${scripts} ; export scripts
sub="${tmp}/subs"        ; mkdir -p ${sub}     ; export sub
var="${tmp}/var"         ; mkdir -p ${var}     ; export var
empty="${tmp}/empty"     ; mkdir -p ${empty}   ; export empty

egrep "^[ ]*[a-zA-Z0-9_]+=" "${buildscript}" > ${scripts}/bsdefs
source ${scripts}/bsdefs

docdir="/usr/doc/${name}-${version}" ; export docdir
doc="${pkg}${docdir}"                ; export doc    ; mkdir -p ${doc}

export pw_target="${target}"
export pw_debug="${debug}"

if [ "${pw_target}" = "i386" ]; then

	coflags="-march=i386 -mcpu=i686 ${cflags}"

elif [ "${pw_target}" = "i486" ]; then

	coflags="-march=i486 -mcpu=i686 ${cflags}"

else

	coflags="-march=${pw_target} -mcpu=${pw_target} ${cflags}"

fi

if [ "${use_ccache}" = "yes" ]; then

	CC="ccache gcc ${coflags}"
	CXX="ccache g++ ${coflags}"

	if [ "${use_distcc}" = "yes" ]; then

		CCACHE_PREFIX="distcc" ; export CCACHE_PREFIX

	fi

elif [ "${use_distcc}" = "yes" ]; then

	CC="distcc gcc ${coflags}"
	CXX="distcc g++ ${coflags}"

else

	CC="gcc ${coflags}"
	CXX="g++ ${coflags}"

fi

export CC CXX coflags

AM_CFLAGS="${coflags}"   ; export AM_CFLAGS
AM_CXXFLAGS="${coflags}" ; export AM_CXXFLAGS
AM_CPPFLAGS="${coflags}" ; export AM_CPPFLAGS

src="`dirname \"${buildscript}\"`"

if echo ${src} | grep '^[.]$' > /dev/null 2>&1; then

	src="`pwd`"

elif echo ${src} | grep '^[.][.]/' > /dev/null 2>&1; then

	src="`pwd`/${src}"

elif echo ${src} | grep '^[.]/' > /dev/null 2>&1; then

	src="`pwd`/${src}"

elif echo ${src} | grep -v '^/' > /dev/null 2>&1; then

	src="`pwd`/${src}"

fi

export src

fqbsp="${src}/`basename ${buildscript}`" ; export fqbsp

if [ "${srcspool}" = "" ]; then

	srcspool="${src}"

else

	eval "srcspool=${srcspool}"

fi

export srcspool

export sfmirror passiveftp

export SED=/usr/bin/sed

cd ${empty}

--- NEW FILE: createpkg ---
#!/bin/sh

if [ -f ${scripts}/save ]; then

	source ${scripts}/save

fi

if [ -f ${tmp}/config ]; then

	source ${tmp}/config

fi

source /usr/lib/pwbuilder/include/internal/doc
source /usr/lib/pwbuilder/include/internal/var
source /usr/lib/pwbuilder/include/internal/arch

if [ -f ${scripts}/doc ]; then

	source ${scripts}/doc
	finish_doc

fi

rmdir ${pkg}/usr/doc/${name}-${version} > /dev/null 2>&1
rmdir ${pkg}/usr/doc > /dev/null 2>&1
rmdir ${pkg}/usr > /dev/null 2>&1

cat ${scripts}/bsdefs > ${scripts}/subsed
echo -n "sed " >> ${scripts}/subsed

for d in `cut -d '=' -f 1 ${scripts}/bsdefs | tr -d ' '`; do

	echo -n "-e \"s!\\\${${d}}!\${${d}}!g\" " >> ${scripts}/subsed

done

echo "\$1" >> ${scripts}/subsed

touch ${tmp}/sub

for u in `cat ${tmp}/sub`; do

	s=`echo ${u} | cut -d '=' -f 1`

	if [ ! -f ${src}/${s}.pwsub ]; then

		continue

	fi

	mkdir -p ${sub}/${s}

	echo "${sub}/${s}" >> ${tmp}/subdirs

	sh ${scripts}/subsed ${src}/${s}.pwsub > ${tmp}/${s}.list

	cat ${tmp}/${s}.list |

	while read item; do

		idir=`dirname "${item}"`
		mkdir -p ${sub}/${s}/"${idir}" > /dev/null 2>&1
		mv ${pkg}/"${item}" ${sub}/${s}/"${idir}" > /dev/null 2>&1

	done

done

if [ -f ${tmp}/toremove ]; then

	for i in `cat ${tmp}/toremove`; do

		rm -rf $pkg/${i}

	done

fi

rm -rf ${pkg}/usr/man/cat* ${pkg}/var/man/cat*

rmdir ${pkg}/usr/man > /dev/null 2>&1
rmdir ${pkg}/usr > /dev/null 2>&1

rmdir ${pkg}/var/man > /dev/null 2>&1
rmdir ${pkg}/var > /dev/null 2>&1

if [ -d ${pkg}/usr/man ]; then

	find ${pkg}/usr/man -type l -exec /usr/lib/pwbuilder/bin/sltm {} \;

fi

touch ${tmp}/subdirs

for i in ${pkg} `cat ${tmp}/subdirs` ; do

(

cd ${i}

pkgname=`basename ${i}`

if [ "${pkgname}" = "installroot" ]; then

	pkgname="${name}"

fi

find . -type l -exec /usr/lib/pwbuilder/bin/sltd {} \; >> ${tmp}/links

if [ -f ${tmp}/links ]; then

	if [ -s ${tmp}/links ]; then

		mkdir install > /dev/null 2>&1
		cat ${tmp}/links > install/doinst.sh

	fi

	rm -f ${tmp}/links

fi

postinst="`getvar ${pkgname}-postinst`"

if [ "${postinst}" = "" ]; then

	postinst=${pkgname}

fi

if [ -f ${src}/${postinst}.pw-postinst ]; then

	mkdir install > /dev/null 2>&1
	cat ${src}/${postinst}.pw-postinst >> install/doinst.sh

fi

pwinfo="`getvar ${pkgname}-pwinfo`"

if [ "${pwinfo}" = "" ]; then

	pwinfo=${pkgname}

fi

if [ -f ${tmp}/req-${pkgname} ]; then

	mkdir install > /dev/null 2>&1
	cp ${tmp}/req-${pkgname} install/slack-required

fi

if [ -f ${src}/${pwinfo}.pwinfo ]; then

	source ${src}/${pwinfo}.pwinfo

	if [ ! "${desc}" = "" ]; then

		mkdir install > /dev/null 2>&1

		if [ ! "${info}" = "" ]; then

			echo "${pkgname}: ${pkgname} (${info})" > install/slack-desc

		else

			echo "${pkgname}: ${pkgname}" > install/slack-desc

		fi

		echo "${pkgname}:" >> install/slack-desc
		echo "${desc}" | /usr/lib/pwbuilder/bin/desc ${pkgname} >> install/slack-desc

	fi

	unset info
	unset desc

fi

find . -type l -exec rm -f {} \;

find . -type f -path '*/man/*man?/*.*' ! -path '*.gz' -exec gzip -9f {} \;

if [ -d usr/info ]; then

	rm -f usr/info/dir > /dev/null 2>&1
	gzip -9f usr/info/*.info* > /dev/null 2>&1

fi

if [ ! "${nostrip}" = "yes" ]; then

	find . -type f -perm +111 -exec strip --strip-unneeded {} \; > /dev/null 2>&1

fi

find . -type f -perm +111 -exec chmod 755 {} \; > /dev/null 2>&1
find . -type f ! -perm +111 -exec chmod 644 {} \; > /dev/null 2>&1
find . -type d -exec chmod 755 {} \; > /dev/null 2>&1

if is_arch_dep; then

	architecture="`echo ${pw_target} | tr - _`"

else

	architecture="noarch"

fi

if [ "${pkgdir}" = "TGZ" ]; then

	eval "targetpkgdir=~/tgz/packages/${architecture}"
	mkdir -p ${targetpkgdir} > /dev/null 2>&1

elif [ "${pkgdir}" = "CUSTOM" -a ! "${custompkgdir}" = "" ]; then

	eval "custompkgdir=${custompkgdir}"

	if [ -d ${custompkgdir} ]; then

		targetpkgdir="${custompkgdir}"

	else

		targetpkgdir="${src}"

	fi

else

	targetpkgdir="${src}"

fi

buildnum=`grep "^${pkgname}=" ${tmp}/sub | cut -d '=' -f 2`

if [ "${buildnum}" = "" ]; then

	buildnum="${build}"

fi

pkgfile="${pkgname}-`echo ${version} | tr - _`-${architecture}-${buildnum}"

fakeroot sh /usr/lib/pwbuilder/include/finishpkg ${pkgfile} ${targetpkgdir} ${scripts}

)

done

--- NEW FILE: finishpkg ---
#!/bin/sh

# $1 is ${pkgfile}
# $2 is ${targetpkgdir}
# $3 is ${scripts}

pwtext "+ Package %s.tgz" $1

chown -R root.root . > /dev/null 2>&1
chown -R root.bin bin > /dev/null 2>&1
chown -R root.bin sbin > /dev/null 2>&1
chown -R root.bin usr/bin > /dev/null 2>&1
chown -R root.bin usr/sbin > /dev/null 2>&1

if [ -f $3/chmod ]; then

	source $3/chmod > /dev/null 2>&1

fi

if [ -f $3/chown ]; then

	source $3/chown > /dev/null 2>&1

fi

tar-1.13 cf $1.tar . > /dev/null 2>&1
gzip -9 $1.tar > /dev/null 2>&1

mv -f $1.tar.gz $2/$1.tgz > /dev/null 2>&1

--- NEW FILE: functions ---
#!/bin/sh

for i in /usr/lib/pwbuilder/include/funcs/*; do

	source ${i}

done

for i in /usr/lib/pwbuilder/include/have/*; do

	source ${i}

done

--- NEW FILE: mainfunc ---
#!/bin/sh

function usage() {

	pwtext "Usage: pwbuilder [-d] [-s] [-t arch] [-r] target"
	echo
	pwtext "       --debug       , -d        Show full compilation output. Don't remove"
	pwtext "                                 working directory at the end."
	pwtext "       --no-strip    , -s        Don't strip binaries."
	pwtext "       --target arch , -t arch   Build for specified architecture."
	pwtext "       --allow-root  , -r        Allow to run as root."

}

function findscript() {

	if [ "$1" = "" ]; then

		ls `basename \`pwd\``.pwbuild > /dev/null 2>&1

		if [ $? = 0 ]; then

			echo `basename \`pwd\``.pwbuild
			return

		fi

	fi

	for i in . $1; do

		ls ${i}/$1.pwbuild > /dev/null 2>&1

		if [ $? = 0 ]; then

			echo ${i}/$1.pwbuild
			return

		fi

		try=`ls -1 ${i}/*.pwbuild 2> /dev/null`

		if [ ! "$?" = "0" ]; then

			continue

		fi

		if [ `echo "${try}" | wc -l | tr -d ' '` = 1 ]; then

			echo ${try}
			return

		fi

	done

}

--- NEW FILE: runbuild ---
#!/bin/sh

alias ln='ln -f'
alias cp='cp -f'

source /usr/lib/pwbuilder/include/version
source /usr/lib/pwbuilder/include/functions

srccnt=0

source ${fqbsp}

echo "name=${name}" >> ${scripts}/save
echo "version=${version}" >> ${scripts}/save
echo "build=${build}" >> ${scripts}/save

echo "namever=${name}-${version}" >> ${scripts}/save

echo "scripts=${scripts}" >> ${scripts}/save
echo "sub=${sub}" >> ${scripts}/save

--- NEW FILE: slackver ---
#!/bin/sh

slackver="`sed 's}Slackware }}' /etc/slackware-version | cut -f 1 -d ' '`"

slackver_max="`echo ${slackver} | cut -f 1 -d -`"
slackver_ext="`echo ${slackver} | cut -f 2 -d -`"

if [ "${slackver_max}" = "${slackver_ext}" ]; then

    slackver_ext=""

fi

slackver_a="`echo ${slackver_max} | cut -f 1 -d '.'`"
slackver_b="`echo ${slackver_max} | cut -f 2 -d '.'`"
slackver_c="`echo ${slackver_max} | cut -f 3 -d '.'`"

slackver="${slackver_a}.${slackver_b}"

if [ "${slackver_c}" = "" ]; then

    slackver_c="0"

fi

slackver_max="$slackver_a.$slackver_b.$slackver_c"

export slackver_a
export slackver_b
export slackver_c
export slackver
export slackver_max

--- NEW FILE: version ---
#!/bin/sh

pwbuilder_version=0.6.4



From nobody at sheep.berlios.de  Fri Jul 30 00:06:55 2004
From: nobody at sheep.berlios.de (swiergot)
Date: Fri, 30 Jul 2004 00:06:55 +0200
Subject: [Packware-cvs] pwbuilder/src/usr/lib/pwbuilder/include/have alsa,NONE,1.1 apache1,NONE,1.1 apache2,NONE,1.1 aspell,NONE,1.1 c_client,NONE,1.1 cyrus,NONE,1.1 glib,NONE,1.1 glib2,NONE,1.1 gpg,NONE,1.1 gpgme,NONE,1.1 gtk,NONE,1.1 gtk2,NONE,1.1 imlib,NONE,1.1 ldap,NONE,1.1 libmng,NONE,1.1 mm,NONE,1.1 mysql,NONE,1.1 ncurses,NONE,1.1 openssl,NONE,1.1 perl,NONE,1.1 pgsql,NONE,1.1 python,NONE,1.1 qt,NONE,1.1 recode,NONE,1.1 sasl,NONE,1.1 sasl2,NONE,1.1 sdl,NONE,1.1 slang,NONE,1.1 tcl,NONE,1.1 tclx,NONE,1.1 tk,NONE,1.1
Message-ID: <200407292206.i6TM6t621807@bat.berlios.de>

Update of /cvsroot/packware/pwbuilder/src/usr/lib/pwbuilder/include/have
In directory sheep:/tmp/cvs-serv15405/src/usr/lib/pwbuilder/include/have

Added Files:
	alsa apache1 apache2 aspell c_client cyrus glib glib2 gpg 
	gpgme gtk gtk2 imlib ldap libmng mm mysql ncurses openssl perl 
	pgsql python qt recode sasl sasl2 sdl slang tcl tclx tk 
Log Message:
- Initial commit.


--- NEW FILE: alsa ---
#!/bin/sh

function _have_alsa() {

	if [ -f /usr/include/alsa/asoundlib.h ]; then

		return 0;

	else

		return 1;

	fi

}

--- NEW FILE: apache1 ---
#!/bin/sh

function _have_apache1() {

	if [ ! -x /usr/sbin/httpd ]; then

		return 1;

	fi

	if /usr/sbin/httpd -v | grep Apache/1 > /dev/null 2>&1; then

		return 0;

	fi

	return 1;

}

--- NEW FILE: apache2 ---
#!/bin/sh

function _have_apache2() {

	if [ ! -x /usr/sbin/httpd ]; then

		return 1;

	fi

	if /usr/sbin/httpd -v | grep Apache/1 > /dev/null 2>&1; then

		return 1;

	fi

	return 0;

}

--- NEW FILE: aspell ---
#!/bin/sh

function _have_aspell() {

	if [ -x /usr/bin/aspell ]; then

		return 0;

	else

		return 1;

	fi

}

--- NEW FILE: c_client ---
#!/bin/sh

function _have_c_client() {

	if [ -f /usr/lib/c-client.a -a -d /usr/include/c-client ]; then

		return 0;

	else

		return 1;

	fi

}

--- NEW FILE: cyrus ---
#!/bin/sh

function _have_cyrus() {

	if [ -f /usr/lib/libcyrus.a -a -d /usr/include/cyrus ]; then

		return 0;

	else

		return 1;

	fi

}

--- NEW FILE: glib ---
#!/bin/sh

function _have_glib() {

	if [ -x /usr/bin/glib-config ]; then

		return 0;

	else

		return 1;

	fi

}

--- NEW FILE: glib2 ---
#!/bin/sh

function _have_glib2() {

	if [ -f /usr/lib/pkgconfig/glib-2.0.pc ]; then

		return 0;

	else

		return 1;

	fi

}

--- NEW FILE: gpg ---
#!/bin/sh

function _have_gpg() {

	if [ -x /usr/bin/gpg ]; then

		return 0;

	else

		return 1;

	fi

}

--- NEW FILE: gpgme ---
#!/bin/sh

function _have_gpgme() {

	if [ -x /usr/bin/gpgme-config ]; then

		return 0;

	else

		return 1;

	fi

}

--- NEW FILE: gtk ---
#!/bin/sh

function _have_gtk() {

	if [ -x /usr/bin/gtk-config ]; then

		return 0;

	else

		return 1;

	fi

}

--- NEW FILE: gtk2 ---
#!/bin/sh

function _have_gtk2() {

	if [ -f /usr/lib/pkgconfig/gtk+-2.0.pc ]; then

		return 0;

	else

		return 1;

	fi

}

--- NEW FILE: imlib ---
#!/bin/sh

function _have_imlib() {

	if [ -x /usr/bin/imlib_config ]; then

		return 0;

	else

		return 1;

	fi

}

--- NEW FILE: ldap ---
#!/bin/sh

function _have_ldap() {

	if [ -f /usr/include/ldap.h ]; then

		return 0;

	else

		return 1;

	fi

}

--- NEW FILE: libmng ---
#!/bin/sh

function _have_libmng() {

	if [ -f /usr/lib/libmng.so ]; then

		return 0;

	else

		return 1;

	fi

}

--- NEW FILE: mm ---
#!/bin/sh

function _have_mm() {

	if [ -x /usr/bin/mm-config ]; then

		return 0;

	else

		return 1;

	fi

}

--- NEW FILE: mysql ---
#!/bin/sh

function _have_mysql() {

	if [ -x /usr/bin/mysql_config ]; then

		return 0;

	else

		return 1;

	fi

}

--- NEW FILE: ncurses ---
#!/bin/sh

function _have_ncurses() {

	if [ -x /usr/lib/libncurses.so ]; then

		return 0;

	else

		return 1;

	fi

}

--- NEW FILE: openssl ---
#!/bin/sh

function _have_openssl() {

	if [ -f /usr/lib/pkgconfig/openssl.pc ]; then

		return 0;

	else

		return 1;

	fi

}

--- NEW FILE: perl ---
#!/bin/sh

function _have_perl() {

	if [ -x /usr/bin/perl ]; then

		return 0;

	else

		return 1;

	fi

}

--- NEW FILE: pgsql ---
#!/bin/sh

function _have_pgsql() {

	if [ -x /usr/bin/pg_config ]; then

		return 0;

	else

		return 1;

	fi

}

--- NEW FILE: python ---
#!/bin/sh

function _have_python() {

	if [ -x /usr/bin/python ]; then

		return 0;

	else

		return 1;

	fi

}

--- NEW FILE: qt ---
#!/bin/sh

function _have_qt() {

	if [ -d /usr/lib/qt ]; then

		return 0;

	else

		return 1;

	fi

}

--- NEW FILE: recode ---
#!/bin/sh

function _have_recode() {

	if [ -x /usr/include/recode.h ]; then

		return 0;

	else

		return 1;

	fi

}

--- NEW FILE: sasl ---
#!/bin/sh

function _have_sasl() {

	if [ -d /usr/lib/sasl ]; then

		return 0;

	else

		return 1;

	fi

}

--- NEW FILE: sasl2 ---
#!/bin/sh

function _have_sasl2() {

	if [ -d /usr/lib/sasl2 ]; then

		return 0;

	else

		return 1;

	fi

}

--- NEW FILE: sdl ---
#!/bin/sh

function _have_sdl() {

	if [ -x /usr/bin/sdl-config ]; then

		return 0;

	else

		return 1;

	fi

}

--- NEW FILE: slang ---
#!/bin/sh

function _have_slang() {

	if [ -x /usr/lib/libslang.so ]; then

		return 0;

	else

		return 1;

	fi

}

--- NEW FILE: tcl ---
#!/bin/sh

function _have_tcl() {

	if [ -x /usr/lib/libtcl.so ]; then

		return 0;

	else

		return 1;

	fi

}

--- NEW FILE: tclx ---
#!/bin/sh

function _have_tclx() {

	if [ -x /usr/lib/libtclx.so ]; then

		return 0;

	else

		return 1;

	fi

}

--- NEW FILE: tk ---
#!/bin/sh

function _have_tk() {

	if [ -x /usr/lib/libtk.so ]; then

		return 0;

	else

		return 1;

	fi

}



From nobody at sheep.berlios.de  Fri Jul 30 00:06:54 2004
From: nobody at sheep.berlios.de (swiergot)
Date: Fri, 30 Jul 2004 00:06:54 +0200
Subject: [Packware-cvs] pwbuilder/src/usr/lib/pwbuilder default.conf,NONE,1.1
Message-ID: <200407292206.i6TM6s621789@bat.berlios.de>

Update of /cvsroot/packware/pwbuilder/src/usr/lib/pwbuilder
In directory sheep:/tmp/cvs-serv15405/src/usr/lib/pwbuilder

Added Files:
	default.conf 
Log Message:
- Initial commit.


--- NEW FILE: default.conf ---
#!/bin/sh

# DO NOT EDIT THIS FILE! PLEASE EDIT /etc/pwbuilder.conf or ~/.pwbuilderrc
# INSTEAD!

if [ "${target}" = "" ]; then

	if [ "${slackver_a}" -ge "9" ]; then

		target="i486"

	else

		target="i386"

	fi

fi

if [ "${sfmirror}" = "" -o "${sfmirror}" = "auto" ]; then

	automirror=`/usr/lib/pwbuilder/bin/getsfmirror 2> /dev/null`

	if [ $? = 0 ]; then

		sfmirror=${automirror}

	else

		sfmirror="unc"

	fi

fi



From nobody at sheep.berlios.de  Fri Jul 30 00:06:54 2004
From: nobody at sheep.berlios.de (swiergot)
Date: Fri, 30 Jul 2004 00:06:54 +0200
Subject: [Packware-cvs] pwbuilder/src/usr/lib/pwbuilder/bin cp,NONE,1.1 ln,NONE,1.1 mkdir,NONE,1.1 mv,NONE,1.1 rm,NONE,1.1
Message-ID: <200407292206.i6TM6s621793@bat.berlios.de>

Update of /cvsroot/packware/pwbuilder/src/usr/lib/pwbuilder/bin
In directory sheep:/tmp/cvs-serv15405/src/usr/lib/pwbuilder/bin

Added Files:
	cp ln mkdir mv rm 
Log Message:
- Initial commit.


--- NEW FILE: cp ---
#!/bin/sh

exec /bin/cp -f "$@"

--- NEW FILE: ln ---
#!/bin/sh

exec /bin/ln -f "$@"

--- NEW FILE: mkdir ---
#!/bin/sh

exec /bin/mkdir -p "$@"

--- NEW FILE: mv ---
#!/bin/sh

exec /bin/mv -f "$@"

--- NEW FILE: rm ---
#!/bin/sh

exec /bin/rm -f "$@"



From nobody at sheep.berlios.de  Fri Jul 30 00:06:56 2004
From: nobody at sheep.berlios.de (swiergot)
Date: Fri, 30 Jul 2004 00:06:56 +0200
Subject: [Packware-cvs] pwbuilder/src/usr/lib/pwbuilder/include/internal arch,NONE,1.1 doc,NONE,1.1 var,NONE,1.1
Message-ID: <200407292206.i6TM6u621813@bat.berlios.de>

Update of /cvsroot/packware/pwbuilder/src/usr/lib/pwbuilder/include/internal
In directory sheep:/tmp/cvs-serv15405/src/usr/lib/pwbuilder/include/internal

Added Files:
	arch doc var 
Log Message:
- Initial commit.


--- NEW FILE: arch ---
#!/bin/sh

function is_arch_dep () {

	if [ -d lib/modules ]; then

		return 0

	fi

	if [ -d usr/lib ]; then

		if find usr/lib -type f -name '*.a' | grep '[.]a$' > /dev/null 2>&1; then

			return 0

		fi

	fi

	if [ -d usr/src ]; then

		if find usr/src -name bzImage | grep bzImage > /dev/null 2>&1; then

			return 0

		fi

	fi

	# Which one is faster?
	#find . -type f -exec file -b {} \; | sort | uniq | egrep "x86|186|286|386|8086|Dev86|Intel 80" > /dev/null 2>&1
	find . -type f ! -path './usr/include/*' ! -name '*.h' -exec file -b {} \; | \
		egrep "x86|186|286|386|8086|Dev86|Intel 80" > /dev/null 2>&1

	return $?

}

--- NEW FILE: doc ---
#!/bin/sh

function copy_defdoc() {

	eval "srcd=\"\${src$1}\""

	altdir=""

	if [ ! "$2" = "x" ]; then

		altdir="`echo $2 | cut -c 2-`"
		echo "${altdir}" >> ${tmp}/altdirs
		altdir="-${altdir}"

	fi

	(

	unset LC_ALL
	unset LANG

	cd "${srcd}"

	if [ "$3" = "" ]; then

		find . | egrep '^[.]/[A-Z]+$|^[.]/ABOUT-NLS$' | sed "s}\.}${srcd}}" >> ${tmp}/doc${altdir}

	else

		cd $3
		find . | egrep '^[.]/[A-Z]+$|^[.]/ABOUT-NLS$' | sed "s}\.}${srcd}/$3}" >> ${tmp}/doc${altdir}

	fi

	)

}

function copy_doc() {

	eval "srcd=\"\${src$1}\""

	shift

	altdir=""

	if [ ! "$1" = "x" ]; then

		altdir="`echo $1 | cut -c 2-`"
		echo "${altdir}" >> ${tmp}/altdirs
		altdir="-${altdir}"

	fi

	shift

	[ ! "$1" = "" ] && subdir="/$1"

	shift

	for i in "$@"; do
	
		echo "${srcd}${subdir}/${i}" >> ${tmp}/doc${altdir}

	done

}

function exclude_doc() {

	eval "srcd=\"\${src$1}\""

	shift

	altdir=""

	if [ ! "$1" = "x" ]; then

		altdir="`echo $1 | cut -c 2-`"
		echo "${altdir}" >> ${tmp}/altdirs
		altdir="-${altdir}"

	fi

	shift

	[ ! "$1" = "" ] && subdir="/$1"

	shift

	for i in "$@"; do

		echo "${srcd}${subdir}/${i}" >> ${tmp}/exdoc${altdir}

	done

}

function finish_doc() {

	touch ${tmp}/doc
	touch ${tmp}/exdoc
	sort ${tmp}/doc ${tmp}/exdoc | uniq -u > ${tmp}/redoc
	[ -s ${tmp}/redoc ] && cp -af `cat ${tmp}/redoc` ${doc}

	if [ -f ${tmp}/altdirs ]; then

		sort ${tmp}/altdirs | uniq > ${tmp}/realtdirs

		for i in `cat ${tmp}/realtdirs`; do

			touch ${tmp}/exdoc-${i}
			sort ${tmp}/doc-${i} ${tmp}/exdoc-${i} | uniq -u > ${tmp}/redoc
			mkdir ${pkg}/usr/doc/${i}
			[ -s ${tmp}/redoc ] && cp -af `cat ${tmp}/redoc` ${pkg}/usr/doc/${i}

		done

	fi

}

--- NEW FILE: var ---
#!/bin/sh

function getvar() {

	if [ ! -f "${var}/$1" ]; then

		return

	fi

	cat ${var}/$1

}



From nobody at sheep.berlios.de  Fri Jul 30 00:06:53 2004
From: nobody at sheep.berlios.de (swiergot)
Date: Fri, 30 Jul 2004 00:06:53 +0200
Subject: [Packware-cvs] pwbuilder/doc/guide DESTDIR,NONE,1.1 FILES,NONE,1.1 HAVE,NONE,1.1 PWBUILD,NONE,1.1 PWINFO,NONE,1.1 SUBPACKAGES,NONE,1.1 VARIABLES,NONE,1.1 janosik.pwinfo,NONE,1.1 slack-desc,NONE,1.1
Message-ID: <200407292206.i6TM6r621773@bat.berlios.de>

Update of /cvsroot/packware/pwbuilder/doc/guide
In directory sheep:/tmp/cvs-serv15405/doc/guide

Added Files:
	DESTDIR FILES HAVE PWBUILD PWINFO SUBPACKAGES VARIABLES 
	janosik.pwinfo slack-desc 
Log Message:
- Initial commit.


--- NEW FILE: DESTDIR ---
pwbuilder automatically sets some variables for make install called by
_install. Those variables include:

DESTDIR=${pkg}
INSTALLROOT=${pkg}
INSTALL_ROOT=${pkg}
PERL_INSTALL_ROOT=${pkg}
INSTALL_PREFIX=${pkg}

Thus it's not required to put in .pwbuilds commands like:

_i_opt DESTDIR=${pkg}

If for some reason these definitions break make install, you can turn them off
by passing -u option to _install.

--- NEW FILE: FILES ---
*.pwbuild

Main building script. The file doesn't need (though it might, better not) to
be executable. Name of this file doesn't need to be related to package name
in any way. Available commands has been described in PWBUILD file.

*.pwinfo

A file with informations about package (description etc.) Name of this file
should be the same as package name. Details in PWINFO file.

*.pwsub

A list of files and directories belonging to a subpackage. Name of this file
should be the same as subpackage name. If there is "_sub NAME" command in
.pwbuild script, there must be NAME.pwsub file (additionally there might be
NAME.pwinfo, too).

*.pw-postinst

A script that will be included in package as install/doinst.sh file and
executed when installing the package. Name of this file should be the same as
name of package or subpackage.

--- NEW FILE: HAVE ---
There are commands available for .pwbuild script that allow to check installed
software. Examples include:

_have_openssl && _c_opt --with-openssl
_have_mysql && _c_opt --with-mysql

_have_* commands return 0 if software exists, or 1 if it doesn't. To know what
_have_* commands are available, look into /usr/lib/pwbuilder/include/have
directory.

_have_* commands have been used ie. in php or sylpheed-claws packages.

--- NEW FILE: PWBUILD ---
_doc [-d] [-b subdirectory] [-r directory] [-s N] [-x file] [files]

Points to files that will be put as documentation in
/usr/doc/${name}-${version} directory. Files are separated with space. Their
location is relative to source directory. This command can be used many times.

-d - automatically select files whose names have all letters upper-case.
ABOUT-NLS file will be copied, too. With this option you can still define
addtional files in a normal way.

-b subdirectory - look for -d files in given subdirectory rather that top
level directory of sources.

-s N - the default source if the first one. This option allows to change the
source number.

-x file - exclude file from automatically selected files. This option can be
used many times.

-r directory - defines a directory that the files will be put in. It will be
/usr/doc/${directory} instead of /usr/doc/${name}-${version}.

_doc command is available since version 0.6.0 of pwbuilder.

-------------------------------------------------------------------------------

_source [-f] [-p proj] [-t dir] [-g] [-z] [-u] [-m md5] [-n name] [-v ver] [-i] [url]

Adds new source. File location can be given as URL address that begins with
http:// or ftp://. If URL ends with '/', file name is set automatically this
way: '${name}-${version}.tar.bz2'.

-g - use '.tar.gz' rather than '.tar.bz2' when setting file name automatically.

-z - use '.tgz' rather than '.tar.bz2' when setting file name automatically.

-Z - use '.zip' rather than '.tar.bz2' when setting file name automatically.

-n string - use ${string} instead of ${name} when setting file name
automatically.

-v string - use ${string} instead of ${version} when setting file name
automatically.

-m md5 - sets md5 checksum for file. This checksum is used to verify file
before unpacking.

-t dir - changes top directory of source. Default is file name without
extension.

-u - causes source not to be unpacked, even if there is such possibility.

-f - tells pwbuilder that a source can be obtained for SourceForge. URL is not
needed then and is formed automatically in this way:
http://unc.dl.sourceforge.net/sourceforge/${name}/${name}-${version}.tar.bz2.
If -g option is used, .tar.gz version will be fetched instead of .tar.bz2 one.

-p proj - if -f option is used, and a source is in other directory than ${name}
(a directory after /sourceforge/ is different), this option will let you
overwrite name of this directory.

-s size - size of source. It will be displayed after "+ Source " label.

-c - when autocompleting source location, use an underscore instead of a dash
to join ${name} and ${version}.

-i - when source will not be found, don't stop building.

_source command is available since version 0.6.0 of pwbuilder.
-s option is available since version 0.6.1 of pwbuilder.
-c option is available since version 0.6.2 of pwbuilder.
-i option is available since version 0.6.2 of pwbuilder.

-------------------------------------------------------------------------------

_c_opt [-s N] options

Passes options to configure script that is executed by _configure command.

-s N - use options for source number N instead of 1.

_c_opt command is available since version 0.6.0 of pwbuilder.

-------------------------------------------------------------------------------

_m_opt [-s N] options

Passes options to make that is executed by _make command.

-s N - use options for source number N instead of 1.

_m_opt command is available since version 0.6.0 of pwbuilder.

-------------------------------------------------------------------------------

_i_opt [-s N] options

Passes options to make install that is executed by _install command.

-s N - use options for source number N instead of 1.

_i_opt command is available since version 0.6.0 of pwbuilder.

-------------------------------------------------------------------------------

_configure [-s N] [-b subdirectory] [options]

Executes configure script and gives it additional options.

-s N - execute configure for source number N instead of 1.

-b subdirectory - execute configure in a subdirectory of source tree. Instead
of using -b option, _configure command may be preceded by _execindir command.

_configure command is available since version 0.6.0 of pwbuilder.
-b option is available since version 0.6.1 of pwbuilder.

-------------------------------------------------------------------------------

_make [-s N] [-b subdirectory] [options]

Executes make and gives it additional options.

-s N - execute make for source number N instead of 1.

-b subdirectory - execute make in a subdirectory of source tree. Instead
of using -b option, _make command may be preceded by _execindir command.

_make command is available since version 0.6.0 of pwbuilder.
-b option is available since version 0.6.1 of pwbuilder.

-------------------------------------------------------------------------------

_install [-s N] [-u] [-b subdirectory] [options]

Executes make install and gives it additional options.

-s N - execute make install for source number N instead of 1.

-b subdirectory - execute make install in a subdirectory of source tree.
Instead of using -b option, _install command may be preceded by _execindir
command.

-u - don't set DESTDIR, INSTALLROOT, INSTALL_ROOT, PERL_ISNTALL_ROOT and
INSTALL_PREFIX variables for make install.

_install command is available since version 0.6.0 of pwbuilder.
-b option is availabe since version 0.6.1 of pwbuilder.

-------------------------------------------------------------------------------

_cmi [-s N] [-u] [-b subdirectory]

Executes _configure, _make and _install.

-s N - execute these commands for source number N instead of 1.

-b subdirectory - execute these commands in a subdirectory of source tree.
Instead of using -b option, _cmi command may be preceded by _execindir command.

-u - don't set DESTDIR, INSTALLROOT, INSTALL_ROOT, PERL_ISNTALL_ROOT and
INSTALL_PREFIX variables for make install.

_cmi command is available since version 0.6.0 of pwbuilder.
-b option is available since version 0.6.1 of pwbuilder.
-u option is available since version 0.6.1 of pwbuilder.

-------------------------------------------------------------------------------

_py_b_opt options

Passes options to python setup.py build that is called by _py_build.

_py_b_opt command is available since version 0.6.0 of pwbuilder.

-------------------------------------------------------------------------------

_py_i_opt options

Passes options to python setup.py install that is called by _py_install.

_py_i_opt command is available since version 0.6.0 of pwbuilder.

-------------------------------------------------------------------------------

_py_build [-b subdirectory] [options]

Executes python setup.py build and gives it additional options.

-b subdirectory - execute in a subdirectory of source tree. Instead of using
-b option, _py_build command may be preceded by _execindir command.

_py_build command is available since version 0.6.0 of pwbuilder.
-b option is available since version 0.6.1 of pwbuilder.

-------------------------------------------------------------------------------

_py_install [-u] [-b subdirectory] [options]

Executes python setup.py install and gives it additional options.

-u - don't pass --root=${pkg} to python setup.py install.

-b subdirectory - execute in a subdirectory of source tree. Instead of using
-b option, _py_install command may be preceded by _execindir command.

_py_install command is available since version 0.6.0 of pwbuilder.
-u option is available since version 0.6.1 of pwbuilder.
-b option is available since version 0.6.1 of pwbuilder.

-------------------------------------------------------------------------------

_patch [-s N] [-p N] [-i] file

Applies patch from given file. File can be defined directly or indirectly -
pwbuilder will try this then: ${name}-${plik}.pw.patch,
${name}-${plik}.pw.diff, ${name}-${plik}.patch, ${name}-${plik}.diff,
${plik}.patch, ${plik}.diff. If file begins with '/', it is used as absolute
path to particular file.

-s N - applies patch for source number N instead of 1.

-p N - applies patch with level N instead of 1.

-i - don't stop building if patch failed.

_patch command is available since version 0.6.0 of pwbuilder.
-i option is available since version 0.6.2 of pwbuilder.

-------------------------------------------------------------------------------

_chmod [-R] perms files

Sets non-standard file permisions. Just before saving package, permisions of
all files are being reset to 644, and directories to 755. This command allows
to override this settings.

-R - the same as -R in chmod(1).

_chmod command is available since version 0.6.0 of pwbuilder.

-------------------------------------------------------------------------------

_chown [-R] [-d] owning files

Sets non-standard file owning. Just before saving package, ownings of all files
and directories to root.root. This command allows to override this settings.

-R - the same as -R in chown(1).

-d - the same as --dereference in chown(1).

_chown command is available since version 0.6.0 of pwbuilder.

-------------------------------------------------------------------------------

_sub name

Defines a subpackage with given name.

_sub command is available since version 0.6.0 of pwbuilder.

-------------------------------------------------------------------------------

_pwbuilder required

Defines the oldest pwbuilder version that is able to build a package. This
command is intended to use at the beginning of .pwbuild script, before basic
variables (name, versio, build etc.) or just after them. This command checks
whether existing pwbuilder version is greater than or equal to required
version. If not, it stops pwbuilder.

_pwbuilder command is available since version 0.6.0 of pwbuilder.

-------------------------------------------------------------------------------

_remove [file/dir...]

This command removes given files/directories from main package. It's helpful
if we define more than one subpackage and there are needless files or
directories left in main package.

_remove command is available since version 0.6.0 of pwbuilder.

-------------------------------------------------------------------------------

_alt_configure [-s N] command

Changes command that will be executed by _configure instead of ./configure.

-s N - changes command for source number N instead of 1.

_alt_configure command is available since version 0.6.0 of pwbuilder.

-------------------------------------------------------------------------------

_alt_make [-s N] command

Changes command that will be executed by _make instead of make.

-s N - changes command for source number N instead of 1.

_alt_make command is available since version 0.6.0 of pwbuilder.

-------------------------------------------------------------------------------

_alt_install [-s N] command

Changes command that will be executed by _install instead of make install.

-s N - changes command for source number N instead of 1.

_alt_install command is available since version 0.6.0 of pwbuilder.

-------------------------------------------------------------------------------

_next_configure [-s N] command

Like _alt_configure but sets the command only for the next _configure call.

_next_configure command is available since version 0.6.3 of pwbuilder.

-------------------------------------------------------------------------------

_next_make [-s N] command

Like _alt_make but sets the command only for the next _make call.

_next_make command is available since version 0.6.3 of pwbuilder.

-------------------------------------------------------------------------------

_next_install [-s N] command

Like _alt_install but sets the command only for the next _install call.

_next_install command is available since version 0.6.3 of pwbuilder.

-------------------------------------------------------------------------------

_config [-s]

Allows to override /etc/pwbuilder.conf or ~/.pwbuilderrc or commandline
settings.

-s - don't strip binaries.

_config command is available since version 0.6.0 of pwbuilder.

-------------------------------------------------------------------------------

_require package [[-eq|-gt|-lt|-ge|-le] version[-build]] [-p subpackage]

Tell pwbuilder what requirements built package has. pwbuilder will create
install/slack-required file from this data.

-p subpackage - requirement applies to a subpackage, not main package.

  -----------------------------------------------
 | Relation | Meaning | Comment                  |
 |----------|---------|--------------------------|
 | -eq      | =       | equal to                 |
 | -gt      | >       | greater than             |
 | -lt      | <       | lower than               |
 | -ge      | >=      | greater than or equal to |
 | -le      | <=      | lower than or equal to   |
  -----------------------------------------------

Examples:

_require openssl
_require openssl -ge 0.9.7
_require openssl -eq 0.9.7-2
_require openssl -gt 0.9.7-i386-2

_require command is available since version 0.6.3 of pwbuilder.

-------------------------------------------------------------------------------

_execindir directory command

Executes the command in the directory. If _setexecdir was used, then directory
must not be given.

_execindir command is available since version 0.6.3 of pwbuilder.

-------------------------------------------------------------------------------

_setexecdir directory

Sets directory for _execindir.

_setexecdir command is available since version 0.6.4 of pwbuilder.

-------------------------------------------------------------------------------

_unsetexecdir

Unsets directory for _execindir.

_unsetexecdir command is available since version 0.6.4 of pwbuilder.

-------------------------------------------------------------------------------

_qconf_fix file

Fixes a problem with Makefiles generated by qconf with ../ bug.

file - buggy Makefile

--- NEW FILE: PWINFO ---
In a directory that contains .pwbuild script, one can put ${name}.pwinfo file,
where ${name} is a value of name variable in .pwbuild script.

In .pwinfo file, some variables should be defined. They include:

info - short description of package, half line long.

desc - longer description.

desc field is automatically formated during building package. A way of
formatting is illustrated by attached files. File janosik.pwinfo is an example
of such file. File slack-desc is an output file, generated from janosik.pwinfo.
slack-desc can't have more than eleven lines. One paragraph should be written
in one line, without breaking a line.

--- NEW FILE: SUBPACKAGES ---
pwbuilder has an ability to create subpackages. First, in .pwbuil script there
should be _sub command to define a subpackage, ie.:

_sub libgadu

and the subpackage will be named ${subpackage}, not ${name}-${subpackage}.
Second is to define a list of files and directories that will get into the
subpackage. It is done by creating ${subpackage}.pwsub file. Example content:

/usr/include
/usr/lib
/usr/doc/ekg-${version}/api.txt
/usr/doc/ekg-${version}/protocol.html
/usr/doc/ekg-${version}/functions.txt

As you can see, we can use variables defined in .pwbuild. And they are not only
name, version and build variables, but any variables declared in .pwbuild
script. Warning: names of variables must be enclosed in {} brackets, we can't
write just $version.
Optionally, we can create .pwinfo files for subpackages, named
${subpackage}.pwinfo.

Full ekg package source that makes use of subpackages feature can be found
in out CVS.

--- NEW FILE: VARIABLES ---
tmp - temporary directory unique for every pwbuilder process.

pkg - directory that will be used as install root for a package. Content of
this directory will become package content.

doc - directory ${pkg}/usr/doc/${name}-${version} with package documentation.

docdir - equals to /usr/doc/${name}-${version}.

src - directory that contains .pwbuild script.

srcN - directories with sources that was added by _source command (N = 1...).

srcx - recently defined srcN.

slackver - version of existing Slackware (8.0, 8.1, 9.0, etc.).

slackver_a - first part of full version (7, 8, 9, etc.).

slackver_b - second part of full version (0, 1 etc.).

slackver_c - third part of full version (0, 01 etc.).

slackver_max - full version, equals to
${slackver_a}.${slackver_b}.${slackver_c} (np 8.0.0, 8.1.0, 9.0.0 etc.).

--- NEW FILE: janosik.pwinfo ---
info="An open source alternative for Platnik."
desc="Janosik is a free and open implementation of Platnik, a program that is required for electronic transfer of papers to ZUS (a Polish national insurance office).

Platnik is available only for MS Windows. Janosik has been written in Python, and thus it runs on all platforms Python and PyGTK2 are ported to."

--- NEW FILE: slack-desc ---
janosik: janosik (An open source alternative for Platnik.)
janosik:
janosik: Janosik is a free and open implementation of Platnik, a program that
janosik: is required for electronic transfer of papers to ZUS (a Polish
janosik: national insurance office).
janosik: 
janosik: Platnik is available only for MS Windows. Janosik has been written in
janosik: Python, and thus it runs on all platforms Python and PyGTK2 are ported
janosik: to.
janosik:
janosik:
janosik:



From nobody at sheep.berlios.de  Fri Jul 30 00:06:53 2004
From: nobody at sheep.berlios.de (swiergot)
Date: Fri, 30 Jul 2004 00:06:53 +0200
Subject: [Packware-cvs] pwbuilder/po pl.po,NONE,1.1 pwbuilder.pot,NONE,1.1
Message-ID: <200407292206.i6TM6r621777@bat.berlios.de>

Update of /cvsroot/packware/pwbuilder/po
In directory sheep:/tmp/cvs-serv15405/po

Added Files:
	pl.po pwbuilder.pot 
Log Message:
- Initial commit.


--- NEW FILE: pl.po ---
# Szymon Owczarek <szymon at intersec.pl>, 2003.
#
msgid ""
msgstr ""
"Project-Id-Version: pl\n"
"POT-Creation-Date: 2003-07-09 12:52+0200\n"
"PO-Revision-Date: 2003-12-30 21:10+0100\n"
"Last-Translator: Szymon Owczarek <szymon at intersec.pl>\n"
"Language-Team: Polish <pl at li.org>\n"
"MIME-Version: 1.0\n"
"Content-Type: text/plain; charset=ISO-8859-2\n"
"Content-Transfer-Encoding: 8bit\n"
"X-Generator: KBabel 1.0.2\n"

#: /usr/lib/pwbuilder/include/mainfunc:5
msgid "Usage: pwbuilder [-d] [-s] [-t arch] [-r] target"
msgstr "U?ycie: pwbuilder [-d] [-s] [-t arch] [-r] cel"

#: /usr/lib/pwbuilder/include/mainfunc:7
msgid "       --debug       , -d        Show full compilation output. Don't remove"
msgstr "       --debug       , -d        Poka? wszystkie komunikaty. Nie usuwaj"

#: /usr/lib/pwbuilder/include/mainfunc:8
msgid "                                 working directory at the end."
msgstr "                                 katalogu domowego po zako?czeniu."

#: /usr/lib/pwbuilder/include/mainfunc:9
msgid "       --no-strip    , -s        Don't strip binaries."
msgstr "       --no-strip    , -s        Nie stripuj binari?w."

#: /usr/lib/pwbuilder/include/mainfunc:10
msgid "       --target arch , -t arch   Build for specified architecture."
msgstr "       --target arch , -t arch   Buduj dla okre?lonej architektury."

#: /usr/lib/pwbuilder/include/mainfunc:11
msgid "       --allow-root  , -r        Allow to run as root."
msgstr "       --allow-root  , -r        Zezw?l na prac? z konta root."

#: /usr/lib/pwbuilder/include/finishpkg:7
msgid "+ Package %s.tgz"
msgstr "+ Pakiet %s.tgz"

#: /usr/lib/pwbuilder/include/funcs/set:7
msgid "_set: not enough parameters."
msgstr "_set: za ma?o argument?w."

#: /usr/lib/pwbuilder/include/funcs/sub:23
msgid "_sub: subpackage name not supplied"
msgstr "_sub: nie podano nazwy podpakietu"

#: /usr/lib/pwbuilder/include/funcs/make:65
msgid "! Error: make failed"
msgstr "! B??d: make nie powiod?o si?"

#: /usr/lib/pwbuilder/include/funcs/pwbuilder:17
msgid "_pwbuilder: missing argument"
msgstr "_pwbuilder: brak argumentu"

#: /usr/lib/pwbuilder/include/funcs/pwbuilder:24
msgid "_pwbuilder: invalid version"
msgstr "_pwbuilder: nieprawid?owa wersja"

#: /usr/lib/pwbuilder/include/funcs/pwbuilder:34
msgid "! Error: your pwbuilder %s is too old (at least %s needed)"
msgstr "! Error: tw?j pwbuilder %s jest za stary (wymagany conajmniej %s)"

#: /usr/lib/pwbuilder/include/funcs/c_opt:23
msgid "_c_opt: no option specified"
msgstr "_c_opt: nie podano opcji"

#: /usr/lib/pwbuilder/include/funcs/chmod:44
msgid "_chmod: mode not specified"
msgstr "_chmod: nie podano trybu"

#: /usr/lib/pwbuilder/include/funcs/chmod:51
msgid "_chmod: no files specified"
msgstr "_chmod: nie podano pliku"

#: /usr/lib/pwbuilder/include/funcs/chown:46
msgid "_chown: owning not specified"
msgstr "_chown: nie podano w?a?ciciela"

#: /usr/lib/pwbuilder/include/funcs/chown:53
msgid "_chown: no files specified"
msgstr "_chown: nie podano pliku"

#: /usr/lib/pwbuilder/include/funcs/next_make:23
msgid "_next_make: no command specified"
msgstr "_next_make: nie podano polecenia"

#: /usr/lib/pwbuilder/include/funcs/i_opt:23
msgid "_i_opt: no option specified"
msgstr "_i_opt: nie podano opcji"

#: /usr/lib/pwbuilder/include/funcs/m_opt:23
msgid "_m_opt: no option specified"
msgstr "_m_opt: nie podano opcji"

#: /usr/lib/pwbuilder/include/funcs/patch:27
msgid "_patch: no patch specified"
msgstr "_patch: nie podano ?aty"

#: /usr/lib/pwbuilder/include/funcs/patch:44
msgid "+ Patch %s"
msgstr "+ ?ata: %s"

#: /usr/lib/pwbuilder/include/funcs/patch:54
msgid "! Error: file not found"
msgstr "+ B??d: nie znaleziono pliku"

#: /usr/lib/pwbuilder/include/funcs/patch:101
msgid "! Error: no matching file"
msgstr "! B??d: brak pasuj?cego pliku"

#: /usr/lib/pwbuilder/include/funcs/patch:125
msgid "! Error: applying failed"
msgstr "! B??d: na?o?enie nie powiod?o si?"

#: /usr/lib/pwbuilder/include/funcs/configure:65
msgid "! Error: configure failed"
msgstr "! B??d: configure nie powiod?o si?"

#: /usr/lib/pwbuilder/include/funcs/alt_configure:23
msgid "_alt_configure: no command specified"
msgstr "_alt_configure: nie podano polecenia"

#: /usr/lib/pwbuilder/include/funcs/next_configure:23
msgid "_next_configure: no command specified"
msgstr "_next_configure: nie podano polecenia"

#: /usr/lib/pwbuilder/include/funcs/config:7
msgid "_config: no option specified"
msgstr "_config: nie podano opcji"

#: /usr/lib/pwbuilder/include/funcs/config:17
msgid "_config: invalid option - %s"
msgstr "_config: b??dna opcja - %s"

#: /usr/lib/pwbuilder/include/funcs/py_b_opt:23
msgid "_py_b_opt: no option specified"
msgstr "_py_b_opt: nie podano opcji"

#: /usr/lib/pwbuilder/include/funcs/py_build:49
msgid "! Error: python build failed"
msgstr "! B??d: python build nie powiod?o si?"

#: /usr/lib/pwbuilder/include/funcs/py_i_opt:23
msgid "_py_i_opt: no option specified"
msgstr "_py_i_opt: nie podano opcji"

#: /usr/lib/pwbuilder/include/funcs/remove:7
msgid "_remove: no file or directory supplied"
msgstr "_remove: nie podano pliku ani katalogu"

#: /usr/lib/pwbuilder/include/funcs/source:92
msgid "+ Source %s"
msgstr "+ ?r?d?o: %s"

#: /usr/lib/pwbuilder/include/funcs/source:155
msgid "! Error: none valid found"
msgstr "! B??d: nie znaleziono poprawnego"

#: /usr/lib/pwbuilder/include/funcs/source:194
msgid "_source: unsupported format"
msgstr "_source: nieobs?ugiwany format"

#: /usr/lib/pwbuilder/include/funcs/source:200
msgid "! Error: extracting failed"
msgstr "! B??d: rozpakowanie nie powiod?o si?"

#: /usr/lib/pwbuilder/include/funcs/alt_install:23
msgid "_alt_install: no command specified"
msgstr "_alt_install: nie podano polecenia"

#: /usr/lib/pwbuilder/include/funcs/install:73
msgid "! Error: make install failed"
msgstr "! B?ad: make install nie powiod?o si?"

#: /usr/lib/pwbuilder/include/funcs/alt_make:23
msgid "_alt_make: no command specified"
msgstr "_alt_make: nie podano polecenia"

#: /usr/lib/pwbuilder/include/funcs/next_install:23
msgid "_next_install: no command specified"
msgstr "_next_install: nie podano polecenia"

#: /usr/lib/pwbuilder/include/funcs/py_install:57
msgid "! Error: python install failed"
msgstr "! B??d: python install nie powiod?o si?"

#: /usr/lib/pwbuilder/include/funcs/require:30
msgid "_require: no package specified"
msgstr "_require: nie podano pakietu"

#: /usr/lib/pwbuilder/include/funcs/require:37
msgid "_require: condition used but no version specified"
msgstr "_require: u?yto warunku ale nie podano wersji"

#: /usr/bin/pwbuilder:5
msgid "pwbuilder %s - Slackware packages building system"
msgstr "pwbuilder %s - system budowy pakiet?w Slackware'a"

#: /usr/bin/pwbuilder:11
msgid "fakeroot not found."
msgstr "fakeroot nie znaleziony."

#: /usr/bin/pwbuilder:51
msgid "Refusing to run as root."
msgstr "Odmawiam dzia?ania jako root."

#: /usr/bin/pwbuilder:76
msgid "Nothing to build."
msgstr "Nie ma nic do roboty."

#: /usr/bin/pwbuilder:81
msgid "Executing %s..."
msgstr "Uruchamiam %s..."

#: /usr/bin/pwbuilder:90
msgid "Creating packages..."
msgstr "Tworz? pakiety..."

#: /usr/bin/pwbuilder:97
msgid "Cleaning up..."
msgstr "Sprz?tam..."


--- NEW FILE: pwbuilder.pot ---
# SOME DESCRIPTIVE TITLE.
# Copyright (C) YEAR THE PACKAGE'S COPYRIGHT HOLDER
# This file is distributed under the same license as the PACKAGE package.
# FIRST AUTHOR <EMAIL at ADDRESS>, YEAR.
#
#, fuzzy
msgid ""
msgstr ""
"Project-Id-Version: PACKAGE VERSION\n"
"POT-Creation-Date: 2003-07-09 12:52+0200\n"
"PO-Revision-Date: YEAR-MO-DA HO:MI+ZONE\n"
"Last-Translator: FULL NAME <EMAIL at ADDRESS>\n"
"Language-Team: LANGUAGE <LL at li.org>\n"
"MIME-Version: 1.0\n"
"Content-Type: text/plain; charset=CHARSET\n"
"Content-Transfer-Encoding: 8bit\n"

#: /usr/lib/pwbuilder/include/mainfunc:5
msgid "Usage: pwbuilder [-d] [-s] [-t arch] [-r] target"
msgstr ""

#: /usr/lib/pwbuilder/include/mainfunc:7
msgid "       --debug       , -d        Show full compilation output. Don't remove"
msgstr ""

#: /usr/lib/pwbuilder/include/mainfunc:8
msgid "                                 working directory at the end."
msgstr ""

#: /usr/lib/pwbuilder/include/mainfunc:9
msgid "       --no-strip    , -s        Don't strip binaries."
msgstr ""

#: /usr/lib/pwbuilder/include/mainfunc:10
msgid "       --target arch , -t arch   Build for specified architecture."
msgstr ""

#: /usr/lib/pwbuilder/include/mainfunc:11
msgid "       --allow-root  , -r        Allow to run as root."
msgstr ""

#: /usr/lib/pwbuilder/include/finishpkg:7
msgid "+ Package %s.tgz"
msgstr ""

#: /usr/lib/pwbuilder/include/funcs/set:7
msgid "_set: not enough parameters."
msgstr ""

#: /usr/lib/pwbuilder/include/funcs/sub:23
msgid "_sub: subpackage name not supplied"
msgstr ""

#: /usr/lib/pwbuilder/include/funcs/make:65
msgid "! Error: make failed"
msgstr ""

#: /usr/lib/pwbuilder/include/funcs/pwbuilder:17
msgid "_pwbuilder: missing argument"
msgstr ""

#: /usr/lib/pwbuilder/include/funcs/pwbuilder:24
msgid "_pwbuilder: invalid version"
msgstr ""

#: /usr/lib/pwbuilder/include/funcs/pwbuilder:34
msgid "! Error: your pwbuilder %s is too old (at least %s needed)"
msgstr ""

#: /usr/lib/pwbuilder/include/funcs/c_opt:23
msgid "_c_opt: no option specified"
msgstr ""

#: /usr/lib/pwbuilder/include/funcs/chmod:44
msgid "_chmod: mode not specified"
msgstr ""

#: /usr/lib/pwbuilder/include/funcs/chmod:51
msgid "_chmod: no files specified"
msgstr ""

#: /usr/lib/pwbuilder/include/funcs/chown:46
msgid "_chown: owning not specified"
msgstr ""

#: /usr/lib/pwbuilder/include/funcs/chown:53
msgid "_chown: no files specified"
msgstr ""

#: /usr/lib/pwbuilder/include/funcs/next_make:23
msgid "_next_make: no command specified"
msgstr ""

#: /usr/lib/pwbuilder/include/funcs/i_opt:23
msgid "_i_opt: no option specified"
msgstr ""

#: /usr/lib/pwbuilder/include/funcs/m_opt:23
msgid "_m_opt: no option specified"
msgstr ""

#: /usr/lib/pwbuilder/include/funcs/patch:27
msgid "_patch: no patch specified"
msgstr ""

#: /usr/lib/pwbuilder/include/funcs/patch:44
msgid "+ Patch %s"
msgstr ""

#: /usr/lib/pwbuilder/include/funcs/patch:54
msgid "! Error: file not found"
msgstr ""

#: /usr/lib/pwbuilder/include/funcs/patch:101
msgid "! Error: no matching file"
msgstr ""

#: /usr/lib/pwbuilder/include/funcs/patch:125
msgid "! Error: applying failed"
msgstr ""

#: /usr/lib/pwbuilder/include/funcs/configure:65
msgid "! Error: configure failed"
msgstr ""

#: /usr/lib/pwbuilder/include/funcs/alt_configure:23
msgid "_alt_configure: no command specified"
msgstr ""

#: /usr/lib/pwbuilder/include/funcs/next_configure:23
msgid "_next_configure: no command specified"
msgstr ""

#: /usr/lib/pwbuilder/include/funcs/config:7
msgid "_config: no option specified"
msgstr ""

#: /usr/lib/pwbuilder/include/funcs/config:17
msgid "_config: invalid option - %s"
msgstr ""

#: /usr/lib/pwbuilder/include/funcs/py_b_opt:23
msgid "_py_b_opt: no option specified"
msgstr ""

#: /usr/lib/pwbuilder/include/funcs/py_build:49
msgid "! Error: python build failed"
msgstr ""

#: /usr/lib/pwbuilder/include/funcs/py_i_opt:23
msgid "_py_i_opt: no option specified"
msgstr ""

#: /usr/lib/pwbuilder/include/funcs/remove:7
msgid "_remove: no file or directory supplied"
msgstr ""

#: /usr/lib/pwbuilder/include/funcs/source:92
msgid "+ Source %s"
msgstr ""

#: /usr/lib/pwbuilder/include/funcs/source:155
msgid "! Error: none valid found"
msgstr ""

#: /usr/lib/pwbuilder/include/funcs/source:194
msgid "_source: unsupported format"
msgstr ""

#: /usr/lib/pwbuilder/include/funcs/source:200
msgid "! Error: extracting failed"
msgstr ""

#: /usr/lib/pwbuilder/include/funcs/alt_install:23
msgid "_alt_install: no command specified"
msgstr ""

#: /usr/lib/pwbuilder/include/funcs/install:73
msgid "! Error: make install failed"
msgstr ""

#: /usr/lib/pwbuilder/include/funcs/alt_make:23
msgid "_alt_make: no command specified"
msgstr ""

#: /usr/lib/pwbuilder/include/funcs/next_install:23
msgid "_next_install: no command specified"
msgstr ""

#: /usr/lib/pwbuilder/include/funcs/py_install:57
msgid "! Error: python install failed"
msgstr ""

#: /usr/lib/pwbuilder/include/funcs/require:30
msgid "_require: no package specified"
msgstr ""

#: /usr/lib/pwbuilder/include/funcs/require:37
msgid "_require: condition used but no version specified"
msgstr ""

#: /usr/bin/pwbuilder:5
msgid "pwbuilder %s - Slackware packages building system"
msgstr ""

#: /usr/bin/pwbuilder:11
msgid "fakeroot not found."
msgstr ""

#: /usr/bin/pwbuilder:51
msgid "Refusing to run as root."
msgstr ""

#: /usr/bin/pwbuilder:76
msgid "Nothing to build."
msgstr ""

#: /usr/bin/pwbuilder:81
msgid "Executing %s..."
msgstr ""

#: /usr/bin/pwbuilder:90
msgid "Creating packages..."
msgstr ""

#: /usr/bin/pwbuilder:97
msgid "Cleaning up..."
msgstr ""




From nobody at sheep.berlios.de  Fri Jul 30 00:06:55 2004
From: nobody at sheep.berlios.de (swiergot)
Date: Fri, 30 Jul 2004 00:06:55 +0200
Subject: [Packware-cvs] pwbuilder/src/usr/lib/pwbuilder/include/funcs alt_configure,NONE,1.1 alt_install,NONE,1.1 alt_make,NONE,1.1 c_opt,NONE,1.1 chmod,NONE,1.1 chown,NONE,1.1 cmi,NONE,1.1 config,NONE,1.1 configure,NONE,1.1 doc,NONE,1.1 execindir,NONE,1.1 i_opt,NONE,1.1 install,NONE,1.1 m_opt,NONE,1.1 make,NONE,1.1 next_configure,NONE,1.1 next_install,NONE,1.1 next_make,NONE,1.1 patch,NONE,1.1 pwbuilder,NONE,1.1 py_b_opt,NONE,1.1 py_build,NONE,1.1 py_i_opt,NONE,1.1 py_install,NONE,1.1 qconf_fix,NONE,1.1 remove,NONE,1.1 require,NONE,1.1 set,NONE,1.1 setexecdir,NONE,1.1 source,NONE,1.1 sub,NONE,1.1 unsetexecdir,NONE,1.1
Message-ID: <200407292206.i6TM6t621803@bat.berlios.de>

Update of /cvsroot/packware/pwbuilder/src/usr/lib/pwbuilder/include/funcs
In directory sheep:/tmp/cvs-serv15405/src/usr/lib/pwbuilder/include/funcs

Added Files:
	alt_configure alt_install alt_make c_opt chmod chown cmi 
	config configure doc execindir i_opt install m_opt make 
	next_configure next_install next_make patch pwbuilder py_b_opt 
	py_build py_i_opt py_install qconf_fix remove require set 
	setexecdir source sub unsetexecdir 
Log Message:
- Initial commit.


--- NEW FILE: alt_configure ---
#!/bin/sh

function _alt_configure() {

	srcnum="1"
	altconfigure=""

	while [ $# -gt 0 ]; do

		case "$1" in

			-s) shift ; srcnum="$1" ;;
			*) altconfigure="${altconfigure} $1" ;;

		esac

		shift

	done

	if [ "${altconfigure}" = "" ]; then

		pwtext "_alt_configure: no command specified"
		exit 2

	fi

	echo -n " ${altconfigure} " >> ${tmp}/altconfigure_${srcnum}

}

--- NEW FILE: alt_install ---
#!/bin/sh

function _alt_install() {

	srcnum="1"
	altinstall=""

	while [ $# -gt 0 ]; do

		case "$1" in

			-s) shift ; srcnum="$1" ;;
			*) altinstall="${altinstall} $1" ;;

		esac

		shift

	done

	if [ "${altinstall}" = "" ]; then

		pwtext "_alt_install: no command specified"
		exit 2

	fi

	echo -n " ${altinstall} " >> ${tmp}/altinstall_${srcnum}

}

--- NEW FILE: alt_make ---
#!/bin/sh

function _alt_make() {

	srcnum="1"
	altmake=""

	while [ $# -gt 0 ]; do

		case "$1" in

			-s) shift ; srcnum="$1" ;;
			*) altmake="${altmake} $1" ;;

		esac

		shift

	done

	if [ "${altmake}" = "" ]; then

		pwtext "_alt_make: no command specified"
		exit 2

	fi

	echo -n " ${altmake} " >> ${tmp}/altmake_${srcnum}

}

--- NEW FILE: c_opt ---
#!/bin/sh

function _c_opt() {

	srcnum="1"
	opts=""

	while [ $# -gt 0 ]; do

		case "$1" in

			-s) shift ; srcnum="$1" ;;
			*) opts="${opts} $1" ;;

		esac

		shift

	done

	if [ "${opts}" = "" ]; then

		pwtext "_c_opt: no option specified"
		exit 2

	fi

	echo -n " ${opts} " >> ${tmp}/c_opts_${srcnum}

}

--- NEW FILE: chmod ---
#!/bin/sh

function _chmod() {

	recursive=""
	hasmode=""
	mode=""
	files=""

	while [ $# -gt 0 ]; do

		case "$1" in

			-R) recursive="-R" ;;
			*)

			    if [ ! "${hasmode}" = "y" ]; then

				    mode="$1"
				    hasmode="y"

			    else

				    if echo "$1" | grep "^${pkg}/" > /dev/null 2>&1; then

					    files="${files} $1"

				    else

					    files="${files} ./$1"

				    fi

			    fi ;;

		esac

		shift

	done

	if [ "${mode}" = "" ]; then

		pwtext "_chmod: mode not specified"
		exit 2

	fi

	if [ "${files}" = "" ]; then

		pwtext "_chmod: no files specified"
		exit 2

	fi

	echo "chmod ${recursive} ${mode} ${files}" >> ${scripts}/chmod

}

--- NEW FILE: chown ---
#!/bin/sh

function _chown() {

	recursive=""
	dereference=""
	hasown=""
	own=""
	files=""

	while [ $# -gt 0 ]; do

		case "$1" in

			-d) dereference="--dereference" ;;
			-R) recursive="-R" ;;
			*)

			    if [ ! "${hasown}" = "y" ]; then

				    own="$1"
				    hasown="y"

			    else

				    if echo "$1" | grep "^${pkg}/" > /dev/null 2>&1; then

					    files="${files} $1"

				    else

					    files="${files} ./$1"

				    fi

			    fi ;;

		esac

		shift

	done

	if [ "${own}" = "" ]; then

		pwtext "_chown: owning not specified"
		exit 2

	fi

	if [ "${files}" = "" ]; then

		pwtext "_chown: no files specified"
		exit 2

	fi

	echo "chown ${recursive} ${dereference} ${own} ${files}" >> ${scripts}/chown

}

--- NEW FILE: cmi ---
#!/bin/sh

function _cmi() {

	srcnum="1"
	undefine=""
	subdir=""

	while [ $# -gt 0 ]; do

		case "$1" in

			-s) shift ; srcnum="$1" ;;
			-u) undefine="-u" ;;
			-b) shift ; subdir="-b $1" ;;

		esac

		shift

	done

	_configure -s ${srcnum} ${subdir}
	_make -s ${srcnum} ${subdir}
	_install -s ${srcnum} ${subdir} ${undefine}

}

--- NEW FILE: config ---
#!/bin/sh

function _config() {

	if [ $# = 0 ]; then

		pwtext "_config: no option specified"
		exit 2

	fi

	while [ $# -gt 0 ]; do

		case "$1" in

			-s|--no-strip) echo "nostrip=yes" >> ${tmp}/config ;;
			*) pwtext "_config: invalid option - %s" $1 ; exit 2 ;;

		esac

		shift

	done

}

--- NEW FILE: configure ---
#!/bin/sh

function _configure() {

	srcnum="1"
	subdir=""
	opts=""

	while [ $# -gt 0 ]; do

		case "$1" in

			-s) shift ; srcnum="$1" ;;
			-b) shift ; subdir="$1" ;;
			*) opts="${opts} $1" ;;

		esac

		shift

	done

	if [ ! -f ${tmp}/altconfigure_${srcnum} ]; then

		echo -n "./configure" > ${tmp}/altconfigure_${srcnum}

	fi

	eval "srcd=\"\${src${srcnum}}\""

	(

		if [ ! "${inotherdir}" = "yes" ]; then

			cd ${srcd}/${subdir}

		fi

		touch ${tmp}/c_opts_${srcnum}

		if [ -f ${tmp}/nextconfigure_${srcnum} ]; then

			mv -f ${tmp}/nextconfigure_${srcnum} ${tmp}/actconfigure_${srcnum}

		else

			cp -f ${tmp}/altconfigure_${srcnum} ${tmp}/actconfigure_${srcnum}

		fi

		if [ "${pw_debug}" = "yes" ]; then

			echo "+ Configure #${srcnum} ("`cat ${tmp}/actconfigure_${srcnum}` `cat ${tmp}/c_opts_${srcnum}` ${opts}")"
			`cat ${tmp}/actconfigure_${srcnum}` `cat ${tmp}/c_opts_${srcnum}` ${opts}
			echo $? > ${tmp}/confres

		else

			echo "+ Configure #${srcnum}"
			`cat ${tmp}/actconfigure_${srcnum}` `cat ${tmp}/c_opts_${srcnum}` ${opts} > /dev/null
			echo $? > ${tmp}/confres

		fi

	)

	if [ ! `cat ${tmp}/confres` = 0 ]; then

		pwtext "! Error: configure failed"
		exit 3

	fi

}

--- NEW FILE: doc ---
#!/bin/sh

function _doc() {

	defnum=""
	defdoc=""
	srcnum="1"
	docs=""
	exdocs=""
	subdir=""
	altdir=""

	while [ $# -gt 0 ]; do

		case "$1" in

			-d) defdoc=yes ;;
			-b) shift ; subdir="$1" ;;
			-s) shift ; srcnum="$1" ;;
			-x) shift ; exdocs="${exdocs} $1" ;;
			-r) shift ; altdir="$1" ;;
			*) docs="${docs} $1" ;;

		esac

		shift

	done

	if [ "${defdoc}" = "yes" ]; then

		echo "copy_defdoc ${srcnum} x${altdir} ${subdir}" >> ${scripts}/doc

	fi

	if [ ! "${docs}" = "" ]; then

		echo "copy_doc ${srcnum} x${altdir} \"${subdir}\" ${docs}" >> ${scripts}/doc

	fi

	if [ ! "${exdocs}" = "" ]; then

		echo "exclude_doc ${srcnum} x${altdir} \"${subdir}\" ${exdocs}" >> ${scripts}/doc

	fi

}

--- NEW FILE: execindir ---
#!/bin/sh

function _execindir() {

    prevdir="`pwd`"

    if [ -f ${tmp}/setexecdir ]; then

	    cd "`cat ${tmp}/setexecdir`"

    else

	    cd "$1"
	    shift

    fi

    inotherdir=yes "$@"
    cd "${prevdir}"

}

--- NEW FILE: i_opt ---
#!/bin/sh

function _i_opt() {

	srcnum="1"
	opts=""

	while [ $# -gt 0 ]; do

		case "$1" in

			-s) shift ; srcnum="$1" ;;
			*) opts="${opts} $1" ;;

		esac

		shift

	done

	if [ "${opts}" = "" ]; then

		pwtext "_i_opt: no option specified"
		exit 2

	fi

	echo -n " ${opts} " >> ${tmp}/i_opts_${srcnum}

}

--- NEW FILE: install ---
#!/bin/sh

function _install() {

	srcnum="1"
	subdir=""
	undefine=""
	opts=""

	while [ $# -gt 0 ]; do

		case "$1" in

			-s) shift ; srcnum="$1" ;;
			-b) shift ; subdir="$1" ;;
			-u) undefine="yes" ;;
			*) opts="${opts} $1" ;;

		esac

		shift

	done

	if [ ! -f ${tmp}/altinstall_${srcnum} ]; then

		echo -n "make install" > ${tmp}/altinstall_${srcnum}

	fi

	eval "srcd=\"\${src${srcnum}}\""

	(

		if [ ! "${inotherdir}" = "yes" ]; then

			cd ${srcd}/${subdir}

		fi

		touch ${tmp}/i_opts_${srcnum}

		if [ -f ${tmp}/nextinstall_${srcnum} ]; then

			mv -f ${tmp}/nextinstall_${srcnum} ${tmp}/actinstall_${srcnum}

		else

			cp -f ${tmp}/altinstall_${srcnum} ${tmp}/actinstall_${srcnum}

		fi

		if [ ! "${undefine}" = "yes" ]; then

			destvars="DESTDIR=${pkg} INSTALLROOT=${pkg} INSTALL_ROOT=${pkg} PERL_INSTALL_ROOT=${pkg} INSTALL_PREFIX=${pkg}"

		fi

		if [ "${pw_debug}" = "yes" ]; then

			echo "+ Install #${srcnum} ("`cat ${tmp}/actinstall_${srcnum}` ${destvars} `cat ${tmp}/i_opts_${srcnum}` ${opts}")"
			`cat ${tmp}/actinstall_${srcnum}` ${destvars} `cat ${tmp}/i_opts_${srcnum}` ${opts}
			echo $? > ${tmp}/instres

		else

			echo "+ Install #${srcnum}"
			`cat ${tmp}/actinstall_${srcnum}` ${destvars} `cat ${tmp}/i_opts_${srcnum}` ${opts} > /dev/null
			echo $? > ${tmp}/instres

		fi

	)

	if [ ! `cat ${tmp}/instres` = 0 ]; then

		pwtext "! Error: make install failed"
		exit 3

	fi

}

--- NEW FILE: m_opt ---
#!/bin/sh

function _m_opt() {

	srcnum="1"
	opts=""

	while [ $# -gt 0 ]; do

		case "$1" in

			-s) shift ; srcnum="$1" ;;
			*) opts="${opts} $1" ;;

		esac

		shift

	done

	if [ "${opts}" = "" ]; then

		pwtext "_m_opt: no option specified"
		exit 2

	fi

	echo -n " ${opts} " >> ${tmp}/m_opts_${srcnum}

}

--- NEW FILE: make ---
#!/bin/sh

function _make() {

	srcnum="1"
	subdir=""
	opts=""

	while [ $# -gt 0 ]; do

		case "$1" in

			-s) shift ; srcnum="$1" ;;
			-b) shift ; subdir="$1" ;;
			*) opts="${opts} $1" ;;

		esac

		shift

	done

	if [ ! -f ${tmp}/altmake_${srcnum} ]; then

		echo -n "make" > ${tmp}/altmake_${srcnum}

	fi

	eval "srcd=\"\${src${srcnum}}\""

	(

		if [ ! "${inotherdir}" = "yes" ]; then

			cd ${srcd}/${subdir}

		fi

		touch ${tmp}/m_opts_${srcnum}

		if [ -f ${tmp}/nextmake_${srcnum} ]; then

			mv -f ${tmp}/nextmake_${srcnum} ${tmp}/actmake_${srcnum}

		else

			cp -f ${tmp}/altmake_${srcnum} ${tmp}/actmake_${srcnum}

		fi

		if [ "${pw_debug}" = "yes" ]; then

			echo "+ Make #${srcnum} ("`cat ${tmp}/actmake_${srcnum}` `cat ${tmp}/m_opts_${srcnum}` ${opts}")"
			`cat ${tmp}/actmake_${srcnum}` `cat ${tmp}/m_opts_${srcnum}` ${opts}
			echo $? > ${tmp}/makeres

		else

			echo "+ Make #${srcnum}"
			`cat ${tmp}/actmake_${srcnum}` `cat ${tmp}/m_opts_${srcnum}` ${opts} > /dev/null
			echo $? > ${tmp}/makeres

		fi

	)

	if [ ! `cat ${tmp}/makeres` = 0 ]; then

		pwtext "! Error: make failed"
		exit 3

	fi

}

--- NEW FILE: next_configure ---
#!/bin/sh

function _next_configure() {

	srcnum="1"
	nextconfigure=""

	while [ $# -gt 0 ]; do

		case "$1" in

			-s) shift ; srcnum="$1" ;;
			*) nextconfigure="${nextconfigure} $1" ;;

		esac

		shift

	done

	if [ "${nextconfigure}" = "" ]; then

		pwtext "_next_configure: no command specified"
		exit 2

	fi

	echo -n " ${nextconfigure} " >> ${tmp}/nextconfigure_${srcnum}

}

--- NEW FILE: next_install ---
#!/bin/sh

function _next_install() {

	srcnum="1"
	nextinstall=""

	while [ $# -gt 0 ]; do

		case "$1" in

			-s) shift ; srcnum="$1" ;;
			*) nextinstall="${nextinstall} $1" ;;

		esac

		shift

	done

	if [ "${nextinstall}" = "" ]; then

		pwtext "_next_install: no command specified"
		exit 2

	fi

	echo -n " ${nextinstall} " >> ${tmp}/nextinstall_${srcnum}

}

--- NEW FILE: next_make ---
#!/bin/sh

function _next_make() {

	srcnum="1"
	nextmake=""

	while [ $# -gt 0 ]; do

		case "$1" in

			-s) shift ; srcnum="$1" ;;
			*) nextmake="${nextmake} $1" ;;

		esac

		shift

	done

	if [ "${nextmake}" = "" ]; then

		pwtext "_next_make: no command specified"
		exit 2

	fi

	echo -n " ${nextmake} " >> ${tmp}/nextmake_${srcnum}

}

--- NEW FILE: patch ---
#!/bin/sh

function _patch() {

	level="1"
	patches=""
	srcnum="1"
	failig=""

	while [ $# -gt 0 ]; do

		case "$1" in

			-p) shift ; level="$1" ;;
			-s) shift ; srcnum="$1" ;;
			-i) failig="yes" ;;
			*) patches="${patches} $1" ;;

		esac

		shift

	done

	if [ "${patches}" = "" ]; then

		pwtext "_patch: no patch specified"
		exit 2

	fi

	eval "srcd=\"\${src${srcnum}}\""

	echo 0 > ${tmp}/patch-exit

	(

	cd ${srcd}

	for i in ${patches}; do

		pfile=""

		pwtext "+ Patch %s" ${i}

		if echo "${i}" | grep "^/" > /dev/null 2>&1; then

			if [ -f "${i}" ]; then

				pfile="${i}"

			else

				pwtext "! Error: file not found"
				echo 3 > ${tmp}/patch-exit
				exit 3

			fi

		else

			for j in ${i} ${i}.bz2 ${i}.gz \
				    ${name}-${i}.pw.patch \
				    ${name}-${i}.pw.patch.bz2 \
				    ${name}-${i}.pw.patch.gz \
				    ${name}-${i}.pw.diff \
				    ${name}-${i}.pw.diff.bz2 \
				    ${name}-${i}.pw.diff.gz \
				    ${name}-${i}.patch \
				    ${name}-${i}.patch.bz2 \
				    ${name}-${i}.patch.gz \
				    ${name}-${i}.diff \
				    ${name}-${i}.diff.bz2 \
				    ${name}-${i}.diff.gz \
				    ${i}.pw.patch \
				    ${i}.pw.patch.bz2 \
				    ${i}.pw.patch.gz \
				    ${i}.pw.diff \
				    ${i}.pw.diff.bz2 \
				    ${i}.pw.diff.gz \
				    ${i}.patch \
				    ${i}.patch.bz2 \
				    ${i}.patch.gz \
				    ${i}.diff \
				    ${i}.diff.bz2 \
				    ${i}.diff.gz ; do

				if [ -f "${src}"/${j} ]; then

					pfile="${src}"/${j}
					break

				fi

			done

		fi

		if [ "${pfile}" = "" ]; then

			pwtext "! Error: no matching file"
			echo 3 > ${tmp}/patch-exit
			exit 3

		fi

		if echo "${pfile}" | grep "[.]bz2$" > /dev/null 2>&1; then

			xcat="bzcat"

		elif echo "${pfile}" | grep "[.]gz$" > /dev/null 2>&1; then

			xcat="zcat"

		else

			xcat="cat"

		fi

		${xcat} "${pfile}" | patch -p${level} > /dev/null 2>&1

		if [ ! $? = 0 ]; then

			pwtext "! Error: applying failed"
			echo 3 > ${tmp}/patch-exit
			exit 3

		fi

	done

	)

	if [ ! "${failig}" = "yes" ]; then

		if [ ! `cat ${tmp}/patch-exit` = 0 ]; then

			exit `cat ${tmp}/patch-exit`

		fi

	fi

	return `cat ${tmp}/patch-exit`

}

--- NEW FILE: pwbuilder ---
#!/bin/sh

function _pwbuilder_make_version() {

	ver_1=`echo $1 | cut -d '.' -f 1`
	ver_2=`echo $1 | cut -d '.' -f 2`
	ver_3=`echo $1 | cut -d '.' -f 3`

	echo `expr ${ver_1} \* 65536 + ${ver_2} \* 256 + ${ver_3} \* 1`

}

function _pwbuilder() {

	if [ "$1" = "" ]; then

		pwtext "_pwbuilder: missing argument"
		exit 2

	fi

	if ! echo "$1" | egrep '^[0-9]+[.][0-9]+[.][0-9]+$' > /dev/null 2>&1; then

		pwtext "_pwbuilder: invalid version"
		exit 2

	fi

	required_version=`_pwbuilder_make_version $1`
	current_version=`_pwbuilder_make_version ${pwbuilder_version}`

	if [ "${required_version}" -gt "${current_version}" ]; then

		pwtext "! Error: your pwbuilder %s is too old (at least %s needed)" ${pwbuilder_version} $1
		exit 3

	fi

}

--- NEW FILE: py_b_opt ---
#!/bin/sh

function _py_b_opt() {

	srcnum="1"
	opts=""

	while [ $# -gt 0 ]; do

		case "$1" in

			-s) shift ; srcnum="$1" ;;
			*) opts="${opts} $1" ;;

		esac

		shift

	done

	if [ "${opts}" = "" ]; then

		pwtext "_py_b_opt: no option specified"
		exit 2

	fi

	echo -n " ${opts} " >> ${tmp}/py_b_opts_${srcnum}

}

--- NEW FILE: py_build ---
#!/bin/sh

function _py_build() {

	srcnum="1"
	subdir=""
	opts=""

	while [ $# -gt 0 ]; do

		case "$1" in

			-s) shift ; srcnum="$1" ;;
			-b) shift ; subdir="$1" ;;
			*) opts="${opts} $1" ;;

		esac

		shift

	done

	eval "srcd=\"\${src${srcnum}}\""

	(

		if [ ! "${inotherdir}" = "yes" ]; then

			cd ${srcd}/${subdir}

		fi

		touch ${tmp}/py_b_opts_${srcnum}

		if [ "${pw_debug}" = "yes" ]; then

			echo "+ Python build #${srcnum} (python setup.py build "`cat ${tmp}/py_b_opts_${srcnum}` ${opts}")"
			python setup.py build `cat ${tmp}/py_b_opts_${srcnum}` ${opts}
			echo $? > ${tmp}/pybures

		else

			echo "+ Python build #${srcnum}"
			python setup.py build `cat ${tmp}/py_b_opts_${srcnum}` ${opts} > /dev/null
			echo $? > ${tmp}/pybures

		fi

	)

	if [ ! `cat ${tmp}/pybures` = 0 ]; then

		pwtext "! Error: python build failed"
		exit 3

	fi

}

--- NEW FILE: py_i_opt ---
#!/bin/sh

function _py_i_opt() {

	srcnum="1"
	opts=""

	while [ $# -gt 0 ]; do

		case "$1" in

			-s) shift ; srcnum="$1" ;;
			*) opts="${opts} $1" ;;

		esac

		shift

	done

	if [ "${opts}" = "" ]; then

		pwtext "_py_i_opt: no option specified"
		exit 2

	fi

	echo -n " ${opts} " >> ${tmp}/py_i_opts_${srcnum}

}

--- NEW FILE: py_install ---
#!/bin/sh

function _py_install() {

	srcnum="1"
	subdir=""
	undefine=""
	opts=""

	while [ $# -gt 0 ]; do

		case "$1" in

			-s) shift ; srcnum="$1" ;;
			-b) shift ; subdir="$1" ;;
			-u) undefine="yes" ;;
			*) opts="${opts} $1" ;;

		esac

		shift

	done

	eval "srcd=\"\${src${srcnum}}\""

	(

		if [ ! "${inotherdir}" = "yes" ]; then

			cd ${srcd}/${subdir}

		fi

		touch ${tmp}/py_i_opts_${srcnum}

		if [ ! "${undefine}" = "yes" ]; then

			destvars="--root=${pkg}"

		fi

		if [ "${pw_debug}" = "yes" ]; then

			echo "+ Python install #${srcnum} (python setup.py install "${destvars} `cat ${tmp}/py_i_opts_${srcnum}` ${opts}")"
			python setup.py install ${destvars} `cat ${tmp}/py_i_opts_${srcnum}` ${opts}
			echo $? > ${tmp}/pyinres

		else

			echo "+ Python install #${srcnum}"
			python setup.py install ${destvars} `cat ${tmp}/py_i_opts_${srcnum}` ${opts} > /dev/null
			echo $? > ${tmp}/pyinres

		fi

	)

	if [ ! `cat ${tmp}/pyinres` = 0 ]; then

		pwtext "! Error: python install failed"
		exit 3

	fi

}

--- NEW FILE: qconf_fix ---
#!/bin/sh

function _qconf_fix()
{
    mf=`basename $1`
    sed 's}(INSTALL_ROOT)\(../\)*}(INSTALL_ROOT)}g' $1 > ${tmp}/${mf}.qconf-fix
    cat ${tmp}/${mf}.qconf-fix > $1
    rm -f ${tmp}/${mf}.qconf-fix
}

--- NEW FILE: remove ---
#!/bin/sh

function _remove() {

	if [ "$1" = "" ]; then

		pwtext "_remove: no file or directory supplied"
		exit 2

	fi

	echo "$@" >> ${tmp}/toremove

}

--- NEW FILE: require ---
#!/bin/sh

function _require() {

	cond=""
	pver=""
	subp=""
	pname=""

	while [ $# -gt 0 ]; do

		case "$1" in

			-eq) cond="=" ; shift ; pver="$1" ;;
			-lt) cond="<" ; shift ; pver="$1" ;;
			-gt) cond=">" ; shift ; pver="$1" ;;
			-le) cond="<=" ; shift ; pver="$1" ;;
			-ge) cond=">=" ; shift ; pver="$1" ;;
			-p) shift ; subp="$1" ;;
			*) pname="$1" ;;

		esac

		shift

	done

	if [ "${pname}" = "" ]; then

		pwtext "_require: no package specified"
		exit 2

	fi

	if [ ! "${cond}" = "" -a "${pver}" = "" ]; then

		pwtext "_require: condition used but no version specified"
		exit 2

	fi

	if [ "${subp}" = "" ]; then

		subp="${name}"

	fi

	pver1=`echo ${pver}- | cut -d - -f 1`
	pver2=`echo ${pver}- | cut -d - -f 2`
	pver3=`echo ${pver}- | cut -d - -f 3`

	if [ ! "${pver3}" = "" ]; then

		pvers="${pver}"

	elif [ "${pver2}" = "" ]; then

		pvers="${pver1}-i386-1"

	else

		pvers="${pver1}-i386-${pver2}"

	fi

	if [ "${cond}" = "" ]; then

		echo "${pname}" > ${tmp}/req-${subp}

	else

		echo "${pname} ${cond} ${pvers}" > ${tmp}/req-${subp}

	fi

}

--- NEW FILE: set ---
#!/bin/sh

function _set() {

	if [ "$2" = "" ]; then

		pwtext "_set: not enough parameters."
		exit 2

	fi

	echo "$2" > ${var}/$1

}

--- NEW FILE: setexecdir ---
#!/bin/sh

function _setexecdir() {

	if [ "$1" = "" ]; then

		pwtext "_setexecdir: no directory supplied"
		exit 2

	fi

	echo "$1" > ${tmp}/setexecdir

}

--- NEW FILE: source ---
#!/bin/sh

function _source() {

	sf=""
	project=""
	topdir=""
	compext="tar.bz2"
	leavepacked=""
	md5=""
	fname=""
	fver=""
	url=""
	remote=""
	fok=""
	xtop=""
	singf=""
	size=""
	sep="-"
	passftp=""
	failig=""

	while [ $# -gt 0 ]; do

		case "$1" in

			-f) sf=yes ;;
			-p) shift ; project="$1" ;;
			-t) shift ; topdir="$1" ;;
			-g) compext=tar.gz ;;
			-z) compext=tgz ;;
			-Z) compext=zip ;;
			-u) leavepacked=yes ;;
			-i) failig=yes ;;
			-m) shift ; md5="$1" ;;
			-n) shift ; fname="$1" ;;
			-v) shift ; fver="$1" ;;
			-s) shift ; size="$1" ;;
			-c) sep=_ ;;
			*) url="$1" ;;

		esac

		shift

	done

	if [ "${fname}" = "" ]; then

		fname="${name}"

	fi

	if [ "${fver}" = "" ]; then

		fver="${version}"

	fi

	if [ "${url}" = "" ]; then

		url="/"

	fi

	if [ "${passiveftp}" = "yes" ]; then

		passftp="--passive-ftp"

	fi

	autourl="${fname}${sep}${fver}.${compext}"

	if [ "${sf}" = "yes" ]; then

		if [ "${project}" = "" ]; then

			project="${name}"

		fi

		url="http://${sfmirror}.dl.sourceforge.net/sourceforge/${project}/${autourl}"

	elif echo "${url}" | grep "/$" > /dev/null 2>&1; then

		url="${url}${autourl}"

	fi

	ffile="`basename \"${url}\"`"

	pwtext -n "+ Source %s" ${ffile}

	if [ "${size}" = "" ]; then

		echo

	else

		echo " (`expr ${size} / 1024` kB)"

	fi

	if echo "${url}" | egrep "^http://|^ftp://" > /dev/null 2>&1; then

		remote=yes

	fi

	try=0

	while [ "${try}" -lt 3 ]; do

		if [ -f "${srcspool}"/"${ffile}" ]; then

			fok=yes

		elif [ "${remote}" = "yes" ]; then

			wget -t 3 -c -P "${srcspool}" ${passftp} "${url}" > /dev/null 2>&1

			if [ $? = 0 ]; then

				fok=yes

			fi

		fi

		if [ "${fok}" = "yes" -a ! "${md5}" = "" ]; then

			fmd5=`md5sum "${srcspool}"/"${ffile}" | cut -d ' ' -f 1`

			if [ ! "${fmd5}" = "${md5}" ]; then

				fok=no
				rm -f "${srcspool}"/"${ffile}"

			fi

		fi

		if [ "${fok}" = "yes" ]; then

			break

		fi

		try=`expr ${try} + 1`

	done

	if [ ! "${fok}" = "yes" ]; then

		pwtext "! Error: none valid found"

		if [ ! "${failig}" = "yes" ]; then

			exit 4

		else

			return 4

		fi

	fi

	srccnt=`expr ${srccnt} + 1`

	if [ "${leavepacked}" = "yes" ]; then

		eval "src${srccnt}=\"${srcspool}\"/\"${ffile}\""
		echo "src${srccnt}=\"${srcspool}\"/\"${ffile}\"" >> ${scripts}/save
		eval "srcx=\"${srcspool}\"/\"${ffile}\""
		return

	fi

	srcnum="${RANDOM}${RANDOM}${RANDOM}"
	mkdir -p ${xsrcdir}/${srcnum}

	( cd ${xsrcdir}/${srcnum}

	case "${ffile}" in

		*.tar.bz2) tar jxf "${srcspool}/${ffile}" > /dev/null 2>&1 ; echo $? > ${tmp}/extres ;;
		*.tar.gz) tar zxf "${srcspool}/${ffile}" > /dev/null 2>&1 ; echo $? > ${tmp}/extres ;;
		*.tgz) tar zxf "${srcspool}/${ffile}" > /dev/null 2>&1 ; echo $? > ${tmp}/extres ;;
		*.tar.Z) tar zxf "${srcspool}/${ffile}" > /dev/null 2>&1 ; echo $? > ${tmp}/extres ;;
		*.zip) unzip "${srcspool}/${ffile}" > /dev/null 2>&1 ; echo $? > ${tmp}/extres ;;
		*.bz2) bzcat "${srcspool}/${ffile}" 1> "`basename ${ffile} .bz2`" 2> /dev/null ; echo $? > ${tmp}/extres ;;
		*.gz) zcat "${srcspool}/${ffile}" 1> "`basename ${ffile} .gz`" 2> /dev/null ; echo $? > ${tmp}/extres ;;
		*) pwtext "_source: unsupported format" ; echo "unsupported" > ${tmp}/extres ;;

	esac )

	if [ ! `cat ${tmp}/extres` = 0 ]; then

		pwtext "! Error: extracting failed"
		exit 3

	elif [ "`cat ${tmp}/extres`" = "unsupported" ]; then

		exit 4

	fi

	case "${ffile}" in

		*.tar.bz2) xtop="`basename \"${ffile}\" .tar.bz2`" ;;
		*.tar.gz) xtop="`basename \"${ffile}\" .tar.gz`" ;;
		*.tgz) xtop="`basename \"${ffile}\" .tgz`" ;;
		*.tar.Z) xtop="`basename \"${ffile}\" .tar.Z`" ;;
		*.zip) xtop="`basename \"${ffile}\" .zip`" ;;
		*.bz2) singf="`basename \"${ffile}\" .bz2`" ;;
		*.gz) singf="`basename \"${ffile}\" .gz`" ;;

	esac

	if [ "${topdir}" = "" -a ! "${xtop}" = "" ]; then

		topdir="${xtop}"

	fi

	if [ ! -d ${xsrcdir}/${srcnum}/"${topdir}" ]; then

		topdir=""

	fi

	if [ ! "${singf}" = "" ]; then

		topdir="${singf}"

	fi

	eval "src${srccnt}=${xsrcdir}/${srcnum}/\"${topdir}\""
	echo "src${srccnt}=${xsrcdir}/${srcnum}/\"${topdir}\"" >> ${scripts}/save
	eval "srcx=${xsrcdir}/${srcnum}/\"${topdir}\""

}

--- NEW FILE: sub ---
#!/bin/sh

function _sub() {

	buildnum=""
	subname=""

	while [ $# -gt 0 ]; do

		case "$1" in

			-b) shift ; buildnum="$1" ;;
			*) subname="$1" ;;

		esac

		shift

	done

	if [ "${subname}" = "" ]; then

		pwtext "_sub: subpackage name not supplied"
		exit 2

	fi

	echo "${subname}=${buildnum}" >> ${tmp}/sub

}

--- NEW FILE: unsetexecdir ---
#!/bin/sh

function _unsetexecdir() {

	rm -f ${tmp}/setexecdir

}



From nobody at sheep.berlios.de  Fri Jul 30 00:12:53 2004
From: nobody at sheep.berlios.de (swiergot)
Date: Fri, 30 Jul 2004 00:12:53 +0200
Subject: [Packware-cvs] pwbuild - New directory
Message-ID: <200407292212.i6TMCr622063@bat.berlios.de>

Update of /cvsroot/packware/pwbuild
In directory sheep:/tmp/cvs-serv1753/pwbuild

Log Message:
Directory /cvsroot/packware/pwbuild added to the repository




From nobody at sheep.berlios.de  Fri Jul 30 15:05:47 2004
From: nobody at sheep.berlios.de (swiergot)
Date: Fri, 30 Jul 2004 15:05:47 +0200
Subject: [Packware-cvs] pwbuilder fakeroot-libdir.pw.patch,1.1,1.2 pwbuilder.pwbuild,1.1,1.2
Message-ID: <200407301305.i6UD5l610795@bat.berlios.de>

Update of /cvsroot/packware/pwbuilder
In directory sheep:/tmp/cvs-serv8853

Modified Files:
	fakeroot-libdir.pw.patch pwbuilder.pwbuild 
Log Message:
- Upgraded to fakeroot 1.0.5.
- Changed source URLs.


Index: fakeroot-libdir.pw.patch
===================================================================
RCS file: /cvsroot/packware/pwbuilder/fakeroot-libdir.pw.patch,v
retrieving revision 1.1
retrieving revision 1.2
diff -C2 -d -r1.1 -r1.2
*** fakeroot-libdir.pw.patch	29 Jul 2004 22:06:47 -0000	1.1
--- fakeroot-libdir.pw.patch	30 Jul 2004 13:05:44 -0000	1.2
***************
*** 1,12 ****
! diff -ruN fakeroot-0.7.3.orig/scripts/fakeroot fakeroot-0.7.3/scripts/fakeroot
! --- fakeroot-0.7.3.orig/scripts/fakeroot	2003-05-10 02:04:30.000000000 +0200
! +++ fakeroot-0.7.3/scripts/fakeroot	2003-07-07 14:42:53.000000000 +0200
! @@ -16,7 +16,7 @@
!  PREFIX=`dirname ${BINDIR}`
       
!  LIB=libfakeroot.so.0
  -PATHS=${PREFIX}/lib/libfakeroot:${PREFIX}/lib64/libfakeroot
  +PATHS=${PREFIX}/lib:${PREFIX}/lib/libfakeroot:${PREFIX}/lib64/libfakeroot
!  FAKED=${BINDIR}/faked
   
   FAKED_MODE="unknown-is-root"
--- 1,12 ----
! diff -ruN fakeroot-1.0.5.orig/scripts/fakeroot.in fakeroot-1.0.5/scripts/fakeroot.in
! --- fakeroot-1.0.5.orig/scripts/fakeroot.in	2004-06-19 03:23:10.000000000 +0200
! +++ fakeroot-1.0.5/scripts/fakeroot.in	2004-07-30 10:38:55.000000000 +0200
! @@ -19,7 +19,7 @@
!  BINDIR=@bindir@
       
!  LIB=lib at fakeroot_transformed@.so.0
  -PATHS=${PREFIX}/lib/libfakeroot:${PREFIX}/lib64/libfakeroot
  +PATHS=${PREFIX}/lib:${PREFIX}/lib/libfakeroot:${PREFIX}/lib64/libfakeroot
!  FAKED=${BINDIR}/@faked_transformed@
   
   FAKED_MODE="unknown-is-root"

Index: pwbuilder.pwbuild
===================================================================
RCS file: /cvsroot/packware/pwbuilder/pwbuilder.pwbuild,v
retrieving revision 1.1
retrieving revision 1.2
diff -C2 -d -r1.1 -r1.2
*** pwbuilder.pwbuild	29 Jul 2004 22:06:47 -0000	1.1
--- pwbuilder.pwbuild	30 Jul 2004 13:05:44 -0000	1.2
***************
*** 2,17 ****
  
  name="pwbuilder"
! version="0.6.4-pre3"
  build="1"
  
! fakeroot="0.7.8"
  pwutils="0.6"
  
  _pwbuilder 0.6.3
  
! _doc -d -r fakeroot-${fakeroot} README.fake
  
! _source -t fakeroot-${fakeroot} -m d9612083d722f49091f54217ce90f9a5 -s 678306 http://packware.intersec.pl/source/fakeroot_${fakeroot}.tar.gz
! _source -n pwutils -v ${pwutils} -m 48d32d94b45774967357c94b7fbb2cb3 -s 3440 http://packware.intersec.pl/
  
  _patch fakeroot-libdir
--- 2,17 ----
  
  name="pwbuilder"
! version="0.6.4-pre4"
  build="1"
  
! fakeroot="1.0.5"
  pwutils="0.6"
  
  _pwbuilder 0.6.3
  
! _doc -d -r fakeroot-${fakeroot} README.fake doc/README.saving -x NEWS -x README
  
! _source -t fakeroot-${fakeroot} -m 2c779a33b10447a9f0371ce9105a3467 -s 1192122 ftp://ftp.berlios.de/pub/packware/sources/fakeroot_${fakeroot}.tar.gz
! _source -n pwutils -v ${pwutils} -m 48d32d94b45774967357c94b7fbb2cb3 -s 3440 ftp://ftp.berlios.de/pub/packware/sources/
  
  _patch fakeroot-libdir



From nobody at sheep.berlios.de  Fri Jul 30 15:05:47 2004
From: nobody at sheep.berlios.de (swiergot)
Date: Fri, 30 Jul 2004 15:05:47 +0200
Subject: [Packware-cvs] pwbuilder/doc ChangeLog,1.1,1.2
Message-ID: <200407301305.i6UD5l610799@bat.berlios.de>

Update of /cvsroot/packware/pwbuilder/doc
In directory sheep:/tmp/cvs-serv8853/doc

Modified Files:
	ChangeLog 
Log Message:
- Upgraded to fakeroot 1.0.5.
- Changed source URLs.


Index: ChangeLog
===================================================================
RCS file: /cvsroot/packware/pwbuilder/doc/ChangeLog,v
retrieving revision 1.1
retrieving revision 1.2
diff -C2 -d -r1.1 -r1.2
*** ChangeLog	29 Jul 2004 22:06:50 -0000	1.1
--- ChangeLog	30 Jul 2004 13:05:45 -0000	1.2
***************
*** 11,14 ****
--- 11,15 ----
  - Added _qconf_fix that fixes a problem with Makefiles generated by qconf with
    ../ bug.
+ - Upgraded fakeroot to 1.0.5.
  
  pwbuilder 0.6.3 - 30-Dec-2003



From nobody at sheep.berlios.de  Fri Jul 30 15:19:44 2004
From: nobody at sheep.berlios.de (swiergot)
Date: Fri, 30 Jul 2004 15:19:44 +0200
Subject: [Packware-cvs] pwbuild/d - New directory
Message-ID: <200407301319.i6UDJi611159@bat.berlios.de>

Update of /cvsroot/packware/pwbuild/d
In directory sheep:/tmp/cvs-serv10514/d

Log Message:
Directory /cvsroot/packware/pwbuild/d added to the repository




From nobody at sheep.berlios.de  Fri Jul 30 15:20:47 2004
From: nobody at sheep.berlios.de (swiergot)
Date: Fri, 30 Jul 2004 15:20:47 +0200
Subject: [Packware-cvs] pwbuild/d/j2re-blackdown j2re-blackdown.csh,NONE,1.1 j2re-blackdown.pwbuild,NONE,1.1 j2re-blackdown.pwinfo,NONE,1.1 j2re-blackdown.sh,NONE,1.1
Message-ID: <200407301320.i6UDKl611199@bat.berlios.de>

Update of /cvsroot/packware/pwbuild/d/j2re-blackdown
In directory sheep:/tmp/cvs-serv10614

Added Files:
	j2re-blackdown.csh j2re-blackdown.pwbuild 
	j2re-blackdown.pwinfo j2re-blackdown.sh 
Log Message:
- Initial commit.
- Version 1.4.2-rc1.


--- NEW FILE: j2re-blackdown.csh ---
#!/bin/csh
setenv JAVA_HOME /usr/lib/j2re-blackdown
setenv MANPATH ${MANPATH}:/usr/lib/j2re-blackdown/man
setenv PATH ${PATH}:/usr/lib/j2re-blackdown/bin

--- NEW FILE: j2re-blackdown.pwbuild ---
#!/bin/sh

name="j2re-blackdown"
version="1.4.2-rc1"
build="1"

_pwbuilder 0.6.3

_source -m 50c0faa2d536b09a48eb0584df84e32a -s 13315794 -u ftp://ftp.tux.org/java/JDK-`echo ${version} | cut -d '-' -f 1`/i386/`echo ${version} | cut -d '-' -f 2`/j2re-${version}-linux-i586-gcc3.2.bin

mkdir ${pkg}/usr/lib ${pkg}/etc/profile.d
cd ${pkg}/usr/lib
function more() { echo; }; export -f more
agreed=1 \
sh ${src1} -x
unset -f more
ln -s j2re`echo ${version} | cut -f 1 -d -` ${pkg}/usr/lib/${name}
cp ${src}/${name}.sh ${src}/${name}.csh ${pkg}/etc/profile.d
chmod 755 ${pkg}/etc/profile.d/*

# $Log: j2re-blackdown.pwbuild,v $
# Revision 1.1  2004/07/30 13:20:44  swiergot
# - Initial commit.
# - Version 1.4.2-rc1.
#

--- NEW FILE: j2re-blackdown.pwinfo ---
info="Java 2 SE for Linux."
desc="The Java 2 Standard Edition (J2SE) is a feature-complete development and deployment platform. Blackdown provides both a SDK (J2SDK, formerly known as JDK) and a runtime environment (J2RE) for Linux on various architectures (ix86, Sparc, PPC, S/390, ARM, m68k). Both the J2SDK and the J2RE contain the Java Plug-In for Netscape 4.x and Mozilla/Netscape 6.x."

--- NEW FILE: j2re-blackdown.sh ---
#!/bin/sh
export JAVA_HOME=/usr/lib/j2re-blackdown
export MANPATH="$MANPATH:/usr/lib/j2re-blackdown/man"
export PATH="$PATH:/usr/lib/j2re-blackdown/bin"



From nobody at sheep.berlios.de  Fri Jul 30 15:20:00 2004
From: nobody at sheep.berlios.de (swiergot)
Date: Fri, 30 Jul 2004 15:20:00 +0200
Subject: [Packware-cvs] pwbuild/d/j2re-blackdown - New directory
Message-ID: <200407301320.i6UDK0611169@bat.berlios.de>

Update of /cvsroot/packware/pwbuild/d/j2re-blackdown
In directory sheep:/tmp/cvs-serv10545/j2re-blackdown

Log Message:
Directory /cvsroot/packware/pwbuild/d/j2re-blackdown added to the repository




From nobody at sheep.berlios.de  Fri Jul 30 15:44:17 2004
From: nobody at sheep.berlios.de (swiergot)
Date: Fri, 30 Jul 2004 15:44:17 +0200
Subject: [Packware-cvs] pwbuild/d/java3d-re-blackdown - New directory
Message-ID: <200407301344.i6UDiH612241@bat.berlios.de>

Update of /cvsroot/packware/pwbuild/d/java3d-re-blackdown
In directory sheep:/tmp/cvs-serv12880/java3d-re-blackdown

Log Message:
Directory /cvsroot/packware/pwbuild/d/java3d-re-blackdown added to the repository




From nobody at sheep.berlios.de  Fri Jul 30 15:44:56 2004
From: nobody at sheep.berlios.de (swiergot)
Date: Fri, 30 Jul 2004 15:44:56 +0200
Subject: [Packware-cvs] pwbuild/d/java3d-re-blackdown java3d-re-blackdown.pwbuild,NONE,1.1 java3d-re-blackdown.pwinfo,NONE,1.1
Message-ID: <200407301344.i6UDiu612245@bat.berlios.de>

Update of /cvsroot/packware/pwbuild/d/java3d-re-blackdown
In directory sheep:/tmp/cvs-serv12951

Added Files:
	java3d-re-blackdown.pwbuild java3d-re-blackdown.pwinfo 
Log Message:
- Initial commit.
- Version 1.3.1.


--- NEW FILE: java3d-re-blackdown.pwbuild ---
#!/bin/sh

name="java3d-re-blackdown"
version="1.3.1"
build="1"

_pwbuilder 0.6.3

_source -m c79557ec7da5fa7dac742c35fd721350 -s 2824660 -u ftp://ftp.tux.org/pub/java/java3d/${version}/i386/fcs/java3d-re-${version}-linux-i386.bin

mkdir ${pkg}/usr/lib/j2re-blackdown
cd ${pkg}/usr/lib/j2re-blackdown
function more() { echo; }; export -f more
agreed=1 \
sh ${src1} -x
unset -f more

# $Log: java3d-re-blackdown.pwbuild,v $
# Revision 1.1  2004/07/30 13:44:54  swiergot
# - Initial commit.
# - Version 1.3.1.
#
# Revision 1.1  2004/07/30 13:20:44  swiergot
# - Initial commit.
# - Version 1.4.2-rc1.
#

--- NEW FILE: java3d-re-blackdown.pwinfo ---
info="Java 2 SE for Linux."
desc="The Java 2 Standard Edition (J2SE) is a feature-complete development and deployment platform. Blackdown provides both a SDK (J2SDK, formerly known as JDK) and a runtime environment (J2RE) for Linux on various architectures (ix86, Sparc, PPC, S/390, ARM, m68k). Both the J2SDK and the J2RE contain the Java Plug-In for Netscape 4.x and Mozilla/Netscape 6.x."



From nobody at sheep.berlios.de  Fri Jul 30 18:45:19 2004
From: nobody at sheep.berlios.de (swiergot)
Date: Fri, 30 Jul 2004 18:45:19 +0200
Subject: [Packware-cvs] pwbuild/n - New directory
Message-ID: <200407301645.i6UGjJ617982@bat.berlios.de>

Update of /cvsroot/packware/pwbuild/n
In directory sheep:/tmp/cvs-serv23820/n

Log Message:
Directory /cvsroot/packware/pwbuild/n added to the repository




From nobody at sheep.berlios.de  Fri Jul 30 18:45:34 2004
From: nobody at sheep.berlios.de (swiergot)
Date: Fri, 30 Jul 2004 18:45:34 +0200
Subject: [Packware-cvs] pwbuild/n/ekg - New directory
Message-ID: <200407301645.i6UGjY617988@bat.berlios.de>

Update of /cvsroot/packware/pwbuild/n/ekg
In directory sheep:/tmp/cvs-serv23845/ekg

Log Message:
Directory /cvsroot/packware/pwbuild/n/ekg added to the repository




From nobody at sheep.berlios.de  Fri Jul 30 18:46:12 2004
From: nobody at sheep.berlios.de (swiergot)
Date: Fri, 30 Jul 2004 18:46:12 +0200
Subject: [Packware-cvs] pwbuild/n/ekg ekg-cvs.pwbuild,NONE,1.1 ekg-varstxt.pw.patch,NONE,1.1 ekg.pwbuild,NONE,1.1 ekg.pwinfo,NONE,1.1 libgadu.pwinfo,NONE,1.1 libgadu.pwsub,NONE,1.1
Message-ID: <200407301646.i6UGkC618038@bat.berlios.de>

Update of /cvsroot/packware/pwbuild/n/ekg
In directory sheep:/tmp/cvs-serv23891

Added Files:
	ekg-cvs.pwbuild ekg-varstxt.pw.patch ekg.pwbuild ekg.pwinfo 
	libgadu.pwinfo libgadu.pwsub 
Log Message:
- Initial commit.
- Version 20040729.


--- NEW FILE: ekg-cvs.pwbuild ---
#!/bin/sh

name="ekg"
version="20040729"
build="1"

_pwbuilder 0.6.3

_doc -d -b docs ../ChangeLog IDEAS-2.0 *.txt protocol.html emoticons.* api/functions.txt -x CVS

_source -m bfe59b48b11880f26df245cf442740d1 -s 483721 -g http://dev.null.pl/${name}/

_patch varstxt

_c_opt --prefix=/usr
_c_opt --mandir=/usr/man
_c_opt --enable-shared
_c_opt --enable-dynamic
_c_opt --with-pthread
_have_python && _c_opt --with-python

_cmi

rm ${pkg}/usr/share/ekg/vars.txt

cp ${src1}/contrib/ekl2.sh ${pkg}/usr/bin/ekl2
cp ${src1}/docs/ekl2.man.en ${pkg}/usr/man/man1/ekl2.1
cp ${src1}/docs/ekl2.man.pl ${pkg}/usr/man/pl/man1/ekl2.1

_sub libgadu

# $Log: ekg-cvs.pwbuild,v $
# Revision 1.1  2004/07/30 16:46:09  swiergot
# - Initial commit.
# - Version 20040729.
#

--- NEW FILE: ekg-varstxt.pw.patch ---
diff -ruN ekg-20030709.orig/src/vars.c ekg-20030709/src/vars.c
--- ekg-20030709.orig/src/vars.c	2003-05-30 17:44:05.000000000 +0200
+++ ekg-20030709/src/vars.c	2003-07-10 13:43:14.000000000 +0200
@@ -38,6 +38,7 @@
 #include "stuff.h"
 #include "themes.h"
 #include "ui.h"
+#include "version.h"
 #include "vars.h"
 #include "xmalloc.h"
 
@@ -716,7 +717,7 @@
  */
 void variable_help(const char *name)
 {
-	FILE *f = fopen(DATADIR "/vars.txt", "r");
+	FILE *f = fopen("/usr/doc/ekg-" VERSION "/vars.txt", "r");
 	char *line, *type = NULL, *def = NULL, *tmp;
 	string_t s = string_init(NULL);
 	int found = 0;

--- NEW FILE: ekg.pwbuild ---
#!/bin/sh

name="ekg"
version="1.4"
build="1"

_pwbuilder 0.6.3

_doc -d -b docs ../ChangeLog IDEAS-2.0 *.txt protocol.html emoticons.* api/functions.txt -x CVS

_source -m 8f35030c05e62c30ce9068e26bd365a2 -s 465347 -g http://dev.null.pl/${name}/

_patch varstxt

_c_opt --prefix=/usr
_c_opt --mandir=/usr/man
_c_opt --enable-shared
_c_opt --enable-dynamic
_c_opt --with-pthread
_have_python && _c_opt --with-python

_cmi

rm ${pkg}/usr/share/ekg/vars.txt

cp ${src1}/contrib/ekl2.sh ${pkg}/usr/bin/ekl2
cp ${src1}/docs/ekl2.man.en ${pkg}/usr/man/man1/ekl2.1
cp ${src1}/docs/ekl2.man.pl ${pkg}/usr/man/pl/man1/ekl2.1

_sub libgadu

# $Log: ekg.pwbuild,v $
# Revision 1.1  2004/07/30 16:46:09  swiergot
# - Initial commit.
# - Version 20040729.
#
# Revision 1.22  2004/05/12 16:22:43  swiergot
# - Fixed md5 and size (?!).
#
# Revision 1.21  2004/01/13 15:18:11  swiergot
# - Version 20040112.
#
# Revision 1.20  2003/11/18 16:19:11  swiergot
# - Version 1.4.
#
# Revision 1.19  2003/10/10 19:48:37  swiergot
# - Adapted to pwbuilder 0.6.2.
#
# Revision 1.18  2003/09/24 20:33:29  swiergot
# - Switched to the stable branch.
# - Version 1.3.
#
# Revision 1.17  2003/09/23 07:50:01  swiergot
# - Version 20030922.
#
# Revision 1.16  2003/09/16 13:02:58  swiergot
# - Version 20030915.
#
# Revision 1.15  2003/09/13 07:08:30  swiergot
# - Version 20030912.
#
# Revision 1.14  2003/09/10 21:01:45  swiergot
# - Version 20030910.
#
# Revision 1.13  2003/09/09 20:42:15  swiergot
# - Merged the two _doc commands to only one.
#
# Revision 1.12  2003/09/09 20:38:07  swiergot
# - Version 20030909.
# - Rewritten _doc.
#

--- NEW FILE: ekg.pwinfo ---
info="A console Gadu-Gadu client."
desc="ekg stands for 'Eksperymentalny Klient Gadu-Gadu', that means 'Experimental Gadu-Gadu Client'.

Gadu-Gadu is an IM (Instant Messaging) system developed in Poland. It is commonly used by Polish Internet users."

--- NEW FILE: libgadu.pwinfo ---
info="A client-side library for Gadu-Gadu."
desc="libgadu library is responsible for Gadu-Gadu protocol implementation in open source Gadu-Gadu clients, like ekg or Kadu, or even in a Jabber transport to Gadu-Gadu network, named jggtrans.

libgadu has been developed by Wojtek Kaniewski, along with ekg - a console Gadu-Gadu client."

--- NEW FILE: libgadu.pwsub ---
/usr/include
/usr/lib
/usr/doc/ekg-${version}/api.txt
/usr/doc/ekg-${version}/protocol.html
/usr/doc/ekg-${version}/functions.txt



From nobody at sheep.berlios.de  Fri Jul 30 18:48:59 2004
From: nobody at sheep.berlios.de (swiergot)
Date: Fri, 30 Jul 2004 18:48:59 +0200
Subject: [Packware-cvs] pwbuild/n/ekg ekg.pwbuild,1.1,1.2
Message-ID: <200407301648.i6UGmx618090@bat.berlios.de>

Update of /cvsroot/packware/pwbuild/n/ekg
In directory sheep:/tmp/cvs-serv24049

Modified Files:
	ekg.pwbuild 
Log Message:
- Version 1.5.


Index: ekg.pwbuild
===================================================================
RCS file: /cvsroot/packware/pwbuild/n/ekg/ekg.pwbuild,v
retrieving revision 1.1
retrieving revision 1.2
diff -C2 -d -r1.1 -r1.2
*** ekg.pwbuild	30 Jul 2004 16:46:09 -0000	1.1
--- ekg.pwbuild	30 Jul 2004 16:48:56 -0000	1.2
***************
*** 2,6 ****
  
  name="ekg"
! version="1.4"
  build="1"
  
--- 2,6 ----
  
  name="ekg"
! version="1.5"
  build="1"
  
***************
*** 9,13 ****
  _doc -d -b docs ../ChangeLog IDEAS-2.0 *.txt protocol.html emoticons.* api/functions.txt -x CVS
  
! _source -m 8f35030c05e62c30ce9068e26bd365a2 -s 465347 -g http://dev.null.pl/${name}/
  
  _patch varstxt
--- 9,13 ----
  _doc -d -b docs ../ChangeLog IDEAS-2.0 *.txt protocol.html emoticons.* api/functions.txt -x CVS
  
! _source -m 721ebfe7b13e9531b30d558465e6695f -s 483606 -g http://dev.null.pl/${name}/
  
  _patch varstxt
***************
*** 31,34 ****
--- 31,37 ----
  
  # $Log$
+ # Revision 1.2  2004/07/30 16:48:56  swiergot
+ # - Version 1.5.
+ #
  # Revision 1.1  2004/07/30 16:46:09  swiergot
  # - Initial commit.



From nobody at sheep.berlios.de  Fri Jul 30 19:23:10 2004
From: nobody at sheep.berlios.de (swiergot)
Date: Fri, 30 Jul 2004 19:23:10 +0200
Subject: [Packware-cvs] pwbuild/d/java3d-re-blackdown java3d-re-blackdown.pwinfo,1.1,1.2
Message-ID: <200407301723.i6UHNA618659@bat.berlios.de>

Update of /cvsroot/packware/pwbuild/d/java3d-re-blackdown
In directory sheep:/tmp/cvs-serv26645

Modified Files:
	java3d-re-blackdown.pwinfo 
Log Message:
- Updated.


Index: java3d-re-blackdown.pwinfo
===================================================================
RCS file: /cvsroot/packware/pwbuild/d/java3d-re-blackdown/java3d-re-blackdown.pwinfo,v
retrieving revision 1.1
retrieving revision 1.2
diff -C2 -d -r1.1 -r1.2
*** java3d-re-blackdown.pwinfo	30 Jul 2004 13:44:54 -0000	1.1
--- java3d-re-blackdown.pwinfo	30 Jul 2004 17:23:07 -0000	1.2
***************
*** 1,2 ****
! info="Java 2 SE for Linux."
! desc="The Java 2 Standard Edition (J2SE) is a feature-complete development and deployment platform. Blackdown provides both a SDK (J2SDK, formerly known as JDK) and a runtime environment (J2RE) for Linux on various architectures (ix86, Sparc, PPC, S/390, ARM, m68k). Both the J2SDK and the J2RE contain the Java Plug-In for Netscape 4.x and Mozilla/Netscape 6.x."
--- 1,2 ----
! info="Java 3D extension."
! desc="Java 3D is an extension to a standard Java installation. It allows Java applets to utilise OpenGL technology."



From nobody at sheep.berlios.de  Fri Jul 30 19:27:54 2004
From: nobody at sheep.berlios.de (swiergot)
Date: Fri, 30 Jul 2004 19:27:54 +0200
Subject: [Packware-cvs] pwbuild/xap - New directory
Message-ID: <200407301727.i6UHRs618736@bat.berlios.de>

Update of /cvsroot/packware/pwbuild/xap
In directory sheep:/tmp/cvs-serv26786/xap

Log Message:
Directory /cvsroot/packware/pwbuild/xap added to the repository




From nobody at sheep.berlios.de  Fri Jul 30 19:28:15 2004
From: nobody at sheep.berlios.de (swiergot)
Date: Fri, 30 Jul 2004 19:28:15 +0200
Subject: [Packware-cvs] pwbuild/xap/kadu - New directory
Message-ID: <200407301728.i6UHSF618770@bat.berlios.de>

Update of /cvsroot/packware/pwbuild/xap/kadu
In directory sheep:/tmp/cvs-serv26816/kadu

Log Message:
Directory /cvsroot/packware/pwbuild/xap/kadu added to the repository




From nobody at sheep.berlios.de  Fri Jul 30 19:28:44 2004
From: nobody at sheep.berlios.de (swiergot)
Date: Fri, 30 Jul 2004 19:28:44 +0200
Subject: [Packware-cvs] pwbuild/xap/kadu kadu-cvs.pwbuild,NONE,1.1 kadu-libgsm-install.pw.patch,NONE,1.1 kadu-lpthread.pw.patch,NONE,1.1 kadu-modules-cvs.pw.patch,NONE,1.1 kadu-modules.pw.patch,NONE,1.1 kadu.desktop,NONE,1.1 kadu.pwbuild,NONE,1.1 kadu.pwinfo,NONE,1.1
Message-ID: <200407301728.i6UHSi618774@bat.berlios.de>

Update of /cvsroot/packware/pwbuild/xap/kadu
In directory sheep:/tmp/cvs-serv26868

Added Files:
	kadu-cvs.pwbuild kadu-libgsm-install.pw.patch 
	kadu-lpthread.pw.patch kadu-modules-cvs.pw.patch 
	kadu-modules.pw.patch kadu.desktop kadu.pwbuild kadu.pwinfo 
Log Message:
- Initial commit.
- Version 0.3.9/20040930.


--- NEW FILE: kadu-cvs.pwbuild ---
#!/bin/sh

name="kadu"
version="20040730"
build="1"

_pwbuilder 0.6.3

_doc -d -x CVS ChangeLog

_source -m aa05d9b21e9dea76e65bf5ef96478bbf -s 953811 -t ${name} http://kadu.net/download/snapshots/

_patch lpthread
_patch libgsm-install
_patch modules-cvs

_c_opt --prefix=/usr
_c_opt --enable-modules
_c_opt --with-existing-libgadu

_cmi

for i in AUTHORS ChangeLog COPYING HISTORY README THANKS; do
    rm ${pkg}/usr/share/kadu/${i}
    ln -s ../../doc/${name}-${version}/${i} ${pkg}/usr/share/kadu
done

mkdir ${pkg}/opt/kde/share/applnk/Internet
cp ${src}/kadu.desktop ${pkg}/opt/kde/share/applnk/Internet
mkdir ${pkg}/opt/kde/share/icons/hicolor/{16x16/apps,32x32/apps,48x48/apps}
cp ${src1}/kadu/hi16-app-kadu.png ${pkg}/opt/kde/share/icons/hicolor/16x16/apps/kadu.png
cp ${src1}/kadu/hi32-app-kadu.png ${pkg}/opt/kde/share/icons/hicolor/32x32/apps/kadu.png
cp ${src1}/kadu/hi48-app-kadu.png ${pkg}/opt/kde/share/icons/hicolor/48x48/apps/kadu.png

# $Log: kadu-cvs.pwbuild,v $
# Revision 1.1  2004/07/30 17:28:42  swiergot
# - Initial commit.
# - Version 0.3.9/20040930.
#

--- NEW FILE: kadu-libgsm-install.pw.patch ---
diff -ruN kadu.orig/modules/voice/libgsm/Makefile kadu/modules/voice/libgsm/Makefile
--- kadu.orig/modules/voice/libgsm/Makefile	2003-10-15 16:09:01.000000000 +0200
+++ kadu/modules/voice/libgsm/Makefile	2004-04-12 16:20:12.000000000 +0200
@@ -78,9 +78,9 @@
 # Leave GSM_INSTALL_ROOT empty to not install the GSM library outside of
 # this directory.
 
-GSM_INSTALL_ROOT = $(INSTALL_ROOT)
+GSM_INSTALL_ROOT = $(INSTALL_ROOT)/usr
 GSM_INSTALL_LIB = $(GSM_INSTALL_ROOT)/lib
-GSM_INSTALL_INC = $(GSM_INSTALL_ROOT)/inc
+GSM_INSTALL_INC = $(GSM_INSTALL_ROOT)/include
 GSM_INSTALL_MAN = $(GSM_INSTALL_ROOT)/man/man3
 
 
@@ -89,7 +89,7 @@
 # Leave TOAST_INSTALL_ROOT empty to not install the toast binaries outside
 # of this directory.
 
-TOAST_INSTALL_ROOT	  = $(INSTALL_ROOT)
+TOAST_INSTALL_ROOT	  = $(INSTALL_ROOT)/usr
 TOAST_INSTALL_BIN = $(TOAST_INSTALL_ROOT)/bin
 TOAST_INSTALL_MAN = $(TOAST_INSTALL_ROOT)/man/man1
 
@@ -352,49 +352,59 @@
 
 $(TOAST_INSTALL_BIN)/toast:	$(TOAST)
 		-rm $@
+		mkdir -p $(TOAST_INSTALL_BIN)
 		cp $(TOAST) $@
 		chmod 755 $@
 
 $(TOAST_INSTALL_BIN)/untoast:	$(TOAST_INSTALL_BIN)/toast
 		-rm $@
+		mkdir -p $(TOAST_INSTALL_BIN)
 		ln $? $@
 
 $(TOAST_INSTALL_BIN)/tcat:	$(TOAST_INSTALL_BIN)/toast
 		-rm $@
+		mkdir -p $(TOAST_INSTALL_BIN)
 		ln $? $@
 
 $(TOAST_INSTALL_MAN)/toast.1:	$(MAN)/toast.1
 		-rm $@
+		mkdir -p $(TOAST_INSTALL_MAN)
 		cp $? $@
 		chmod 444 $@
 
 $(GSM_INSTALL_MAN)/gsm.3:	$(MAN)/gsm.3
 		-rm $@
+		mkdir -p $(GSM_INSTALL_MAN)
 		cp $? $@
 		chmod 444 $@
 
 $(GSM_INSTALL_MAN)/gsm_option.3:	$(MAN)/gsm_option.3
 		-rm $@
+		mkdir -p $(GSM_INSTALL_MAN)
 		cp $? $@
 		chmod 444 $@
 
 $(GSM_INSTALL_MAN)/gsm_explode.3:	$(MAN)/gsm_explode.3
 		-rm $@
+		mkdir -p $(GSM_INSTALL_MAN)
 		cp $? $@
 		chmod 444 $@
 
 $(GSM_INSTALL_MAN)/gsm_print.3:	$(MAN)/gsm_print.3
 		-rm $@
+		mkdir -p $(GSM_INSTALL_MAN)
 		cp $? $@
 		chmod 444 $@
 
 $(GSM_INSTALL_INC)/gsm.h:	$(INC)/gsm.h
 		-rm $@
+		mkdir -p $(GSM_INSTALL_INC)
 		cp $? $@
 		chmod 444 $@
 
 $(GSM_INSTALL_LIB)/libgsm.a:	$(LIBGSM)
 		-rm $@
+		mkdir -p $(GSM_INSTALL_LIB)
 		cp $? $@
 		chmod 444 $@
 

--- NEW FILE: kadu-lpthread.pw.patch ---
diff -ruN kadu.orig/configure kadu/configure
--- kadu.orig/configure	2004-04-10 17:28:47.000000000 +0200
+++ kadu/configure	2004-04-20 14:51:54.000000000 +0200
@@ -5889,7 +5889,7 @@
 	echo "$as_me:$LINENO: checking if libgadu.so/dylib library is in system directories" >&5
 echo $ECHO_N "checking if libgadu.so/dylib library is in system directories... $ECHO_C" >&6
 	save_CFLAGS="$CFLAGS"
-	CFLAGS="$CFLAGS  -lgadu"
+	CFLAGS="$CFLAGS  -lpthread -lgadu"
 	cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF

--- NEW FILE: kadu-modules-cvs.pw.patch ---
diff -ruN kadu.orig/.config kadu/.config
--- kadu.orig/.config	2004-07-20 23:18:35.000000000 +0200
+++ kadu/.config	2004-07-30 18:55:39.000000000 +0200
@@ -7,61 +7,61 @@
 #
 
 # Tray icon support
-module_docking=y
+module_docking=m
 
 # XLib tray docking techniques module
-module_x11_docking=y
+module_x11_docking=m
 
 # WindowMaker docking module
-module_wmaker_docking=n
+module_wmaker_docking=m
 
 # OpenSSL encrypted chat support
-module_encryption=y
+module_encryption=m
 
 # Speech synthesis support
-module_speech=n
+module_speech=m
 
 # Voice chat support
-module_voice=y
+module_voice=m
 
 # General sound support
-module_sound=y
+module_sound=m
 
 # External application sound support
-module_ext_sound=y
+module_ext_sound=m
 
 # Direct /dev/dsp sound support
 module_dsp_sound=m
 
 # Arts sound server support
-module_arts_sound=n
+module_arts_sound=m
 
 # ESD sound server support
-module_esd_sound=n
+module_esd_sound=m
 
 # Network Audio System support
 module_nas_sound=n
 
 # SMS module
-module_sms=y
+module_sms=m
 
 # default gateways for SMS module
-module_default_sms=y
+module_default_sms=m
 
 # dcc module with file transfer support
-module_dcc=y
+module_dcc=m
 
 # Auto away module
-module_autoaway=y
+module_autoaway=m
 
 # Register/unregister account, remind/change password support
-module_account_management=y
+module_account_management=m
 
 # Autoresponder module
 module_autoresponder=m
 
 # Echo sample module
-module_echo=n
+module_echo=m
 
 #
 # Below are some external modules, made by third parties, but
@@ -72,22 +72,22 @@
 #
 
 # TCL scripting support and KaduPro extensions
-module_tcl_scripting=n
+module_tcl_scripting=n
 
 # Xmms player support
-module_xmms=n
+module_xmms=m
 
 # AmaroK player support
-module_amarok=n
+module_amarok=m
 
 # Description from file module
-module_filedesc=n
+module_filedesc=m
 
 # Mail checker module
-module_mail=n
+module_mail=m
 
 # Spellchecker module (Aspell support)
-module_spellchecker=n
+module_spellchecker=m
 
 # PC-Speaker support
-module_pcspeaker=n
+module_pcspeaker=m

--- NEW FILE: kadu-modules.pw.patch ---
diff -ruN kadu.orig/.config kadu/.config
--- kadu.orig/.config	2004-06-20 17:02:43.000000000 +0200
+++ kadu/.config	2004-07-30 19:15:16.000000000 +0200
@@ -7,55 +7,55 @@
 #
 
 # Tray icon support
-module_docking=y
+module_docking=m
 
 # XLib tray docking techniques module
-module_x11_docking=y
+module_x11_docking=m
 
 # WindowMaker docking module
-module_wmaker_docking=n
+module_wmaker_docking=m
 
 # OpenSSL encrypted chat support
-module_encryption=y
+module_encryption=m
 
 # Speech synthesis support
-module_speech=n
+module_speech=m
 
 # Voice chat support
-module_voice=y
+module_voice=m
 
 # General sound support
-module_sound=y
+module_sound=m
 
 # External application sound support
-module_ext_sound=y
+module_ext_sound=m
 
 # Direct /dev/dsp sound support
 module_dsp_sound=m
 
 # Arts sound server support
-module_arts_sound=n
+module_arts_sound=m
 
 # ESD sound server support
-module_esd_sound=n
+module_esd_sound=m
 
 # Network Audio System support
 module_nas_sound=n
 
 # SMS module
-module_sms=y
+module_sms=m
 
 # default gateways for SMS module
-module_default_sms=y
+module_default_sms=m
 
 # Auto away module
-module_autoaway=y
+module_autoaway=m
 
 # Autoresponder module
 module_autoresponder=m
 
 # Echo sample module
-module_echo=n
+module_echo=m
 
 #
 # Below are some external modules, made by third parties, but
@@ -66,22 +66,22 @@
 #
 
 # TCL scripting support and KaduPro extensions
-module_tcl_scripting=n
+module_tcl_scripting=n
 
 # Xmms player support
-module_xmms=n
+module_xmms=m
 
 # AmaroK player support
-module_amarok=n
+module_amarok=m
 
 # Description from file module
-module_filedesc=n
+module_filedesc=m
 
 # Mail checker module
-module_mail=n
+module_mail=m
 
 # Spellchecker module (Aspell support)
-module_spellchecker=n
+module_spellchecker=m
 
 # PC-Speaker support
-module_pcspeaker=n
+module_pcspeaker=m

--- NEW FILE: kadu.desktop ---
[Desktop Entry]
Type=Application
Exec=/usr/bin/kadu
Icon=kadu.png
MiniIcon=kadu.png
Terminal=0
Name=Kadu
GenericName[pl]=Klient Gadu-Gadu

--- NEW FILE: kadu.pwbuild ---
#!/bin/sh

name="kadu"
version="0.3.9"
build="1"

_pwbuilder 0.6.3

_doc -d ChangeLog

_source -m d461c4b19670920e2ba1425d12e23f6b -s 942895 -t ${name} http://kadu.net/download/stable/

_patch lpthread
_patch libgsm-install
_patch modules

_c_opt --prefix=/usr
_c_opt --enable-modules
_c_opt --with-existing-libgadu

_cmi

for i in AUTHORS ChangeLog COPYING HISTORY README THANKS; do
    rm ${pkg}/usr/share/kadu/${i}
    ln -s ../../doc/${name}-${version}/${i} ${pkg}/usr/share/kadu
done

mkdir ${pkg}/opt/kde/share/applnk/Internet
cp ${src}/kadu.desktop ${pkg}/opt/kde/share/applnk/Internet
mkdir ${pkg}/opt/kde/share/icons/hicolor/{16x16/apps,32x32/apps,48x48/apps}
cp ${src1}/kadu/hi16-app-kadu.png ${pkg}/opt/kde/share/icons/hicolor/16x16/apps/kadu.png
cp ${src1}/kadu/hi32-app-kadu.png ${pkg}/opt/kde/share/icons/hicolor/32x32/apps/kadu.png
cp ${src1}/kadu/hi48-app-kadu.png ${pkg}/opt/kde/share/icons/hicolor/48x48/apps/kadu.png

# $Log: kadu.pwbuild,v $
# Revision 1.1  2004/07/30 17:28:42  swiergot
# - Initial commit.
# - Version 0.3.9/20040930.
#

--- NEW FILE: kadu.pwinfo ---
info="A Gadu-Gadu client for KDE."
desc="Kadu is a KDE client for Gadu-Gadu, a Polish messenger application similar to AIM or ICQ.

It's based on libgadu, a reverse-engineered Unix API for Gadu-Gadu, and implements most features of the original."



From nobody at sheep.berlios.de  Fri Jul 30 19:44:08 2004
From: nobody at sheep.berlios.de (stoodi)
Date: Fri, 30 Jul 2004 19:44:08 +0200
Subject: [Packware-cvs] tools - New directory
Message-ID: <200407301744.i6UHi8619085@bat.berlios.de>

Update of /cvsroot/packware/tools
In directory sheep:/tmp/cvs-serv27465/tools

Log Message:
Directory /cvsroot/packware/tools added to the repository




From nobody at sheep.berlios.de  Fri Jul 30 19:50:54 2004
From: nobody at sheep.berlios.de (stoodi)
Date: Fri, 30 Jul 2004 19:50:54 +0200
Subject: [Packware-cvs] tools/mkdis - New directory
Message-ID: <200407301750.i6UHos619238@bat.berlios.de>

Update of /cvsroot/packware/tools/mkdis
In directory sheep:/tmp/cvs-serv27809/mkdis

Log Message:
Directory /cvsroot/packware/tools/mkdis added to the repository




From nobody at sheep.berlios.de  Fri Jul 30 19:56:31 2004
From: nobody at sheep.berlios.de (stoodi)
Date: Fri, 30 Jul 2004 19:56:31 +0200
Subject: [Packware-cvs] tools/mkdis mkdis.py,NONE,1.1
Message-ID: <200407301756.i6UHuV619320@bat.berlios.de>

Update of /cvsroot/packware/tools/mkdis
In directory sheep:/tmp/cvs-serv28106

Added Files:
	mkdis.py 
Log Message:
- Initial commit.
- Version 0.4


--- NEW FILE: mkdis.py ---
#!/usr/bin/python
# This is just prototype for future development :D
# for now, works.
#
# StOOdi's excersizes
# Version 0.4
#
# TODO: 
# - names distribution directory (ex. kde, gnome, xfce)
# - mdsums from .md5sum files
# - maybe versions from distribution files
#

import sys, os, getopt

def make_dist(name = 'NoName', version = 'Version', link='http://nobady.home'):

    shell = "#!/bin/sh"
    pname = "name=" + '"' + name + '"'
    pversion = "version=" + '"' + version + '"'
    build = "build=" + '"' + '1' + '"'
    pwbuilder = "_pwbuilder 0.6.4"
    doc = "_doc -d" 
    source = "_source -g -m md5sum" + " " + link  
    copt1 = "_c_opt --prefix=/usr"
    cmi = "_cmi"
    log = "# $" + "Log" + "$" # Stupid but, cvs ... eh...
    CR = '\n'
    DCR = '\n\n'
    
    lines = [ shell, DCR,
              pname, CR,
              pversion, CR,
              build, DCR,
              pwbuilder, DCR,
              doc, DCR,
              source, DCR,
              copt1, DCR,
              cmi, DCR,
              log, CR ]
    
    # Here what we do.
    cwd = os.getcwd()   # getting current working dir
    os.mkdir(cwd + os.sep + name)      # makes dist dir
    os.chdir(name)  # go to dist dir
    # Make needed files
    buildfile = open(name + ".pwbuild",'w')
    buildfile.writelines(lines)
    buildfile.close()
    # Here we can add freshinfo support :)
    infofile = open(name + ".pwinfo", 'w')
    infofile.close()
    os.chdir('..')
    
def usage():
    print """

    -n --name       name of package
    -v --version    version of pakcage
    -l --link       link to source files
    -f --filelist   file with packages names one in line
                    this parameter should be the last.
    
    mkdis.py -n name -v version -l link

    mkdis.py -v 3.44 -f filelist.txt


    Not given parameter take default value.
    
    """

def main(argv):                         

    pname = 'None'
    pversion = 'None'
    plink = 'http://linktofiles'
                     
    try:                                
        opts, args = getopt.getopt(argv, "n:v:l:f:h", ["name",
                                                      "version",
                                                      "link",
                                                      "filelist",
                                                      "help"]) 
    except getopt.GetoptError:           
        usage()                          
        sys.exit(2)                     

    for opt, arg in opts:                

        if opt in ("-h", "--help"):      
            usage()
            sys.exit(2)
            
        elif opt in ("-n", "--name"): 
            pname = arg

        elif opt in ("-v", "--version"):
            pversion = arg

        elif opt in ("-l", "--link"):
            plink = arg

        elif opt in ("-f", "--filelist"):
            pfname = arg

            file = open(pfname, 'r')
            lines = file.readlines()
                        
            for fname in lines:
                fname = fname.rstrip()
                make_dist(name = fname, version = pversion, link = plink)
            sys.exit(2)
            

    make_dist(name = pname , version = pversion , link = plink)


if __name__ == "__main__":
    main(sys.argv[1:])



From nobody at sheep.berlios.de  Fri Jul 30 20:11:02 2004
From: nobody at sheep.berlios.de (swiergot)
Date: Fri, 30 Jul 2004 20:11:02 +0200
Subject: [Packware-cvs] pwbuild/xap/sylpheed-claws - New directory
Message-ID: <200407301811.i6UIB2619571@bat.berlios.de>

Update of /cvsroot/packware/pwbuild/xap/sylpheed-claws
In directory sheep:/tmp/cvs-serv29064/sylpheed-claws

Log Message:
Directory /cvsroot/packware/pwbuild/xap/sylpheed-claws added to the repository




From nobody at sheep.berlios.de  Fri Jul 30 20:42:48 2004
From: nobody at sheep.berlios.de (stoodi)
Date: Fri, 30 Jul 2004 20:42:48 +0200
Subject: [Packware-cvs] tools/freshinfo - New directory
Message-ID: <200407301842.i6UIgm620359@bat.berlios.de>

Update of /cvsroot/packware/tools/freshinfo
In directory sheep:/tmp/cvs-serv30484/freshinfo

Log Message:
Directory /cvsroot/packware/tools/freshinfo added to the repository




From nobody at sheep.berlios.de  Fri Jul 30 20:45:21 2004
From: nobody at sheep.berlios.de (stoodi)
Date: Fri, 30 Jul 2004 20:45:21 +0200
Subject: [Packware-cvs] tools/freshinfo freshinfo.py,NONE,1.1
Message-ID: <200407301845.i6UIjL620491@bat.berlios.de>

Update of /cvsroot/packware/tools/freshinfo
In directory sheep:/tmp/cvs-serv30654

Added Files:
	freshinfo.py 
Log Message:
- Initial commit.
- Version 0.0.6


--- NEW FILE: freshinfo.py ---
#!/usr/bin/env python
"""Simple script for making .pwinfo files from freshmeat"""
#
# Created by StOOdi - stoodi at gazeta.pl
version = "0.0.6"
# 
#
# This program is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation version 2 of the License.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU Library General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program; if not, write to the Free Software
# Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.

import re, sys, urllib2, string
from xml.dom import minidom

class FreshmeatInfo:
    """ Class for getting info about packages from freshmeat """
     
    # Here initiation variables
    
    def __init__(self):
        self.xmldoc = ""        # here is stored XML source 
        
    def openXML(self, name):
        """opens adress and puts XML source to self.xmldoc"""
        url = 'http://freshmeat.net/projects-xml/' + name + '/' + name + '.xml'
        usock = urllib2.urlopen(url)
        self.xmldoc = minidom.parse(usock)
    
    def getText(self, tag):
        """gets only text from XML tag"""
        names = self.xmldoc.getElementsByTagName(tag)
        element = names[0].toxml()
        start_tag = '<' + tag + '>'
        end_tag = '</' + tag + '>'
        result = element.replace(start_tag,"").replace(end_tag,"").replace("\n"," ")
        return result
         
    def writePwinfo(self):
        """Writes description to name.pwinfo"""
        filename = sys.argv[1] + '.pwinfo'
        pwinfo = open(filename, 'w')
        info = self.getText('desc_short')
        desc = self.getText('desc_full')
                
        pwinfo.write("info=" + '"' + info + '"' + "\n")
        pwinfo.write("desc=" + '"' + desc + '"' + "\n")

# The main ugly script.

inf = FreshmeatInfo()
usage = """
Project not found, or argument not given.

usage:

freshinfo projectname
"""
try:
    inf.openXML(sys.argv[1])
    inf.writePwinfo()
except:
    print __doc__
    print "Version ", version
    print usage




From nobody at sheep.berlios.de  Fri Jul 30 21:27:53 2004
From: nobody at sheep.berlios.de (swiergot)
Date: Fri, 30 Jul 2004 21:27:53 +0200
Subject: [Packware-cvs] pwbuild/xap/sylpheed-claws sylpheed-claws-autogen.pw.patch,NONE,1.1 sylpheed-claws-cvs-gtk2.pwbuild,NONE,1.1 sylpheed-claws-cvs.pwbuild,NONE,1.1 sylpheed-claws.pwbuild,NONE,1.1 sylpheed-claws.pwinfo,NONE,1.1
Message-ID: <200407301927.i6UJRr621174@bat.berlios.de>

Update of /cvsroot/packware/pwbuild/xap/sylpheed-claws
In directory sheep:/tmp/cvs-serv77

Added Files:
	sylpheed-claws-autogen.pw.patch 
	sylpheed-claws-cvs-gtk2.pwbuild sylpheed-claws-cvs.pwbuild 
	sylpheed-claws.pwbuild sylpheed-claws.pwinfo 
Log Message:
- Initial commit.
- Version 0.9.12/0.9.12-39/0.9.12-39.7-gtk2.


--- NEW FILE: sylpheed-claws-autogen.pw.patch ---
diff -ruN sylpheed-claws.orig/autogen.sh sylpheed-claws/autogen.sh
--- sylpheed-claws.orig/autogen.sh	2002-12-03 11:24:51.000000000 +0100
+++ sylpheed-claws/autogen.sh	2003-09-23 09:39:40.000000000 +0200
@@ -4,5 +4,4 @@
   && libtoolize --force --copy \
   && autoheader \
   && automake --add-missing --foreign --copy \
-  && autoconf \
-  && ./configure --enable-maintainer-mode $@
+  && autoconf -Iac/missing

--- NEW FILE: sylpheed-claws-cvs-gtk2.pwbuild ---
#!/bin/sh

name="sylpheed-claws"
version="0.9.12-39.7-gtk2"
build="1"

_pwbuilder 0.6.3

_doc -d README.claws TODO.claws -x CVS

_source -m 2cde18a2a9f471685b4a3200a1093345 -s 2275036 -t ${name} ftp://ftp.berlios.de/pub/packware/sources/

_patch autogen

( cd ${src1} ; ./autogen.sh )

_c_opt --prefix=/usr
_c_opt --program-suffix=-claws

_c_opt --enable-ldap
_c_opt --enable-ipv6
_c_opt --enable-spamassassin-plugin

_have_gpgme && _c_opt --enable-gpgme
_have_openssl && _c_opt --enable-openssl
_have_aspell && _c_opt --enable-aspell

_m_opt faqdir=${docdir}/faq
_m_opt manualdir=${docdir}/manual

_i_opt faqdir=${docdir}/faq
_i_opt manualdir=${docdir}/manual

_cmi

rm ${doc}/manual/ja/sylpheed.sgml

# $Log: sylpheed-claws-cvs-gtk2.pwbuild,v $
# Revision 1.1  2004/07/30 19:27:51  swiergot
# - Initial commit.
# - Version 0.9.12/0.9.12-39/0.9.12-39.7-gtk2.
#

--- NEW FILE: sylpheed-claws-cvs.pwbuild ---
#!/bin/sh

name="sylpheed-claws"
version="0.9.12-39"
build="1"

_pwbuilder 0.6.3

_doc -d README.claws TODO.claws -x CVS

_source -m ad4f6beef232c8e2b8fbb98813328bdd -s 2290857 -t ${name} ftp://ftp.berlios.de/pub/packware/sources/

_patch autogen

( cd ${src1} ; ./autogen.sh )

_c_opt --prefix=/usr
_c_opt --program-suffix=-claws

_c_opt --enable-ldap
_c_opt --enable-ipv6
_c_opt --enable-spamassassin-plugin

_have_gpgme && _c_opt --enable-gpgme
_have_openssl && _c_opt --enable-openssl
_have_aspell && _c_opt --enable-aspell

_m_opt faqdir=${docdir}/faq
_m_opt manualdir=${docdir}/manual

_i_opt faqdir=${docdir}/faq
_i_opt manualdir=${docdir}/manual

_cmi

rm ${doc}/manual/ja/sylpheed.sgml

# $Log: sylpheed-claws-cvs.pwbuild,v $
# Revision 1.1  2004/07/30 19:27:51  swiergot
# - Initial commit.
# - Version 0.9.12/0.9.12-39/0.9.12-39.7-gtk2.
#

--- NEW FILE: sylpheed-claws.pwbuild ---
#!/bin/sh

name="sylpheed-claws"
version="0.9.12"
build="1"

_pwbuilder 0.6.3

_doc -d README.claws RELEASE_NOTES.claws TODO.claws

_source -m 798f25bb5dae7fd4959fbcb38868bef0 -s 3031344 -f

_c_opt --prefix=/usr
_c_opt --program-suffix=-claws

_c_opt --enable-ldap
_c_opt --enable-ipv6
_c_opt --enable-spamassassin-plugin

_have_gpgme && _c_opt --enable-gpgme
_have_openssl && _c_opt --enable-openssl
_have_aspell && _c_opt --enable-aspell

_m_opt faqdir=${docdir}/faq
_m_opt manualdir=${docdir}/manual

_i_opt faqdir=${docdir}/faq
_i_opt manualdir=${docdir}/manual

_cmi

rm ${doc}/manual/ja/sylpheed.sgml

# $Log: sylpheed-claws.pwbuild,v $
# Revision 1.1  2004/07/30 19:27:51  swiergot
# - Initial commit.
# - Version 0.9.12/0.9.12-39/0.9.12-39.7-gtk2.
#

--- NEW FILE: sylpheed-claws.pwinfo ---
info="A GTK+ based user-friendly e-mail client."
desc="Sylpheed is a GTK+ based, lightweight, and fast e-mail client. Almost all commands are accessible with the keyboard. It also has many features such as multiple accounts, POP3/APOP support, thread display, and multipart MIME.
This is an alternative version of Sylpheed, called Claws. It has many more features and has fixed all bugs found in latest version of original Sylpheed."



From nobody at sheep.berlios.de  Fri Jul 30 22:34:16 2004
From: nobody at sheep.berlios.de (swiergot)
Date: Fri, 30 Jul 2004 22:34:16 +0200
Subject: [Packware-cvs] pwbuild/xap/psi - New directory
Message-ID: <200407302034.i6UKYG622472@bat.berlios.de>

Update of /cvsroot/packware/pwbuild/xap/psi
In directory sheep:/tmp/cvs-serv2992/psi

Log Message:
Directory /cvsroot/packware/pwbuild/xap/psi added to the repository




From nobody at sheep.berlios.de  Fri Jul 30 22:34:56 2004
From: nobody at sheep.berlios.de (swiergot)
Date: Fri, 30 Jul 2004 22:34:56 +0200
Subject: [Packware-cvs] pwbuild/xap/psi indicator.png,NONE,1.1 psi-cvs.pwbuild,NONE,1.1 psi-enable-mng.pw.patch,NONE,1.1 psi-no_default_status_text.patch,NONE,1.1 psi-no_online_status.patch,NONE,1.1 psi-offline_status.patch,NONE,1.1 psi-opt.pw.patch,NONE,1.1 psi-status_history.patch,NONE,1.1 psi-status_indicator-cvs.patch,NONE,1.1 psi-status_indicator.patch,NONE,1.1 psi-translations.pw.patch,NONE,1.1 psi.pwbuild,NONE,1.1 psi.pwinfo,NONE,1.1 uic-wrapper,NONE,1.1
Message-ID: <200407302034.i6UKYu622486@bat.berlios.de>

Update of /cvsroot/packware/pwbuild/xap/psi
In directory sheep:/tmp/cvs-serv3049

Added Files:
	indicator.png psi-cvs.pwbuild psi-enable-mng.pw.patch 
	psi-no_default_status_text.patch psi-no_online_status.patch 
	psi-offline_status.patch psi-opt.pw.patch 
	psi-status_history.patch psi-status_indicator-cvs.patch 
	psi-status_indicator.patch psi-translations.pw.patch 
	psi.pwbuild psi.pwinfo uic-wrapper 
Log Message:
- Initial commit.
- Version 0.9.2/20040730.


--- NEW FILE: indicator.png ---
(This appears to be a binary file; contents omitted.)

--- NEW FILE: psi-cvs.pwbuild ---
#!/bin/sh

name="psi"
version="20040730"
build="1"

_pwbuilder 0.6.4

_doc -d ChangeLog -x CVS

_source -m f0abfdb90e302070cf861ec46848c98c -s 1816833 -t ${name}/${name} ftp://ftp.berlios.de/pub/packware/sources/

_patch -p 0 translations
_patch no_online_status
_patch no_default_status_text
_patch status_history
_patch status_indicator-cvs

_have_libmng && _patch enable-mng

_setexecdir ${src1}/../qca
_execindir cp README ${doc}/README.qca
_execindir _configure --prefix=/usr
_qconf_fix ${src1}/../qca/Makefile
_execindir _make
_execindir _install

if _have_sasl2; then
    _setexecdir ${src1}/../qca/plugins/qca-sasl
    _execindir cp README ${doc}/README.qca-sasl
    _execindir _configure
    _qconf_fix ${src1}/../qca/plugins/qca-sasl/Makefile
    _execindir _make
    _execindir _install
fi

if _have_openssl; then
    _setexecdir ${src1}/../qca/plugins/qca-tls
    _execindir cp README ${doc}/README.qca-tls
    _execindir _configure
    _qconf_fix ${src1}/../qca/plugins/qca-tls/Makefile
    _execindir _make
    _execindir _install
fi

_c_opt --prefix=/usr

_configure

( cd ${src1}/src ; qmake -o Makefile )
_qconf_fix ${src1}/src/Makefile

# If you get a 'double const' error, uncomment these lines:
#
# sed "s}\$(QTDIR)/bin/uic}${src}/uic-wrapper}" ${src1}/src/Makefile > ${tmp}/uicfix
# cat ${tmp}/uicfix > ${src1}/src/Makefile

_patch opt

_make
_install

rm ${pkg}/usr/share/psi/{COPYING,README}
ln -s ${docdir}/COPYING ${pkg}/usr/share/psi
ln -s ${docdir}/README ${pkg}/usr/share/psi

cp ${src}/indicator.png ${pkg}/usr/share/psi/iconsets/roster/default

# $Log: psi-cvs.pwbuild,v $
# Revision 1.1  2004/07/30 20:34:54  swiergot
# - Initial commit.
# - Version 0.9.2/20040730.
#

--- NEW FILE: psi-enable-mng.pw.patch ---
diff -ruN psi.orig/libpsi.pri psi/libpsi.pri
--- psi.orig/libpsi.pri	2003-10-07 09:27:52.000000000 +0200
+++ psi/libpsi.pri	2003-10-09 15:07:23.000000000 +0200
@@ -11,7 +11,7 @@
 
 	# psipng
 	CONFIG += psipng
-	#CONFIG += psimng # uncomment this if you're really brave, and you have libmng installed
+	CONFIG += psimng
 	PSIPNG_CPP = $$LIBPSI_CPP/psipng
 	include($$PSIPNG_CPP/psipng.pri)
 }

--- NEW FILE: psi-no_default_status_text.patch ---
diff -ru -X exclude psi-clean/src/psicon.cpp psi/src/psicon.cpp
--- psi-clean/src/psicon.cpp	Fri Oct 24 05:38:42 2003
+++ psi/src/psicon.cpp	Sun Oct 26 14:42:44 2003
@@ -739,10 +739,7 @@
 		}
 		else {
 			QString str;
-			if(d->lastStatusString.isEmpty())
-				str = tr("I am away from my computer.  Please leave a message.");
-			else
-				str = d->lastStatusString; // default to old away message
+			str = d->lastStatusString; // default to old away message
 
 			StatusSetDlg *w = new StatusSetDlg(this, makeStatus(x, str));
 			connect(w, SIGNAL(set(const Status &)), SLOT(setStatusFromDialog(const Status &)));

--- NEW FILE: psi-no_online_status.patch ---
diff -ru psi/src/psiaccount.cpp psi-smk2/src/psiaccount.cpp
--- psi/src/psiaccount.cpp	2003-06-17 05:46:02.000000000 +0200
+++ psi-smk2/src/psiaccount.cpp	2003-06-19 23:48:40.000000000 +0200
@@ -1043,8 +1043,8 @@
 	Status s = _s;
 	s.setPriority(d->acc.priority);
 
-	if(s.status().isEmpty())
-		s.setStatus(status2txt(makeSTATUS(s)));
+//	if(s.status().isEmpty())
+//		s.setStatus(status2txt(makeSTATUS(s)));
 
 	//printf("setting status to [%s]\n", s.status().latin1());
 
@@ -1551,7 +1551,7 @@
 	}
 	else {
 		if(x == STATUS_ONLINE && !option.askOnline) {
-			setStatus(Status());
+			setStatus(Status("","",0,true));
 		}
 		else if(x == STATUS_INVISIBLE){
 			Status s("","",0,true);

--- NEW FILE: psi-offline_status.patch ---
diff -ru -X exclude psi-clean/src/common.h psi/src/common.h
--- psi-clean/src/common.h	Tue Jan 27 18:09:30 2004
+++ psi/src/common.h	Sun Feb 15 20:29:30 2004
@@ -84,7 +84,7 @@
 	QMap<QString, QString> serviceRosterIconset;
 	QMap<QString, QString> customRosterIconset;
 
-	bool useleft, singleclick, askOnline, popupMsgs, popupChats, popupHeadlines, raise;
+	bool useleft, singleclick, askOnline, askOffline, popupMsgs, popupChats, popupHeadlines, raise;
 	bool alwaysOnTop, noAwaySound, noAwayPopup, noUnlistedPopup, rosterAnim, autoVersion, autoVCardOnLogin, xmlConsoleOnLogin;
 	bool useDock, dockDCstyle, dockHideMW, dockToolMW, isWMDock;
 	bool smallChats;
diff -ru -X exclude psi-clean/src/options/opt_status-ui.ui psi/src/options/opt_status-ui.ui
--- psi-clean/src/options/opt_status-ui.ui	Fri Dec 05 16:44:28 2003
+++ psi/src/options/opt_status-ui.ui	Sun Feb 15 20:33:28 2004
@@ -8,8 +8,8 @@
         <rect>
             <x>0</x>
             <y>0</y>
-            <width>330</width>
-            <height>367</height>
+            <width>221</width>
+            <height>402</height>
         </rect>
     </property>
     <property name="caption">
@@ -25,13 +25,34 @@
         <property name="spacing">
             <number>2</number>
         </property>
-        <widget class="QCheckBox">
+        <widget class="QGroupBox">
             <property name="name">
-                <cstring>ck_askOnline</cstring>
+                <cstring>groupBox1</cstring>
             </property>
-            <property name="text">
-                <string>Prompt for status message when choosing "Online"</string>
+            <property name="title">
+                <string>Prompt for status message when choosing</string>
             </property>
+            <vbox>
+                <property name="name">
+                    <cstring>unnamed</cstring>
+                </property>
+                <widget class="QCheckBox">
+                    <property name="name">
+                        <cstring>ck_askOnline</cstring>
+                    </property>
+                    <property name="text">
+                        <string>Online</string>
+                    </property>
+                </widget>
+                <widget class="QCheckBox">
+                    <property name="name">
+                        <cstring>ck_askOffline</cstring>
+                    </property>
+                    <property name="text">
+                        <string>Offline</string>
+                    </property>
+                </widget>
+            </vbox>
         </widget>
         <widget class="QLayoutWidget">
             <property name="name">
@@ -295,7 +316,6 @@
     </connection>
 </connections>
 <tabstops>
-    <tabstop>ck_askOnline</tabstop>
     <tabstop>ck_asAway</tabstop>
     <tabstop>sb_asAway</tabstop>
     <tabstop>ck_asXa</tabstop>
diff -ru -X exclude psi-clean/src/options/opt_status.cpp psi/src/options/opt_status.cpp
--- psi-clean/src/options/opt_status.cpp	Sat Jan 17 15:48:14 2004
+++ psi/src/options/opt_status.cpp	Sun Feb 15 20:29:38 2004
@@ -102,6 +102,7 @@
 	opt->sp = o->sp;
 
 	opt->askOnline = d->ck_askOnline->isChecked();
+	opt->askOffline = d->ck_askOffline->isChecked();
 }
 
 void OptionsTabStatus::restoreOptions(const Options *opt)
@@ -135,6 +136,7 @@
 		d->lb_sp->setSelected(0, TRUE);
 
 	d->ck_askOnline->setChecked( opt->askOnline );
+	d->ck_askOffline->setChecked( opt->askOffline );
 }
 
 void OptionsTabStatus::setData(PsiCon *, QWidget *parentDialog)
diff -ru -X exclude psi-clean/src/psiaccount.cpp psi/src/psiaccount.cpp
--- psi-clean/src/psiaccount.cpp	Tue Jan 27 18:09:36 2004
+++ psi/src/psiaccount.cpp	Sun Feb 15 21:15:12 2004
@@ -801,7 +801,7 @@
 }
 
 // disconnect or stop reconnecting
-void PsiAccount::logout(bool fast)
+void PsiAccount::logout(bool fast, const Status &s)
 {
 	if(!isActive())
 		return;
@@ -811,7 +811,6 @@
 
 	if(loggedIn()) {
 		// send logout status
-		Status s("", "Logged out", 0, false);
 		d->client->setPresence(s);
 	}
 
@@ -822,6 +821,13 @@
 	v_isActive = false;
 	stateChanged();
 
+	QTimer::singleShot(0, this, SLOT(disconnect()));
+}
+
+// skz note: I had to split logout() because server seem to need some time to store status
+// before stream is closed (weird, I know)
+void PsiAccount::disconnect()
+{
 	// disconnect
 	d->client->close();
 	cleanupStream();
@@ -1546,7 +1552,7 @@
 	}
 	else {
 		if(isActive())
-			logout();
+			logout(false, s);
 	}
 }
 
@@ -2070,7 +2076,7 @@
 
 void PsiAccount::changeStatus(int x)
 {
-	if(x == STATUS_OFFLINE) {
-		setStatus(Status("","",0,false));
+	if(x == STATUS_OFFLINE && !option.askOffline) {
+		setStatus(Status("","Logged out",0,false));
 	}
 	else {
diff -ru -X exclude psi-clean/src/psiaccount.h psi/src/psiaccount.h
--- psi-clean/src/psiaccount.h	Tue Jan 27 18:09:36 2004
+++ psi/src/psiaccount.h	Sun Feb 15 21:10:44 2004
@@ -149,7 +149,7 @@
 	void setStatusDirect(const Status &);
 	void setStatusActual(const Status &);
 	void login();
-	void logout(bool fast=false);
+	void logout(bool fast=false, const Status &s = Status("", "Logged out", 0, false));
 	bool loggedIn() const;
 	void setNick(const QString &);
 	QString nick() const;
@@ -289,6 +289,7 @@
 	void client_incomingJidLink();
 
 	void reconnect();
+	void disconnect();
 	void enableNotifyOnline();
 
 	void slotClientVersionFinished();
diff -ru -X exclude psi-clean/src/psicon.cpp psi/src/psicon.cpp
--- psi-clean/src/psicon.cpp	Thu Feb 12 22:47:38 2004
+++ psi/src/psicon.cpp	Sun Feb 15 20:30:02 2004
@@ -757,7 +757,7 @@
 
 void PsiCon::statusMenuChanged(int x)
 {
-	if(x == STATUS_OFFLINE) {
-		setGlobalStatus(Status("","",0,false));
+	if(x == STATUS_OFFLINE && !option.askOffline) {
+		setGlobalStatus(Status("","Logged out",0,false));
 		if(option.useDock == true)
 			d->mainwin->setTrayToolTip(Status("","",0,false));
diff -ru -X exclude psi-clean/src/psi_profiles.cpp psi/src/psi_profiles.cpp
--- psi-clean/src/psi_profiles.cpp	Tue Jan 27 18:09:32 2004
+++ psi/src/psi_profiles.cpp	Sun Feb 15 20:29:48 2004
@@ -363,6 +363,7 @@
 	prefs.raise = FALSE;
 	prefs.incomingAs = 0;
 	prefs.askOnline = FALSE;
+	prefs.askOffline = FALSE;
 	prefs.rosterAnim = TRUE;
 	prefs.autoVersion = false;
 	prefs.autoVCardOnLogin = true;
@@ -724,6 +725,7 @@
 			p_pres.appendChild(tag);
 
 			tag.appendChild(textTag(doc, "askOnline", prefs.askOnline));
+			tag.appendChild(textTag(doc, "askOffline", prefs.askOffline));
 			tag.appendChild(textTag(doc, "rosterAnim", prefs.rosterAnim));
 			tag.appendChild(textTag(doc, "autoVersion", prefs.autoVersion));
 			tag.appendChild(textTag(doc, "autoVCardOnLogin", prefs.autoVCardOnLogin));
@@ -1186,6 +1188,7 @@
 			QDomElement tag = findSubTag(p_pres, "misc", &found);
 			if(found) {
 				readBoolEntry(tag, "askOnline", &prefs.askOnline);
+				readBoolEntry(tag, "askOffline", &prefs.askOffline);
 				readBoolEntry(tag, "rosterAnim", &prefs.rosterAnim);
 				readBoolEntry(tag, "autoVersion", &prefs.autoVersion);
 				readBoolEntry(tag, "autoVCardOnLogin", &prefs.autoVCardOnLogin);
diff -ru -X exclude psi-clean/src/statusdlg.cpp psi/src/statusdlg.cpp
--- psi-clean/src/statusdlg.cpp	Sun Jan 04 20:30:30 2004
+++ psi/src/statusdlg.cpp	Sun Feb 15 20:38:54 2004
@@ -65,7 +65,7 @@
 //----------------------------------------------------------------------------
 // StatusSetDlg
 //----------------------------------------------------------------------------
-static int combomap[6] = { STATUS_CHAT, STATUS_ONLINE, STATUS_AWAY, STATUS_XA, STATUS_DND, STATUS_INVISIBLE };
+static int combomap[7] = { STATUS_CHAT, STATUS_ONLINE, STATUS_AWAY, STATUS_XA, STATUS_DND, STATUS_INVISIBLE, STATUS_OFFLINE };
 
 class StatusSetDlg::Private
 {
@@ -119,9 +119,9 @@
 	hb1->addWidget(l);
 	d->cb_type = new QComboBox(this);
 	int n;
-	for(n = 0; n < 6; ++n)
+	for(n = 0; n < 7; ++n)
 		d->cb_type->insertItem(status2txt(combomap[n]));
-	for(n = 0; n < 6; ++n) {
+	for(n = 0; n < 7; ++n) {
 		if(type == combomap[n]) {
 			d->cb_type->setCurrentItem(n);
 			break;

--- NEW FILE: psi-opt.pw.patch ---
diff -ruN psi.orig/src/Makefile psi/src/Makefile
--- psi.orig/src/Makefile	2003-10-05 19:28:29.000000000 +0200
+++ psi/src/Makefile	2003-10-05 19:29:58.000000000 +0200
@@ -62,19 +62,19 @@
 .SUFFIXES: .c .cpp .cc .cxx .C
 
 .cpp.o:
-	$(CXX) -c $(CXXFLAGS) $(INCPATH) -o $@ $<
+	$(CXX) -c $(CXXFLAGS) $(INCPATH) $(AM_CFLAGS) -o $@ $<
 
 .cc.o:
-	$(CXX) -c $(CXXFLAGS) $(INCPATH) -o $@ $<
+	$(CXX) -c $(CXXFLAGS) $(INCPATH) $(AM_CFLAGS) -o $@ $<
 
 .cxx.o:
-	$(CXX) -c $(CXXFLAGS) $(INCPATH) -o $@ $<
+	$(CXX) -c $(CXXFLAGS) $(INCPATH) $(AM_CFLAGS) -o $@ $<
 
 .C.o:
-	$(CXX) -c $(CXXFLAGS) $(INCPATH) -o $@ $<
+	$(CXX) -c $(CXXFLAGS) $(INCPATH) $(AM_CFLAGS) -o $@ $<
 
 .c.o:
-	$(CC) -c $(CFLAGS) $(INCPATH) -o $@ $<
+	$(CC) -c $(CFLAGS) $(INCPATH) $(AM_CFLAGS) -o $@ $<
 
 ####### Build rules
 

--- NEW FILE: psi-status_history.patch ---
diff -urN psi-old/src/common.h psi/src/common.h
--- psi-old/src/common.h	2004-02-18 16:45:00.564143280 +0100
+++ psi/src/common.h	2004-02-18 16:46:26.719045744 +0100
@@ -93,6 +93,8 @@
 	int defaultAction;
 	int incomingAs;
 	VarList sp; //status message presets
+	int recentStatusLimit;
+	bool storePresets;
 	QStringList recentStatus; //recent status messages
 
 	int asAway, asXa, asOffline;
diff -urN psi-old/src/psi_profiles.cpp psi/src/psi_profiles.cpp
--- psi-old/src/psi_profiles.cpp	2004-02-18 16:45:00.650130208 +0100
+++ psi/src/psi_profiles.cpp	2004-02-18 16:46:26.791034800 +0100
@@ -397,6 +397,8 @@
 	prefs.sp.set(QObject::tr("Out for the night"), QObject::tr("Out for the night."));
 	prefs.sp.set(QObject::tr("Greece"), QObject::tr("I have gone to a far away place.  I will be back someday!"));
 	prefs.recentStatus.clear();
+	prefs.recentStatusLimit = 5;
+	prefs.storePresets = true;
 
 	prefs.color[cOnline]    = QColor("#0060C0");
 	prefs.color[cListBack]  = QColor("#C0C0C0");
@@ -754,7 +756,12 @@
 			p_pres.appendChild(prefs.sp.toXml(doc, "statuspresets"));
 		}
 		{
-			p_pres.appendChild(stringListToXml(doc, "recentstatus",prefs.recentStatus));
+			QDomElement e;
+			
+			e = stringListToXml(doc, "recentstatus",prefs.recentStatus);
+			e.setAttribute("limit", prefs.recentStatusLimit);
+			setBoolAttribute(e, "storePresets", prefs.storePresets);
+			p_pres.appendChild(e);
 		}
 	}
 
@@ -1230,7 +1237,14 @@
 			tag = findSubTag(p_pres, "statuspresets", &found);
 			if(found)
 				prefs.sp.fromXml(tag);
-			xmlToStringList(p_pres, "recentstatus", &prefs.recentStatus);
+			tag = findSubTag(p_pres, "recentstatus", &found);
+			if(found){
+				if(tag.hasAttribute("limit"))
+					prefs.recentStatusLimit = tag.attribute("limit").toInt();
+				if(tag.hasAttribute("storePresets"))
+					readBoolAttribute(tag, "storePresets", &prefs.storePresets);
+				xmlToStringList(p_pres, "recentstatus", &prefs.recentStatus);
+			}
 		}
 
 		QDomElement p_lnf = findSubTag(p, "lookandfeel", &found);
diff -urN psi-old/src/statusdlg.cpp psi/src/statusdlg.cpp
--- psi-old/src/statusdlg.cpp	2004-02-18 16:45:00.699122760 +0100
+++ psi/src/statusdlg.cpp	2004-02-18 16:46:26.792034648 +0100
@@ -72,6 +72,8 @@
 public:
 	Private() {}
 
+	int recentNum;
+	QString newStatus;
 	PsiCon *psi;
 	PsiAccount *pa;
 	Status s;
@@ -88,6 +90,7 @@
 	d->pa = 0;
 	d->psi->dialogRegister(this);
 	d->s = s;
+	d->recentNum = -1;
 
 	setCaption(CAP(tr("Set Status: All accounts")));
 	init();
@@ -101,6 +104,7 @@
 	d->pa = pa;
 	d->pa->dialogRegister(this);
 	d->s = s;
+	d->recentNum = -1;
 
 	setCaption(CAP(tr("Set Status: %1").arg(d->pa->name())));
 	init();
@@ -159,6 +163,8 @@
 	d->te->setTextFormat(PlainText);
 	d->te->setText(d->s.status());
 	d->te->selectAll();
+	d->te->installEventFilter( this );
+	d->newStatus = d->te->text();
 	connect(pb1, SIGNAL(clicked()), SLOT(doButton()));
 	connect(pb2, SIGNAL(clicked()), SLOT(cancel()));
 	d->te->setFocus();
@@ -185,6 +191,37 @@
 		e->ignore();
 }
 
+bool StatusSetDlg::eventFilter( QObject *o, QEvent *e )
+{
+	if ( e->type() == QEvent::KeyPress ) {
+		QKeyEvent *ke = (QKeyEvent*)e;
+		if(ke->key() == Key_Up && (ke->state() & AltButton) )
+			return historySelect(-1);
+		else if(ke->key() == Key_Down && (ke->state() & AltButton) )
+			return historySelect(1);
+	}
+	return FALSE; 
+}
+
+bool StatusSetDlg::historySelect(int offs)
+{
+	// d->recentNum == -1 is new status (not saved yet)
+	if(d->recentNum == -1 && offs > 0)
+		d->newStatus = d->te->text();
+	else if(d->recentNum == 0 && offs < 0){
+		d->te->setText(d->newStatus);
+		d->recentNum += offs;
+		return TRUE;
+	}
+
+	if((d->recentNum + offs < 0) || (d->recentNum + offs >= (int)option.recentStatus.count()))
+		return FALSE;
+
+	d->recentNum += offs;
+	d->te->setText(option.recentStatus[d->recentNum]);	
+	return TRUE;
+}
+
 void StatusSetDlg::doButton()
 {
 	// Save preset
@@ -220,6 +257,17 @@
 	int type = combomap[d->cb_type->currentItem()];
 	QString str = d->te->text();
 
+	// save recent if not saved yet else bring to front
+	if(!str.isEmpty()){
+		option.recentStatus.remove(str);
+		// if status is from preset, don't save it unless storePresets = "true" (config.xml)
+		if(option.storePresets || option.sp.findByData(str) == option.sp.end())
+			option.recentStatus.push_front(str);
+	}
+	// trim 
+	if((int)option.recentStatus.size() > option.recentStatusLimit)
+		option.recentStatus.pop_back();
+	
 	set(makeStatus(type, str));
 	close();
 }
diff -urN psi-old/src/statusdlg.h psi/src/statusdlg.h
--- psi-old/src/statusdlg.h	2004-02-18 16:45:00.511151336 +0100
+++ psi/src/statusdlg.h	2004-02-18 16:46:26.824029784 +0100
@@ -47,6 +47,8 @@
 
 protected:
 	void keyPressEvent(QKeyEvent *);
+	bool eventFilter(QObject *, QEvent *);
+	bool historySelect(int);
 
 signals:
 	void set(const Status &);
diff -urN psi-old/src/varlist.cpp psi/src/varlist.cpp
--- psi-old/src/varlist.cpp	2004-02-18 16:45:00.622134464 +0100
+++ psi/src/varlist.cpp	2004-02-18 16:46:26.856024920 +0100
@@ -105,6 +105,17 @@
 	return it;
 }
 
+VarList::Iterator VarList::findByData(const QString &data)
+{
+	VarList::Iterator it;
+	for(it = begin(); it != end(); ++it) {
+		if((*it).data() == data)
+			break;
+	}
+
+	return it;
+}
+
 VarList::Iterator VarList::findByNum(int x)
 {
 	int n = 0;
diff -urN psi-old/src/varlist.h psi/src/varlist.h
--- psi-old/src/varlist.h	2004-02-18 16:45:00.623134312 +0100
+++ psi/src/varlist.h	2004-02-18 16:46:26.886020360 +0100
@@ -53,6 +53,7 @@
 	const QString & get(const QString &);
 
 	VarList::Iterator findByKey(const QString &);
+	VarList::Iterator findByData(const QString &);
 	VarList::Iterator findByNum(int);
 
 	QStringList varsToStringList();

--- NEW FILE: psi-status_indicator-cvs.patch ---
diff -ru -X exclude ../../iris-clean/xmpp-im/client.cpp ../../iris/xmpp-im/client.cpp
--- ../../iris-clean/xmpp-im/client.cpp	Tue Feb 24 19:45:40 2004
+++ ../../iris/xmpp-im/client.cpp	Thu Apr 15 07:05:08 2004
@@ -792,10 +792,27 @@
 
 	// unavailable?  remove the resource
 	if(!s.isAvailable()) {
-		if(found) {
-			(*rit).setStatus(s);
-			debug(QString("Client: Removing resource from [%1]: name=[%2]\n").arg(i->jid().full()).arg(j.resource()));
-			resourceUnavailable(j, *rit);
+		Resource r;
+		if(!found) {
+			//if (!s.status().isEmpty()) {
+				r = Resource(j.resource(), s);
+				i->resourceList() += r;
+				debug(QString("Client: Adding resource to [%1]: name=[%2]\n").arg(i->jid().full()).arg(j.resource()));
+				resourceAvailable(j, r);
+		} 
+		else {
+				(*rit).setStatus(s);
+				r = *rit;
+				debug(QString("Client: Updating resource to [%1]: name=[%2]\n").arg(i->jid().full()).arg(j.resource()));
+				resourceAvailable(j, r);			
+		}
+		
+		rit = i->resourceList().find(j.resource());
+		found = (rit == i->resourceList().end()) ? false: true;
+		
+ 		if(found) {
+ 			(*rit).setStatus(s);
+ 			debug(QString("Client: Removing resource from [%1]: name=[%2]\n").arg(i->jid().full()).arg(j.resource())); 	resourceUnavailable(j, *rit);
 			i->resourceList().remove(rit);
 			i->setLastUnavailableStatus(s);
 		}
diff -ru -X exclude psi-clean/src/chatdlg.cpp psi/src/chatdlg.cpp
--- psi-clean/src/chatdlg.cpp	Thu Apr 01 09:44:42 2004
+++ psi/src/chatdlg.cpp	Thu Apr 15 07:05:08 2004
@@ -366,8 +366,10 @@
 			u = ul.first();
 			if(rname.isEmpty()) {
 				// use priority
-				if(!u->isAvailable())
+				if(!u->isAvailable()){
 					status = STATUS_OFFLINE;
+					statusString = u->lastUnavailableStatus().status();
+				}
 				else {
 					const UserResource &r = *u->userResourceList().priority();
 					status = makeSTATUS(r.status());
diff -ru -X exclude psi-clean/src/common.h psi/src/common.h
--- psi-clean/src/common.h	Thu Mar 04 22:04:00 2004
+++ psi/src/common.h	Thu Apr 15 07:05:08 2004
@@ -138,6 +138,7 @@
 	QStringList gcHighlights, gcNickColors;
 
 	bool clNewHeadings;
+	bool clStIndicator;
 
 	// passive popups
 	bool ppIsOn;
diff -ru -X exclude psi-clean/src/contactview.cpp psi/src/contactview.cpp
--- psi-clean/src/contactview.cpp	Sun Mar 21 15:45:20 2004
+++ psi/src/contactview.cpp	Thu Apr 15 08:30:14 2004
@@ -25,6 +25,7 @@
 #include<qheader.h>
 #include<qtimer.h>
 #include<qpainter.h>
+#include<qbitmap.h>
 #include<qpopupmenu.h>
 #include<qmessagebox.h>
 #include<qinputdialog.h>
@@ -2652,12 +2751,13 @@
 
 void ContactViewItem::setIcon(const Icon *icon, bool alert)
 {
+	/* needed by status indicator :o|
 	if ( d->lastIcon == icon ) {
 		return; // cause less flicker. but still have to run calltree valgring skin on psi while online (mblsha).
 	}
 	else
 		d->lastIcon = (Icon *)icon;
-
+	*/
 	if ( d->icon ) {
 		disconnect(d->icon, 0, this, 0 );
 		d->icon->stop();
@@ -2679,12 +2779,42 @@
 		pix = d->icon->pixmap();
 	}
 
-	setPixmap(0, pix);
+	iconUpdated(pix);
 }
 
 void ContactViewItem::iconUpdated(const QPixmap &pix)
 {
-	setPixmap(0, pix);
+	QPixmap out(pix);
+	// add status indicator to contact icon
+	if(d->u && !out.isNull()){
+		bool ind = false;
+		if(!d->u->userResourceList().isEmpty() && option.clStIndicator) {
+			UserResourceList srl = d->u->userResourceList();
+
+			for(UserResourceList::ConstIterator rit = srl.begin(); rit != srl.end(); ++rit)
+				if(!(*rit).status().status().isEmpty()) { ind = true; break; }
+			
+		} 
+		else if(!d->u->lastUnavailableStatus().status().isEmpty() && option.clStIndicator)
+			ind = true;
+
+		if(ind) {
+			const QPixmap &ipix = is->indicator(d->u->jid()).pixmap();
+			// sum masks
+			if(out.hasAlpha() && ipix.hasAlpha()){
+				QBitmap mask(*out.mask());
+				const QBitmap* imask = ipix.mask();
+				bitBlt(&mask, (mask.width() - imask->width())/2, (mask.height() - imask->height())/2, 
+					imask, 0, 0, imask->width(), imask->height(), 
+					Qt::OrROP);
+				out.setMask(mask);
+			}
+			bitBlt(&out, (out.width() - ipix.width())/2, (out.height() - ipix.height())/2, 
+				&ipix, 0, 0, ipix.width(), ipix.height(), 
+				Qt::CopyROP);
+		}
+	}
+	setPixmap(0, out);
 }
 
 void ContactViewItem::animateNick()
diff -ru -X exclude psi-clean/src/options/opt_appearance-ui.ui psi/src/options/opt_appearance-ui.ui
--- psi-clean/src/options/opt_appearance-ui.ui	Thu Dec 11 16:44:18 2003
+++ psi/src/options/opt_appearance-ui.ui	Thu Apr 15 07:05:08 2004
@@ -30,6 +30,14 @@
                 <string>Small group headings in roster</string>
             </property>
         </widget>
+        <widget class="QCheckBox">
+            <property name="name">
+                <cstring>ck_statusIndicator</cstring>
+            </property>
+            <property name="text">
+                <string>Show indicator for text statuses</string>
+            </property>
+        </widget>
         <widget class="QGroupBox">
             <property name="name">
                 <cstring>groupBox11</cstring>
diff -ru -X exclude psi-clean/src/options/opt_appearance.cpp psi/src/options/opt_appearance.cpp
--- psi-clean/src/options/opt_appearance.cpp	Tue Dec 02 14:28:58 2003
+++ psi/src/options/opt_appearance.cpp	Thu Apr 15 07:05:08 2004
@@ -112,6 +112,9 @@
 	QWhatsThis::add(d->pb_cAnimBack,
 		tr("Specifies the background animation color for nicks."));
 
+	QWhatsThis::add(d->ck_statusIndicator,
+		tr("Displays an indicator by the contact name if the contact entered a descriptive text status line."));
+
 	QWhatsThis::add(d->ck_newHeadings,
 		tr("Toggles on new, smaller group headings."));
 
@@ -125,6 +128,7 @@
 
 	OptAppearanceUI *d = (OptAppearanceUI *)w;
 	opt->clNewHeadings = d->ck_newHeadings->isChecked();
+	opt->clStIndicator = d->ck_statusIndicator->isChecked();
 
 	int n;
 	for (n = 0; n < 3; ++n)
@@ -141,6 +145,7 @@
 
 	OptAppearanceUI *d = (OptAppearanceUI *)w;
 	d->ck_newHeadings->setChecked( opt->clNewHeadings );
+	d->ck_statusIndicator->setChecked( opt->clStIndicator );
 
 	int n;
 	for (n = 0; n < 3; ++n)
diff -ru -X exclude psi-clean/src/psiiconset.cpp psi/src/psiiconset.cpp
--- psi-clean/src/psiiconset.cpp	Sun Jan 25 14:52:04 2004
+++ psi/src/psiiconset.cpp	Thu Apr 15 07:05:08 2004
@@ -510,6 +510,19 @@
 	return Icon();
 }
 
+Icon *PsiIconset::indicatorPtr(const XMPP::Jid &jid)
+{
+	return d->jid2icon(jid, "psi/statInd");
+}
+
+Icon PsiIconset::indicator(const XMPP::Jid &jid)
+{
+	Icon *icon = indicatorPtr(jid);
+	if ( icon )
+		return *icon;
+	return Icon();
+}
+
 Icon *PsiIconset::statusPtr(const XMPP::Jid &jid, int s)
 {
 	return d->jid2icon(jid, status2name(s));
diff -ru -X exclude psi-clean/src/psiiconset.h psi/src/psiiconset.h
--- psi-clean/src/psiiconset.h	Sat Nov 22 07:47:10 2003
+++ psi/src/psiiconset.h	Thu Apr 15 07:05:08 2004
@@ -61,9 +61,11 @@
 	// JID-enabled status functions
 	Icon *statusPtr(const XMPP::Jid &, int);
 	Icon *statusPtr(const XMPP::Jid &, const XMPP::Status &);
+	Icon *indicatorPtr(const XMPP::Jid &);
 
 	Icon status(const XMPP::Jid &, int);
 	Icon status(const XMPP::Jid &, const XMPP::Status &);
+	Icon indicator(const XMPP::Jid &);
 
 	// functions to get status icon by transport name
 	Icon *transportStatusPtr(QString name, int);
diff -ru -X exclude psi-clean/src/psi_profiles.cpp psi/src/psi_profiles.cpp
--- psi-clean/src/psi_profiles.cpp	Sun Mar 21 15:47:06 2004
+++ psi/src/psi_profiles.cpp	Thu Apr 15 07:05:08 2004
@@ -423,6 +423,8 @@
 		prefs.font[fPopup] = font.toString();
 	}
 
+	prefs.clStIndicator = TRUE;
+
 	// calculate the small font size
 	const int minimumFontSize = 7;
 	prefs.smallFontSize = qApp->font().pointSize();
@@ -774,6 +776,7 @@
 		p.appendChild(p_lnf);
 
 		p_lnf.appendChild(textTag(doc, "newHeadings", prefs.clNewHeadings));
+		p_lnf.appendChild(textTag(doc, "statusIndicator", prefs.clStIndicator));
 
 		{
 			QDomElement tag = doc.createElement("colors");
@@ -1258,6 +1261,7 @@
 			bool found;
 
 			readBoolEntry(p_lnf, "newHeadings", &prefs.clNewHeadings);
+			readBoolEntry(p_lnf, "statusIndicator", &prefs.clStIndicator);
 
 			QDomElement tag = findSubTag(p_lnf, "colors", &found);
 			if(found) {
diff -ruN psi.orig/iconsets/roster/default/icondef.xml psi/iconsets/roster/default/icondef.xml
--- psi.orig/iconsets/roster/default/icondef.xml	2004-04-22 21:49:53.000000000 +0200
+++ psi/iconsets/roster/default/icondef.xml	2004-05-06 20:32:33.000000000 +0200
@@ -62,6 +62,11 @@
 		<object mime='image/png'>perr.png</object>
 	</icon>
 
+	<icon>
+		<x xmlns='name'>psi/statInd</x>
+		<object mime='image/png'>indicator.png</object>
+	</icon>
+
 	<!-- Special icons -->
 	<icon>
 		<x xmlns='name'>psi/chat</x>

--- NEW FILE: psi-status_indicator.patch ---
diff -ru -X exclude ../iris-clean/xmpp-im/client.cpp ../iris/xmpp-im/client.cpp
--- ../iris-clean/xmpp-im/client.cpp	Tue Feb 24 19:45:40 2004
+++ ../iris/xmpp-im/client.cpp	Thu Apr 15 07:05:08 2004
@@ -792,10 +792,27 @@
 
 	// unavailable?  remove the resource
 	if(!s.isAvailable()) {
-		if(found) {
-			(*rit).setStatus(s);
-			debug(QString("Client: Removing resource from [%1]: name=[%2]\n").arg(i->jid().full()).arg(j.resource()));
-			resourceUnavailable(j, *rit);
+		Resource r;
+		if(!found) {
+			//if (!s.status().isEmpty()) {
+				r = Resource(j.resource(), s);
+				i->resourceList() += r;
+				debug(QString("Client: Adding resource to [%1]: name=[%2]\n").arg(i->jid().full()).arg(j.resource()));
+				resourceAvailable(j, r);
+		} 
+		else {
+				(*rit).setStatus(s);
+				r = *rit;
+				debug(QString("Client: Updating resource to [%1]: name=[%2]\n").arg(i->jid().full()).arg(j.resource()));
+				resourceAvailable(j, r);			
+		}
+		
+		rit = i->resourceList().find(j.resource());
+		found = (rit == i->resourceList().end()) ? false: true;
+		
+ 		if(found) {
+ 			(*rit).setStatus(s);
+ 			debug(QString("Client: Removing resource from [%1]: name=[%2]\n").arg(i->jid().full()).arg(j.resource())); 	resourceUnavailable(j, *rit);
 			i->resourceList().remove(rit);
 			i->setLastUnavailableStatus(s);
 		}
diff -ru -X exclude psi-clean/src/chatdlg.cpp psi/src/chatdlg.cpp
--- psi-clean/src/chatdlg.cpp	Thu Apr 01 09:44:42 2004
+++ psi/src/chatdlg.cpp	Thu Apr 15 07:05:08 2004
@@ -366,8 +366,10 @@
 			u = ul.first();
 			if(rname.isEmpty()) {
 				// use priority
-				if(!u->isAvailable())
+				if(!u->isAvailable()){
 					status = STATUS_OFFLINE;
+					statusString = u->lastUnavailableStatus().status();
+				}
 				else {
 					const UserResource &r = *u->userResourceList().priority();
 					status = makeSTATUS(r.status());
diff -ru -X exclude psi-clean/src/common.h psi/src/common.h
--- psi-clean/src/common.h	Thu Mar 04 22:04:00 2004
+++ psi/src/common.h	Thu Apr 15 07:05:08 2004
@@ -138,6 +138,7 @@
 	QStringList gcHighlights, gcNickColors;
 
 	bool clNewHeadings;
+	bool clStIndicator;
 
 	// passive popups
 	bool ppIsOn;
diff -ru -X exclude psi-clean/src/contactview.cpp psi/src/contactview.cpp
--- psi-clean/src/contactview.cpp	Sun Mar 21 15:45:20 2004
+++ psi/src/contactview.cpp	Thu Apr 15 08:30:14 2004
@@ -25,6 +25,7 @@
 #include<qheader.h>
 #include<qtimer.h>
 #include<qpainter.h>
+#include<qbitmap.h>
 #include<qpopupmenu.h>
 #include<qmessagebox.h>
 #include<qinputdialog.h>
@@ -2652,12 +2751,13 @@
 
 void ContactViewItem::setIcon(const Icon *icon, bool alert)
 {
+	/* needed by status indicator :o|
 	if ( d->lastIcon == icon ) {
 		return; // cause less flicker. but still have to run calltree valgring skin on psi while online (mblsha).
 	}
 	else
 		d->lastIcon = (Icon *)icon;
-
+	*/
 	if ( d->icon ) {
 		disconnect(d->icon, 0, this, 0 );
 		d->icon->stop();
@@ -2679,12 +2779,42 @@
 		pix = d->icon->pixmap();
 	}
 
-	setPixmap(0, pix);
+	iconUpdated(pix);
 }
 
 void ContactViewItem::iconUpdated(const QPixmap &pix)
 {
-	setPixmap(0, pix);
+	QPixmap out(pix);
+	// add status indicator to contact icon
+	if(d->u && !out.isNull()){
+		bool ind = false;
+		if(!d->u->userResourceList().isEmpty() && option.clStIndicator) {
+			UserResourceList srl = d->u->userResourceList();
+
+			for(UserResourceList::ConstIterator rit = srl.begin(); rit != srl.end(); ++rit)
+				if(!(*rit).status().status().isEmpty()) { ind = true; break; }
+			
+		} 
+		else if(!d->u->lastUnavailableStatus().status().isEmpty() && option.clStIndicator)
+			ind = true;
+
+		if(ind) {
+			const QPixmap &ipix = is->indicator(d->u->jid()).pixmap();
+			// sum masks
+			if(out.hasAlpha() && ipix.hasAlpha()){
+				QBitmap mask(*out.mask());
+				const QBitmap* imask = ipix.mask();
+				bitBlt(&mask, (mask.width() - imask->width())/2, (mask.height() - imask->height())/2, 
+					imask, 0, 0, imask->width(), imask->height(), 
+					Qt::OrROP);
+				out.setMask(mask);
+			}
+			bitBlt(&out, (out.width() - ipix.width())/2, (out.height() - ipix.height())/2, 
+				&ipix, 0, 0, ipix.width(), ipix.height(), 
+				Qt::CopyROP);
+		}
+	}
+	setPixmap(0, out);
 }
 
 void ContactViewItem::animateNick()
diff -ru -X exclude psi-clean/src/options/opt_appearance-ui.ui psi/src/options/opt_appearance-ui.ui
--- psi-clean/src/options/opt_appearance-ui.ui	Thu Dec 11 16:44:18 2003
+++ psi/src/options/opt_appearance-ui.ui	Thu Apr 15 07:05:08 2004
@@ -30,6 +30,14 @@
                 <string>Small group headings in roster</string>
             </property>
         </widget>
+        <widget class="QCheckBox">
+            <property name="name">
+                <cstring>ck_statusIndicator</cstring>
+            </property>
+            <property name="text">
+                <string>Show indicator for text statuses</string>
+            </property>
+        </widget>
         <widget class="QGroupBox">
             <property name="name">
                 <cstring>groupBox11</cstring>
diff -ru -X exclude psi-clean/src/options/opt_appearance.cpp psi/src/options/opt_appearance.cpp
--- psi-clean/src/options/opt_appearance.cpp	Tue Dec 02 14:28:58 2003
+++ psi/src/options/opt_appearance.cpp	Thu Apr 15 07:05:08 2004
@@ -112,6 +112,9 @@
 	QWhatsThis::add(d->pb_cAnimBack,
 		tr("Specifies the background animation color for nicks."));
 
+	QWhatsThis::add(d->ck_statusIndicator,
+		tr("Displays an indicator by the contact name if the contact entered a descriptive text status line."));
+
 	QWhatsThis::add(d->ck_newHeadings,
 		tr("Toggles on new, smaller group headings."));
 
@@ -125,6 +128,7 @@
 
 	OptAppearanceUI *d = (OptAppearanceUI *)w;
 	opt->clNewHeadings = d->ck_newHeadings->isChecked();
+	opt->clStIndicator = d->ck_statusIndicator->isChecked();
 
 	int n;
 	for (n = 0; n < 3; ++n)
@@ -141,6 +145,7 @@
 
 	OptAppearanceUI *d = (OptAppearanceUI *)w;
 	d->ck_newHeadings->setChecked( opt->clNewHeadings );
+	d->ck_statusIndicator->setChecked( opt->clStIndicator );
 
 	int n;
 	for (n = 0; n < 3; ++n)
diff -ru -X exclude psi-clean/src/psiiconset.cpp psi/src/psiiconset.cpp
--- psi-clean/src/psiiconset.cpp	Sun Jan 25 14:52:04 2004
+++ psi/src/psiiconset.cpp	Thu Apr 15 07:05:08 2004
@@ -510,6 +510,19 @@
 	return Icon();
 }
 
+Icon *PsiIconset::indicatorPtr(const XMPP::Jid &jid)
+{
+	return d->jid2icon(jid, "psi/statInd");
+}
+
+Icon PsiIconset::indicator(const XMPP::Jid &jid)
+{
+	Icon *icon = indicatorPtr(jid);
+	if ( icon )
+		return *icon;
+	return Icon();
+}
+
 Icon *PsiIconset::statusPtr(const XMPP::Jid &jid, int s)
 {
 	return d->jid2icon(jid, status2name(s));
diff -ru -X exclude psi-clean/src/psiiconset.h psi/src/psiiconset.h
--- psi-clean/src/psiiconset.h	Sat Nov 22 07:47:10 2003
+++ psi/src/psiiconset.h	Thu Apr 15 07:05:08 2004
@@ -61,9 +61,11 @@
 	// JID-enabled status functions
 	Icon *statusPtr(const XMPP::Jid &, int);
 	Icon *statusPtr(const XMPP::Jid &, const XMPP::Status &);
+	Icon *indicatorPtr(const XMPP::Jid &);
 
 	Icon status(const XMPP::Jid &, int);
 	Icon status(const XMPP::Jid &, const XMPP::Status &);
+	Icon indicator(const XMPP::Jid &);
 
 	// functions to get status icon by transport name
 	Icon *transportStatusPtr(QString name, int);
diff -ru -X exclude psi-clean/src/psi_profiles.cpp psi/src/psi_profiles.cpp
--- psi-clean/src/psi_profiles.cpp	Sun Mar 21 15:47:06 2004
+++ psi/src/psi_profiles.cpp	Thu Apr 15 07:05:08 2004
@@ -423,6 +423,8 @@
 		prefs.font[fPopup] = font.toString();
 	}
 
+	prefs.clStIndicator = TRUE;
+
 	// calculate the small font size
 	const int minimumFontSize = 7;
 	prefs.smallFontSize = qApp->font().pointSize();
@@ -774,6 +776,7 @@
 		p.appendChild(p_lnf);
 
 		p_lnf.appendChild(textTag(doc, "newHeadings", prefs.clNewHeadings));
+		p_lnf.appendChild(textTag(doc, "statusIndicator", prefs.clStIndicator));
 
 		{
 			QDomElement tag = doc.createElement("colors");
@@ -1258,6 +1261,7 @@
 			bool found;
 
 			readBoolEntry(p_lnf, "newHeadings", &prefs.clNewHeadings);
+			readBoolEntry(p_lnf, "statusIndicator", &prefs.clStIndicator);
 
 			QDomElement tag = findSubTag(p_lnf, "colors", &found);
 			if(found) {
diff -ruN psi.orig/iconsets/roster/default/icondef.xml psi/iconsets/roster/default/icondef.xml
--- psi.orig/iconsets/roster/default/icondef.xml	2004-04-22 21:49:53.000000000 +0200
+++ psi/iconsets/roster/default/icondef.xml	2004-05-06 20:32:33.000000000 +0200
@@ -62,6 +62,11 @@
 		<object mime='image/png'>perr.png</object>
 	</icon>
 
+	<icon>
+		<x xmlns='name'>psi/statInd</x>
+		<object mime='image/png'>indicator.png</object>
+	</icon>
+
 	<!-- Special icons -->
 	<icon>
 		<x xmlns='name'>psi/chat</x>

--- NEW FILE: psi-translations.pw.patch ---
diff -u src/main.cpp.orig src/main.cpp
--- src/main.cpp.orig	2002-10-30 11:09:34.000000000 +0100
+++ src/main.cpp	2003-03-15 17:59:59.000000000 +0100
@@ -55,7 +55,7 @@
 	}
 
 	QStringList dirs;
-	QString subdir = "";
+	QString subdir = "/translations";
 	dirs += "." + subdir;
 	dirs += g.pathHome + subdir;
 	dirs += g.pathBase + subdir;
@@ -121,7 +121,7 @@
 	langs.set("en", "English");
 
 	QStringList dirs;
-	QString subdir = "";
+	QString subdir = "/translations";
 	dirs += "." + subdir;
 	dirs += g.pathHome + subdir;
 	dirs += g.pathBase + subdir;

--- NEW FILE: psi.pwbuild ---
#!/bin/sh

name="psi"
version="0.9.2"
build="1"

_pwbuilder 0.6.3

_doc -d libpsi/iconset/ICONSET-HOWTO

_source -m e29f90aea7d839f2a70e4a6e77e95a70 -s 1154392 -f

_patch -p 0 translations
_patch no_online_status
_patch no_default_status_text
_patch status_history
_patch status_indicator
_patch offline_status

_have_libmng && _patch enable-mng

_c_opt --prefix=/usr

_configure

( cd ${src1}/src ; qmake -o Makefile )
_qconf_fix ${src1}/src/Makefile

# If you get a 'double const' error, uncomment these lines:
#
# sed "s}\$(QTDIR)/bin/uic}${src}/uic-wrapper}" ${src1}/src/Makefile > ${tmp}/uicfix
# cat ${tmp}/uicfix > ${src1}/src/Makefile

_patch opt

_make
_install

rm ${pkg}/usr/share/psi/{COPYING,README}
ln -s ${docdir}/COPYING ${pkg}/usr/share/psi
ln -s ${docdir}/README ${pkg}/usr/share/psi

# $Log: psi.pwbuild,v $
# Revision 1.1  2004/07/30 20:34:54  swiergot
# - Initial commit.
# - Version 0.9.2/20040730.
#

--- NEW FILE: psi.pwinfo ---
info="A Jabber client for X Window."
desc="Psi is the premiere Instant Messaging application designed for Microsoft Windows, Apple Mac OS X and GNU/Linux. Built upon an open protocol named Jabber, Psi is a fast and lightweight messaging client that utilises the best in open source technologies.
Psi contains all the features necessary to chat, with no bloated extras that slow your computer down."

--- NEW FILE: uic-wrapper ---
#!/bin/sh

/usr/lib/qt/bin/uic "$@"
ret=$?

if [ $ret -gt 0 ]; then
	exit $ret
fi

while [ $# -gt 0 ]; do
	if [ "$1" = "-o" ]; then
		of="$2"
		break;
	fi
	shift
done

sed 's}static const unsigned char const}static const unsigned char}' $of > ${tmp}/uic-wrapper.tmp
cat ${tmp}/uic-wrapper.tmp > $of



From nobody at sheep.berlios.de  Fri Jul 30 22:36:17 2004
From: nobody at sheep.berlios.de (swiergot)
Date: Fri, 30 Jul 2004 22:36:17 +0200
Subject: [Packware-cvs] pwbuild/ap - New directory
Message-ID: <200407302036.i6UKaH622539@bat.berlios.de>

Update of /cvsroot/packware/pwbuild/ap
In directory sheep:/tmp/cvs-serv3124/ap

Log Message:
Directory /cvsroot/packware/pwbuild/ap added to the repository




From nobody at sheep.berlios.de  Fri Jul 30 22:58:20 2004
From: nobody at sheep.berlios.de (swiergot)
Date: Fri, 30 Jul 2004 22:58:20 +0200
Subject: [Packware-cvs] pwbuild/l - New directory
Message-ID: <200407302058.i6UKwK623101@bat.berlios.de>

Update of /cvsroot/packware/pwbuild/l
In directory sheep:/tmp/cvs-serv4239/l

Log Message:
Directory /cvsroot/packware/pwbuild/l added to the repository




From nobody at sheep.berlios.de  Fri Jul 30 22:58:32 2004
From: nobody at sheep.berlios.de (swiergot)
Date: Fri, 30 Jul 2004 22:58:32 +0200
Subject: [Packware-cvs] pwbuild/l/gpgme - New directory
Message-ID: <200407302058.i6UKwW623113@bat.berlios.de>

Update of /cvsroot/packware/pwbuild/l/gpgme
In directory sheep:/tmp/cvs-serv4264/gpgme

Log Message:
Directory /cvsroot/packware/pwbuild/l/gpgme added to the repository




From nobody at sheep.berlios.de  Fri Jul 30 22:58:58 2004
From: nobody at sheep.berlios.de (swiergot)
Date: Fri, 30 Jul 2004 22:58:58 +0200
Subject: [Packware-cvs] pwbuild/l/gpgme gpgme.pwbuild,NONE,1.1 gpgme.pwinfo,NONE,1.1
Message-ID: <200407302058.i6UKww623125@bat.berlios.de>

Update of /cvsroot/packware/pwbuild/l/gpgme
In directory sheep:/tmp/cvs-serv4316

Added Files:
	gpgme.pwbuild gpgme.pwinfo 
Log Message:
- Initial commit.
- Version 0.3.16.


--- NEW FILE: gpgme.pwbuild ---
#!/bin/sh

name="gpgme"
version="0.3.16"
build="1"

_pwbuilder 0.6.3

_doc -d

_source -m 0476b219695ea25cb2a97b18b717e381 -s 679430 -g ftp://ftp.gnupg.org/gcrypt/${name}/

_c_opt --prefix=/usr

_cmi

# $Log: gpgme.pwbuild,v $
# Revision 1.1  2004/07/30 20:58:55  swiergot
# - Initial commit.
# - Version 0.3.16.
#

--- NEW FILE: gpgme.pwinfo ---
info="A C wrapper library for GnuPG."
desc="GnuPG Made Easy (GPGME) is a library designed to make access to GnuPG easier for applications. It provides a high-level cryptography API for encryption, decryption, signing, signature verification, and key management. It currently uses GnuPG as its backend, but the API is not restricted to this engine. In fact, support for other backends is planned."



From nobody at sheep.berlios.de  Sat Jul 31 14:12:52 2004
From: nobody at sheep.berlios.de (swiergot)
Date: Sat, 31 Jul 2004 14:12:52 +0200
Subject: [Packware-cvs] pwutils - New directory
Message-ID: <200407311212.i6VCCq611734@bat.berlios.de>

Update of /cvsroot/packware/pwutils
In directory sheep:/tmp/cvs-serv5270/pwutils

Log Message:
Directory /cvsroot/packware/pwutils added to the repository




From nobody at sheep.berlios.de  Sat Jul 31 14:14:42 2004
From: nobody at sheep.berlios.de (swiergot)
Date: Sat, 31 Jul 2004 14:14:42 +0200
Subject: [Packware-cvs] pwutils Makefile,NONE,1.1 VERSION,NONE,1.1 clearpath.c,NONE,1.1 desc.c,NONE,1.1 getsfmirror.c,NONE,1.1 sltd.c,NONE,1.1 sltm.c,NONE,1.1 spn.c,NONE,1.1 tod.c,NONE,1.1
Message-ID: <200407311214.i6VCEg611755@bat.berlios.de>

Update of /cvsroot/packware/pwutils
In directory sheep:/tmp/cvs-serv5376

Added Files:
	Makefile VERSION clearpath.c desc.c getsfmirror.c sltd.c 
	sltm.c spn.c tod.c 
Log Message:
- Initial commit.
- Version 0.7.


--- NEW FILE: Makefile ---
CC = gcc
STRIP = strip
RM = rm -f

CFLAGS = -Wall -O2 -g -fomit-frame-pointer
LDFLAGS = 

TARGET = clearpath desc getsfmirror sltd sltm spn tod

all: $(TARGET)

$(TARGET):
	$(CC) $(CFLAGS) $(LDFLAGS) $@.c -o $@

strip: $(TARGET)
	$(STRIP) $(TARGET)

clean:
	$(RM) $(TARGET)

--- NEW FILE: VERSION ---
0.7

--- NEW FILE: clearpath.c ---
/*
 * clearpath - clear path from doubled slashes
 * Copyright (c) 2003 Jaroslaw Swierczynski <swiergot at intersec.pl>
 * Distributed under the terms of GNU GPL version 2 or any later version.
 */

#include <stdio.h>
#include <stdlib.h>
#include <string.h>

#define CLEARPATH "0.1"

int main(int argc, char *argv[])
{
	int i = 0, j = 0, c, slash = 0;
	char *path, *temp;

	if (argc != 2)
	{
		fprintf(stderr, "clearpath %s: usage: %s path\n", CLEARPATH, argv[0]);
		return 1;
	}

	path = (char *) malloc(strlen (argv[1]) + 1);
	strcpy(path, argv[1]);
	temp = (char *) malloc(strlen (path) + 1);
	strcpy(temp, path);

	while ((c = path[i++]) != '\0')
	{
		if (c == '/')
		{
			if (slash)
				continue;
			else
				slash = 1;
		}
		else
			slash = 0;
		temp[j++] = c;
	}
	if (temp[j - 1] == '/' && j - 1 > 0)
		temp[j - 1] = '\0';
	else
		temp[j] = '\0';
	printf("%s\n", temp);
	free(path);
	free(temp);

	return 0;

}

--- NEW FILE: desc.c ---
/*
 * desc - format text in style of slack-desc files
 * Copyright (c) 2003 Jaroslaw Swierczynski <swiergot at intersec.pl>
 * Distributed under the terms of GNU GPL version 2 or any later version.
 */

#include <stdio.h>
#include <string.h>

#define DESC "0.1"

#define LINEL 70
#define BUFL 80
#define LINES 9

int main(int argc, char *argv[])
{
	char buf[BUFL];
	char word[LINEL];
	int s, n, i, l, w, f, e;
	size_t r;

	if (argc < 2)
	{
		fprintf(stderr, "desc %s: usage: %s package\n", DESC, argv[0]);
		return 1;
	}

	s = sizeof(*buf);
	n = sizeof(buf);
	l = w = e = 0;
	f = 1;

	while ((r = fread(buf, s, n, stdin)))
		for (i = 0; i < r; ++i)
		{
			if (buf[i] == '\n')
			{
				word[w] = '\0';
				if (l + 1 + w > LINEL)
					printf("\n%s: %s\n", argv[1], word);
				else
					if (f)
						printf("%s: ", argv[1]);
					else
						fputc(' ', stdout);
					printf("%s\n", word);
				l = w = 0;
				f = 1;
				e += 1;
				continue;
			}
			if (buf[i] == ' ')
			{
				word[w] = '\0';
				if (l + 1 + w > LINEL)
				{
					printf("\n%s: %s", argv[1], word);
					l = w;
					e += 1;
				}
				else
				{
					if (f)
						printf("%s: ", argv[1]);
					else
						fputc(' ', stdout);
					printf ("%s", word);
					l += 1 + w;
				}
				w = f = 0;
				continue;
			}
			word[w++] = buf[i];
		}
	for (i = e; i < LINES; ++i)
		printf("%s:\n", argv[1]);

	return 0;
}

--- NEW FILE: getsfmirror.c ---
/*
 * getsfmirror 0.2 - Get best dl.sourceforge.net mirror
 * Copyright (c) 2003 Jaroslaw Swierczynski <swiergot at intersec.pl>
 * Distributed under the terms of GNU GPL version 2 or any later version.
 */

#include <netdb.h> 
#include <stdio.h>

#define DLSFNET		"dl.sourceforge.net"

#define ALERON		0xe5039dcc /* 204.157.3.22	*/
#define BELNET		0x61c6bec1 /* 193.190.198.97	*/
#define CESNET		0x58a171c3 /* 195.113.161.88	*/
#define EASYNEWS	0x1e66638c /* 140.99.102.30	*/
#define FLOW		0xae5f81ca /* 202.129.95.174	*/
#define HEANET		0x57db01c1 /* 193.1.219.87	*/
#define KEIHANNA	0x044092d2 /* 210.146.64.4	*/
#define OPTUSNET	0x11018ec6 /* 198.142.1.17	*/
#define OVH		0x5b21bad5 /* 213.186.33.91	*/
#define PUZZLE		0xdd658dc3 /* 195.141.101.221	*/
#define TWTELECOM	0x0c04facf /* 207.250.4.12	*/
#define UMN		0x82506580 /* 128.101.80.130	*/
#define UNC		0x79d20298 /* 152.2.210.121	*/
#define VOXEL		0x02a40945 /* 69.9.164.2	*/

inline const char *a2s(const unsigned long int a)
{
	switch (a)
	{
		case ALERON:
			return "aleron";
		case BELNET:
			return "belnet";
		case CESNET:
			return "cesnet";
		case EASYNEWS:
			return "easynews";
		case FLOW:
			return "flow";
		case HEANET:
			return "heanet";
		case KEIHANNA:
			return "keihanna";
		case OPTUSNET:
			return "optusnet";
		case OVH:
			return "ovh";
		case PUZZLE:
			return "puzzle";
		case TWTELECOM:
			return "twtelecom";
		case UMN:
			return "umn";
		case VOXEL:
			return "voxel";
		case UNC:
		default:
			return "unc";
	}
}

int main()
{
	extern int h_errno;
	struct hostent *hostptr;
	struct in_addr *ptr;

	hostptr = gethostbyname(DLSFNET);
	if (!hostptr)
	{
		switch (h_errno)
		{
			case HOST_NOT_FOUND:
				fprintf(stderr, "Host not found\n");
				break;
			case TRY_AGAIN:
				fprintf(stderr, "Try again\n");
				break;
			case NO_RECOVERY:
				fprintf(stderr, "No recovery\n");
				break;
			case NO_ADDRESS:
				fprintf(stderr, "No address\n");
				break;
			default:
				fprintf(stderr, "Unknown error %d\n", h_errno);
				break;
		}
		return 1;
	}

	switch (hostptr->h_addrtype)
	{
		case AF_INET:
			ptr = (struct in_addr *) *hostptr->h_addr_list;
			printf ("%s\n", a2s(ptr->s_addr));
			break;
		default:
			fprintf(stderr, "Unknown address type %d\n", hostptr->h_addrtype);
			return 2;
	}

	return 0;
}

--- NEW FILE: sltd.c ---
/*
 * sltd - convert symbolic link to Slackware's doinst.sh script entry
 * Copyright (c) 2003 Jaroslaw Swierczynski <swiergot at intersec.pl>
 * Distributed under the terms of GNU GPL version 2 or any later version.
 */

#include <stdio.h>
#include <unistd.h>
#include <string.h>
#include <libgen.h>
#include <stdlib.h>

#define SLTD "0.1"

#define BUFL 80

int main(int argc, char *argv[])
{
	char target[BUFL];
	char *lname, *dprep, *bprep, *dname, *bname;
	int len;

	if (argc < 2)
	{
		fprintf(stderr, "sltd %s: usage: %s symlink\n", SLTD, argv[0]);
		return 1;
	}

	if (strncmp(argv[1], "./", 2))
		lname = strdup(argv[1]);
	else
		lname = strdup(argv[1] + 2);
	len = readlink(lname, target, BUFL);
	if (len == -1)
	{
		perror("sltd");
		return 2;
	}
	target[len] = '\0';

	dprep = strdup(lname);
	bprep = strdup(lname);
	dname = dirname(dprep);
	bname = basename(bprep);
	printf("( cd %s ; rm -rf %s )\n", dname, bname);
	printf("( cd %s ; ln -sf %s %s )\n", dname, target, bname);

	free(dprep);
	free(bprep);
	free(lname);

	return 0;
}

--- NEW FILE: sltm.c ---
/*
 * sltm - convert symbolic link to manual page reference
 * Copyright (c) 2003 Jaroslaw Swierczynski <swiergot at intersec.pl>
 * Distributed under the terms of GNU GPL version 2 or any later version.
 */

#include <stdio.h>
#include <unistd.h>
#include <string.h>
#include <libgen.h>
#include <stdlib.h>

#define SLTM "0.1"

#define BUFL 80

#define free_all() free(tmp1); free(tmp2); free(tmp4);

int main(int argc, char *argv[])
{
	char target[BUFL];
	char *tmp1, *tmp2, *tmp3, *tmp4, *tmp5, *page, *sect;
	int len;

	if (argc < 2)
	{
		fprintf(stderr, "sltm %s: usage: %s symlink\n", SLTM, argv[0]);
		return 1;
	}

	len = readlink(argv[1], target, BUFL);
	if (len == -1)
	{
		perror("sltm");
		return 2;
	}
	target[len] = '\0';

	tmp1 = strdup(target);
	page = basename(tmp1);
	tmp2 = strdup(target);
	tmp3 = dirname(tmp2);
	if (strcmp(tmp3, "."))
	{
		tmp4 = strdup(tmp3);
		sect = basename(tmp4);
	}
	else
	{
		tmp5 = strdup(argv[1]);
		tmp3 = dirname(tmp5);
		tmp4 = strdup(tmp3);
		sect = basename(tmp4);
		free(tmp5);
	}

	if (!unlink(argv[1]))
	{
		FILE *f;

		f = fopen(argv[1], "w");
		if (!f)
		{
			perror("sltm");
			free_all();
			return 3;
		}
		fprintf(f, ".so %s/%s\n", sect, page);
		fclose(f);
	}
	else
	{
		perror("sltm");
		free_all();
		return 4;
	}
	free_all();

	return 0;

}

--- NEW FILE: spn.c ---
/*
 * spn - Slackware package name resolver
 * Copyright (c) 2003 Jaroslaw Swierczynski <swiergot at intersec.pl>
 * Distributed under the terms of GNU GPL version 2 or any later version.
 */

#include <stdio.h>
#include <string.h>
#include <libgen.h>
#include <stdlib.h>

#define SPN "0.1"

#define C_NAM 0
#define C_VER 1
#define C_ARC 2
#define C_BLD 3

#define spn_exit(n) { free(raw); return n; }

int main(int argc, char *argv[])
{
	char *exec, *prog, *raw, *tab[4];
	int compon = -1, len;

	if (argc < 2)
	{
		fprintf(stderr, "spn %s: usage: %s name\n", SPN, argv[0]);
		return 1;
	}

	exec = strdup(argv[0]);
	prog = basename(exec);

	if (!strcmp(prog, "spn-name" )) compon = C_NAM; else
	if (!strcmp(prog, "spn-ver"  )) compon = C_VER; else
	if (!strcmp(prog, "spn-arch" )) compon = C_ARC; else
	if (!strcmp(prog, "spn-build")) compon = C_BLD;

	raw = strdup(argv[1]);
	tab[C_NAM] = basename(raw);
	len = strlen(tab[C_NAM]);

	if (len > 3 && !strcmp(tab[C_NAM] + len - 4, ".tgz"))
		(tab[C_NAM])[len -= 4] = 0;
	if (len == 0)
		spn_exit(2);

	if ((tab[C_BLD] = strrchr(tab[C_NAM], '-'))) *(tab[C_BLD]++) = 0;
	if ((tab[C_ARC] = strrchr(tab[C_NAM], '-'))) *(tab[C_ARC]++) = 0;
	if ((tab[C_VER] = strrchr(tab[C_NAM], '-'))) *(tab[C_VER]++) = 0;

	if (!(tab[C_VER] && tab[C_ARC] && tab[C_BLD]))
	{
		if (tab[C_VER]) *(tab[C_VER] - 1) = '-';
		if (tab[C_ARC]) *(tab[C_ARC] - 1) = '-';
		if (tab[C_BLD]) *(tab[C_BLD] - 1) = '-';

		if (compon == -1)
			printf("p_name=\"%s\"; p_ver=\"\"; p_arch=\"\"; p_build=\"\";\n", tab[C_NAM]);
		else
			if (compon == 0)
				printf("%s\n", tab[C_NAM]);
		spn_exit(0);
	}

	if (compon == -1)
		printf("p_name=\"%s\"; p_ver=\"%s\"; p_arch=\"%s\"; p_build=\"%s\";\n", tab[C_NAM], tab[C_VER], tab[C_ARC], tab[C_BLD]);
	else
		printf("%s\n", tab[compon]);

	spn_exit(0);
}

--- NEW FILE: tod.c ---
/*
 * tod - convert Unix text file do DOS format
 * Copyright (c) 2003 Jaroslaw Swierczynski <swiergot at intersec.pl>
 * Distributed under the terms of GNU GPL version 2 or any later version.
 */

#include <stdio.h>

#define TOD "0.2"

int main(int argc, char *argv[])
{
	FILE *f;
	int c;

	if (argc < 2)
	{
		fprintf(stderr, "tod %s: usage: %s unix-file\n", TOD, argv[0]);
		return 1;
	}

	if ((f = fopen(argv[1], "r")) == NULL)
	{
		fprintf(stderr, "tod %s: cannot open file\n", TOD);
		return 2;
	}

	while ((c = fgetc(f)) != EOF)
	{
		if (c == 10)
			putchar(13);
		putchar(c);
	}

	fclose(f);

	return 0;
}



